<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#FF00E6"><meta name="author" content="Xin Ling"><meta name="copyright" content="Xin Ling"><meta name="generator" content="Hexo 6.2.0"><meta name="theme" content="hexo-theme-yun"><title>模板 | lingxin</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://fastly.jsdelivr.net/npm/@unocss/runtime/mini.global.js"></script><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script type="module">import { renderKatex } from '/js/utils.js'
document.addEventListener("DOMContentLoaded", () => {
  renderKatex({
    ...{},
    ...true?.options,
  });
});</script><link rel="icon" type="image/png" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#FF00E6"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"example.com","root":"/","title":["ling","xin","の","blog"],"version":"1.10.2","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"fireworks":{"colors":null},"vendors":{"darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><script src="/h" async></script><script src="/t" async></script><script src="/t" async></script><script src="/p" async></script><script src="/s" async></script><script src="/:" async></script><script src="/" async></script><script src="/" async></script><script src="/c" async></script><script src="/d" async></script><script src="/n" async></script><script src="/." async></script><script src="/j" async></script><script src="/s" async></script><script src="/d" async></script><script src="/e" async></script><script src="/l" async></script><script src="/i" async></script><script src="/v" async></script><script src="/r" async></script><script src="/." async></script><script src="/n" async></script><script src="/e" async></script><script src="/t" async></script><script src="/" async></script><script src="/n" async></script><script src="/p" async></script><script src="/m" async></script><script src="/" async></script><script src="/i" async></script><script src="/o" async></script><script src="/n" async></script><script src="/i" async></script><script src="/c" async></script><script src="/o" async></script><script src="/n" async></script><script src="/s" async></script><script src="/" async></script><script src="/d" async></script><script src="/i" async></script><script src="/s" async></script><script src="/t" async></script><script src="/" async></script><script src="/i" async></script><script src="/o" async></script><script src="/n" async></script><script src="/i" async></script><script src="/c" async></script><script src="/o" async></script><script src="/n" async></script><script src="/s" async></script><script src="/." async></script><script src="/j" async></script><script src="/s" async></script><meta name="description" content="[TOC] &amp;#x4EE3;&amp;#x7801;&amp;#x6A21;&amp;#x677F;#include&lt;bits&#x2F;stdc++.h&gt; &#x2F;* #include&lt;iostream&gt; #include&lt;cstdio&gt; #include&lt;cstring&gt; #include&lt;algorithm&gt; #include&lt;bitset&gt; #include&lt;cassert&gt; #inc">
<meta property="og:type" content="article">
<meta property="og:title" content="模板">
<meta property="og:url" content="http://example.com/2021/03/21/%E6%A8%A1%E6%9D%BF/index.html">
<meta property="og:site_name" content="lingxin">
<meta property="og:description" content="[TOC] &amp;#x4EE3;&amp;#x7801;&amp;#x6A21;&amp;#x677F;#include&lt;bits&#x2F;stdc++.h&gt; &#x2F;* #include&lt;iostream&gt; #include&lt;cstdio&gt; #include&lt;cstring&gt; #include&lt;algorithm&gt; #include&lt;bitset&gt; #include&lt;cassert&gt; #inc">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2021/03/21/%E6%A8%A1%E6%9D%BF/%E6%A8%A1%E6%9D%BF/1.png">
<meta property="article:published_time" content="2021-03-21T02:57:10.000Z">
<meta property="article:modified_time" content="2021-11-22T11:42:20.482Z">
<meta property="article:author" content="Xin Ling">
<meta property="article:tag" content="算法">
<meta property="article:tag" content="ACM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/03/21/%E6%A8%A1%E6%9D%BF/%E6%A8%A1%E6%9D%BF/1.png"><script>(function() {
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Xin Ling"><img width="96" loading="lazy" src="/images/image.png" alt="Xin Ling"><span class="site-author-status" title="你是正确的">😰</span></a><div class="site-author-name"><a href="/about/">Xin Ling</a></div><span class="site-name">lingxin</span><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">54</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">30</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">29</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.</span> <span class="toc-text">代码模板</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8STL"><span class="toc-number">2.</span> <span class="toc-text">常用STL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">基础算法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#int128%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA"><span class="toc-number">3.1.</span> <span class="toc-text">int128输入输出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E7%B2%BE%E5%BA%A6"><span class="toc-number">3.2.</span> <span class="toc-text">高精度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RMQ"><span class="toc-number">3.3.</span> <span class="toc-text">RMQ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2"><span class="toc-number">4.</span> <span class="toc-text">搜索</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95"><span class="toc-number">5.</span> <span class="toc-text">计算几何</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%A8%A1%E6%9D%BF"><span class="toc-number">5.1.</span> <span class="toc-text">基础模板</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95%E6%A8%A1%E6%9D%BF"><span class="toc-number">5.1.1.</span> <span class="toc-text">计算几何模板</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9"><span class="toc-number">5.2.</span> <span class="toc-text">进阶内容</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6"><span class="toc-number">6.</span> <span class="toc-text">数学</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E8%AE%BA"><span class="toc-number">6.1.</span> <span class="toc-text">数论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E8%AE%BA%E5%9F%BA%E7%A1%80%EF%BC%8C%E6%AC%A7%E5%87%A0%E5%9F%83%E6%B0%8F%E7%AD%9B%E6%89%A9%E6%AC%A7%E5%8F%96%E6%A8%A1%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="toc-number">6.1.1.</span> <span class="toc-text">数论基础，欧几埃氏筛扩欧取模快速幂</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%86%E5%85%83%E5%8F%8A%E9%80%86%E5%85%83%E6%B1%82%E6%B3%95"><span class="toc-number">6.1.2.</span> <span class="toc-text">逆元及逆元求法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0"><span class="toc-number">6.1.3.</span> <span class="toc-text">欧拉函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E6%AC%A1%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B%E5%92%8C%E4%BA%8C%E6%AC%A1%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B"><span class="toc-number">6.1.4.</span> <span class="toc-text">一次同余方程和二次同余方程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B6%E4%B9%98%E5%88%86%E8%A7%A3%E8%B4%A8%E5%9B%A0%E6%95%B0"><span class="toc-number">6.1.5.</span> <span class="toc-text">阶乘分解质因数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%95%E9%99%A4%E6%B3%95%E6%B1%82%E7%BA%A6%E6%95%B0"><span class="toc-number">6.1.6.</span> <span class="toc-text">试除法求约数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0"><span class="toc-number">6.2.</span> <span class="toc-text">线性代数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83%E8%A7%A3%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="toc-number">6.2.1.</span> <span class="toc-text">高斯消元解线性方程组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83%E8%A7%A3%E5%BC%82%E6%88%96%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="toc-number">6.2.2.</span> <span class="toc-text">高斯消元解异或线性方程组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6"><span class="toc-number">6.3.</span> <span class="toc-text">组合数学</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86"><span class="toc-number">6.4.</span> <span class="toc-text">容斥原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%9A%E5%BC%88%E8%AE%BA"><span class="toc-number">6.5.</span> <span class="toc-text">博弈论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">7.</span> <span class="toc-text">数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">7.1.</span> <span class="toc-text">基础数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%EF%BC%88%E5%B7%AE%E5%88%86%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E6%B1%82%E5%8C%BA%E9%97%B4%E4%BF%AE%E6%94%B9%E5%8D%95%E7%82%B9%E6%9F%A5%E8%AF%A2%EF%BC%89"><span class="toc-number">7.1.1.</span> <span class="toc-text">树状数组（差分树状数组求区间修改单点查询）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%EF%BC%88%E5%B7%AE%E5%88%86%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E6%B1%82%E5%8C%BA%E9%97%B4%E4%BF%AE%E6%94%B9%E5%8C%BA%E9%97%B4%E6%9F%A5%E8%AF%A2%EF%BC%89"><span class="toc-number">7.1.2.</span> <span class="toc-text">树状数组（差分树状数组求区间修改区间查询）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%EF%BC%88%E5%8D%95%E7%82%B9%E4%BF%AE%E6%94%B9%E5%8C%BA%E9%97%B4%E6%9F%A5%E8%AF%A2%E5%8D%95%E7%82%B9%E6%9F%A5%E8%AF%A2%EF%BC%89"><span class="toc-number">7.1.3.</span> <span class="toc-text">树状数组（单点修改区间查询单点查询）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%AE%B5%E6%A0%91%EF%BC%88%E5%8A%A0%E6%B3%95%EF%BC%89"><span class="toc-number">7.1.4.</span> <span class="toc-text">线段树（加法）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%AE%B5%E6%95%B0%EF%BC%88%E5%8A%A0%E4%B9%98%E6%B3%95%EF%BC%89"><span class="toc-number">7.1.5.</span> <span class="toc-text">线段数（加乘法）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%9601%E5%AD%97%E5%85%B8%E6%A0%91%EF%BC%88%E6%9C%80%E5%A4%A7%E5%BC%82%E6%88%96%E5%92%8C%EF%BC%89"><span class="toc-number">7.1.6.</span> <span class="toc-text">可持久化01字典树（最大异或和）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%B8%AD%E6%A0%91%EF%BC%88%E5%8C%BA%E9%97%B4%E7%AC%ACk%E5%B0%8F%EF%BC%89"><span class="toc-number">7.1.7.</span> <span class="toc-text">主席树（区间第k小）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KMP"><span class="toc-number">7.1.8.</span> <span class="toc-text">KMP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ac%E8%87%AA%E5%8A%A8%E6%9C%BA"><span class="toc-number">7.1.9.</span> <span class="toc-text">ac自动机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">7.2.</span> <span class="toc-text">高级数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B3%E8%A1%A1%E6%A0%91"><span class="toc-number">7.2.1.</span> <span class="toc-text">平衡树</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BE%E8%AE%BA"><span class="toc-number">8.</span> <span class="toc-text">图论</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F"><span class="toc-number">8.1.</span> <span class="toc-text">拓扑排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%9B%9E%E8%B7%AF%E4%B8%8E%E6%AC%A7%E6%8B%89%E8%B7%AF%E5%BE%84"><span class="toc-number">8.2.</span> <span class="toc-text">欧拉回路与欧拉路径</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E6%AC%A7%E6%8B%89%E5%9B%9E%E8%B7%AF%E5%B9%B6%E8%BE%93%E5%87%BA%E8%B7%AF%E5%BE%84"><span class="toc-number">8.2.1.</span> <span class="toc-text">求欧拉回路并输出路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E6%AC%A7%E6%8B%89%E8%B7%AF%E5%BE%84%EF%BC%88%E5%8D%95%E8%AF%8D%E6%B8%B8%E6%88%8F%EF%BC%8C%E5%8D%95%E8%AF%8D%E9%A6%96%E5%B0%BE%E7%9B%B8%E8%BF%9E%EF%BC%89"><span class="toc-number">8.2.2.</span> <span class="toc-text">求欧拉路径（单词游戏，单词首尾相连）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E7%9F%AD%E8%B7%AF"><span class="toc-number">8.3.</span> <span class="toc-text">最短路</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97%E4%BC%98%E5%8C%96dijkstra"><span class="toc-number">8.3.1.</span> <span class="toc-text">优先队列优化dijkstra</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spfa"><span class="toc-number">8.3.2.</span> <span class="toc-text">spfa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#floyd"><span class="toc-number">8.3.3.</span> <span class="toc-text">floyd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LCA"><span class="toc-number">8.3.4.</span> <span class="toc-text">LCA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F"><span class="toc-number">8.3.5.</span> <span class="toc-text">强连通分量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%9A%84%E5%89%B2%E7%82%B9%E4%B8%8E%E6%A1%A5"><span class="toc-number">8.3.6.</span> <span class="toc-text">图的割点与桥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E5%88%86%E5%9B%BE"><span class="toc-number">8.4.</span> <span class="toc-text">二分图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%93%E8%89%B2%E6%B3%95%E5%88%A4%E6%96%AD%E4%BA%8C%E5%88%86%E5%9B%BE"><span class="toc-number">8.4.1.</span> <span class="toc-text">染色法判断二分图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E5%88%86%E5%9B%BE%E6%9C%80%E5%A4%A7%E5%8C%B9%E9%85%8D%EF%BC%88%E5%8C%88%E7%89%99%E5%88%A9%EF%BC%89"><span class="toc-number">8.4.2.</span> <span class="toc-text">二分图最大匹配（匈牙利）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91"><span class="toc-number">8.5.</span> <span class="toc-text">最小生成树</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#prim"><span class="toc-number">8.5.1.</span> <span class="toc-text">prim</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kruskal"><span class="toc-number">8.5.2.</span> <span class="toc-text">kruskal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A1%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91%EF%BC%88lca%EF%BC%89"><span class="toc-number">8.5.3.</span> <span class="toc-text">次小生成树（lca）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%B5%81"><span class="toc-number">8.6.</span> <span class="toc-text">网络流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%B5%81%E6%9C%80%E5%A4%A7%E6%B5%81%EF%BC%88%E4%BC%98%E5%8C%96dinic%EF%BC%89"><span class="toc-number">8.6.1.</span> <span class="toc-text">网络流最大流（优化dinic）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E8%B4%B9%E7%94%A8%E6%9C%80%E5%A4%A7%E6%B5%81"><span class="toc-number">8.6.2.</span> <span class="toc-text">最小费用最大流</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92"><span class="toc-number">9.</span> <span class="toc-text">动态规划</span></a></li></ol></div></div></div><div class="tag-cloud"><div class="tag-cloud-tags"><a href="/tags/ACM/" style="font-size: 30px; color: #0078e7">ACM</a> <a href="/tags/CCPC/" style="font-size: 12px; color: #999">CCPC</a> <a href="/tags/OpenGL/" style="font-size: 19.2px; color: #5c8cb8">OpenGL</a> <a href="/tags/VPN/" style="font-size: 12px; color: #999">VPN</a> <a href="/tags/cmake/" style="font-size: 12px; color: #999">cmake</a> <a href="/tags/codeforces/" style="font-size: 19.2px; color: #5c8cb8">codeforces</a> <a href="/tags/vscode/" style="font-size: 12px; color: #999">vscode</a> <a href="/tags/%E4%BA%8C%E5%88%86/" style="font-size: 12px; color: #999">二分</a> <a href="/tags/%E4%BB%A3%E7%90%86/" style="font-size: 12px; color: #999">代理</a> <a href="/tags/%E5%85%AC%E5%BC%8F/" style="font-size: 12px; color: #999">公式</a> <a href="/tags/%E5%88%86%E6%B2%BB/" style="font-size: 12px; color: #999">分治</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 12px; color: #999">动态规划</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E5%9B%BE%E7%89%87%E6%98%BE%E7%A4%BA/" style="font-size: 12px; color: #999">博客图片显示</a> <a href="/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA/" style="font-size: 12px; color: #999">博弈论</a> <a href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" style="font-size: 22.8px; color: #3d85c8">图形学</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 26.4px; color: #1f7fd7">数学</a> <a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size: 15.6px; color: #7a92a9">数论</a> <a href="/tags/%E6%9A%B4%E5%8A%9B/" style="font-size: 12px; color: #999">暴力</a> <a href="/tags/%E6%9B%B4%E7%9B%B8%E5%87%8F%E6%8D%9F%E6%9C%AF/" style="font-size: 12px; color: #999">更相减损术</a> <a href="/tags/%E6%9E%9A%E4%B8%BE/" style="font-size: 12px; color: #999">枚举</a></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#FF00E6;"><link itemprop="mainEntityOfPage" href="http://example.com/2021/03/21/%E6%A8%A1%E6%9D%BF/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Xin Ling"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="lingxin"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">模板</h1><div class="post-meta"><div class="post-time"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2021-03-21 10:57:10" itemprop="dateCreated datePublished" datetime="2021-03-21T10:57:10+08:00">2021-03-21</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2021-11-22 19:42:20" itemprop="dateModified" datetime="2021-11-22T19:42:20+08:00">2021-11-22</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E6%A8%A1%E6%9D%BF/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">模板</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E7%AE%97%E6%B3%95/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">算法</span></a><a class="tag-item" href="/tags/ACM/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">ACM</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p><img src="/2021/03/21/%E6%A8%A1%E6%9D%BF/%E6%A8%A1%E6%9D%BF/1.png" alt="1" loading="lazy"></p>
<p>[TOC]</p>
<h1 id="&#x4EE3;&#x7801;&#x6A21;&#x677F;"><a href="#&#x4EE3;&#x7801;&#x6A21;&#x677F;" class="headerlink" title="&#x4EE3;&#x7801;&#x6A21;&#x677F;"></a>&#x4EE3;&#x7801;&#x6A21;&#x677F;</h1><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token comment" spellcheck="true">/*
#include&lt;iostream>
#include&lt;cstdio>
#include&lt;cstring>
#include&lt;algorithm>
#include&lt;bitset>
#include&lt;cassert>
#include&lt;cctype>
#include&lt;cmath>
#include&lt;cstdlib>
#include&lt;ctime>
#include&lt;deque>
#include&lt;iomanip>
#include&lt;list>
#include&lt;map>
#include&lt;queue>
#include&lt;set>
#include&lt;stack>
#include&lt;vector>
*/</span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl cout &lt;&lt; "\n"</span>
<span class="token macro property">#<span class="token directive keyword">define</span> jud cout &lt;&lt; "caonima" &lt;&lt; endl;</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pll pair&lt;long long,long long></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token macro property">#<span class="token directive keyword">define</span> Clear(x) while(!x.empty())x.pop()</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pqg(type) priority_queue&lt;type,vector&lt;type>,greater&lt;type>></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pql(type) priority_queue&lt;type,vector&lt;type>,less&lt;type>></span>
<span class="token macro property">#<span class="token directive keyword">define</span> Max(a,b) ((a)&lt;(b)?(b):(a))</span>
<span class="token macro property">#<span class="token directive keyword">define</span> Min(a,b) ((a)&lt;(b)?(a):(b))</span>
<span class="token keyword">int</span> T<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//freopen("data.in","r",stdin);</span>
    ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> T<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//T = 1;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>T<span class="token operator">--</span><span class="token punctuation">)</span>
        <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="&#x5E38;&#x7528;STL"><a href="#&#x5E38;&#x7528;STL" class="headerlink" title="&#x5E38;&#x7528;STL"></a>&#x5E38;&#x7528;STL</h1><pre class=" language-cpp"><code class="language-cpp">String<span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span>
<span class="token operator">&amp;</span>#x8D4B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x503C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B97<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C06<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9762<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E32<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8D4B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x503C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7ED9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x524D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9762<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E32<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token operator">&amp;</span>#x6BD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8F83<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B97<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">==</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">!=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&lt;=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">></span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">>=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6BD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8F83<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x662F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E24<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E32<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5178<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E8F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5927<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C0F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token operator">&amp;</span>#x8FDE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63A5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B97<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">+</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">+</span><span class="token operator">=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C06<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B97<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x52A0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53E6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B97<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9762<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>

s<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E32<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6807<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span>index<span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span>string<span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6807<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E5F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x662F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4ECE<span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">&amp;</span>#x5F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x59CB<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4ECE<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6807<span class="token punctuation">;</span>p<span class="token operator">&amp;</span>#x5F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x59CB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span>n<span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7EC4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6210<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E32<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5982<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x679C<span class="token punctuation">;</span>n<span class="token operator">&amp;</span>#x7701<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7565<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C31<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53D6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E95<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E32<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x957F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5EA6<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#x5224<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65AD<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#x662F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5426<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token number">1</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>p0<span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5220<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9664<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4ECE<span class="token punctuation">;</span>p0<span class="token operator">&amp;</span>#x5F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x59CB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span>len<span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5982<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x679C<span class="token punctuation">;</span>len<span class="token operator">&amp;</span>#x7701<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7565<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C31<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5220<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E95<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5220<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9664<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6807<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span>i<span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
s1<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>p0<span class="token punctuation">,</span>s2<span class="token punctuation">,</span>pos<span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E24<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53C2<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x622A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53D6<span class="token punctuation">;</span>s2<span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53EF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7701<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7565<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>p0<span class="token punctuation">,</span>n<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span>p0<span class="token operator">&amp;</span>#x5904<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63D2<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5165<span class="token punctuation">;</span>n<span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span>c<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
s1<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>p0<span class="token punctuation">,</span>len0<span class="token punctuation">,</span>s2<span class="token punctuation">,</span>pos<span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5220<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9664<span class="token punctuation">;</span>p0<span class="token operator">&amp;</span>#x5F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x59CB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span>len0<span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7136<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span>p0<span class="token operator">&amp;</span>#x5904<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63D2<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5165<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E32<span class="token punctuation">;</span>s2<span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4ECE<span class="token punctuation">;</span>pos<span class="token operator">&amp;</span>#x5F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x59CB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span>len<span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E24<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53C2<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53EF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7701<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7565<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
s1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span>pos<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4ECE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x524D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5F80<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x67E5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6210<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x529F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65F6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B2C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6B21<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x51FA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x73B0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6807<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5931<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8D25<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span>string<span class="token operator">::</span>npos<span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x503C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token operator">*</span>m<span class="token punctuation">)</span>
s1<span class="token punctuation">.</span><span class="token function">rfind</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span>pos<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4ECE<span class="token punctuation">;</span>pos<span class="token operator">&amp;</span>#x5F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x59CB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4ECE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5411<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x524D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x67E5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E32<span class="token punctuation">;</span>s2<span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B57<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E32<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5F53<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x524D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E32<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FB9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B2C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6B21<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x51FA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x73B0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6807<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token operator">*</span>m<span class="token punctuation">)</span>


vector<span class="token operator">:</span>
vector<span class="token operator">&lt;</span>type<span class="token operator">></span>v<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x521B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5EFA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x52A8<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6001<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7EC4<span class="token punctuation">;</span>v<span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9762<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53EF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x52A0<span class="token punctuation">;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">&amp;</span>#x6216<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#x8FDB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x884C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x521D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x59CB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5316<span class="token punctuation">;</span>
type v<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x83B7<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53D6<span class="token punctuation">;</span>v<span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B2C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>index<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>type<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>item<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5411<span class="token punctuation">;</span>v<span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2FAF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6DFB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x52A0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span>item<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>
v<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5220<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9664<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>v<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x83B7<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53D6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>v<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span>size_type<span class="token operator">&amp;</span>#x7C7B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x578B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>n<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x628A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>v<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2ED3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5EA6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8BBE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B9A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>n<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5224<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65AD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>v<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x662F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5426<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token number">1</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6E05<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>v<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>iterator<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>it<span class="token punctuation">,</span>type<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>x<span class="token punctuation">)</span><span class="token operator">&amp;</span>#x5411<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span>it<span class="token operator">&amp;</span>#x6307<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5411<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x524D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x589E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x52A0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span>x<span class="token punctuation">,</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>iterator<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>it<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5220<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9664<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5411<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x91CF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6307<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5411<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token punctuation">,</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9996<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5F15<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7528<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C3E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5F15<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7528<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9996<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6307<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5411<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B2C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C3E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6307<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5411<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5411<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x91CF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F4D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7F6E<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span>v1<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B58;int&amp;#x7C7B;&amp;#x578B;&amp;#x7684;&amp;#x52A8;&amp;#x6001;&amp;#x6570;&amp;#x7EC4;&amp;#xFF0C;int&amp;#x53EF;&amp;#x4EE5;&amp;#x6539;&amp;#x6210;&amp;#x5176;&amp;#x5B83;&amp;#x7C7B;&amp;#x578B;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span>v2<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B58;double&amp;#x7C7B;&amp;#x578B;&amp;#x7684;&amp;#x52A8;&amp;#x6001;&amp;#x6570;&amp;#x7EC4;&amp;#xFF0C;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A;6&amp;#xFF0C;1&amp;#xA0;1&amp;#xA0;2&amp;#xA0;3&amp;#xA0;5&amp;#xA0;8&amp;#x5206;&amp;#x522B;&amp;#x5B58;&amp;#x5728;v[0]~v[5]</span>
vector<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token keyword">long</span><span class="token operator">></span><span class="token function">v3</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B58;long&amp;#xA0;long&amp;#x7C7B;&amp;#x578B;&amp;#x7684;&amp;#x52A8;&amp;#x6001;&amp;#x6570;&amp;#x7EC4;&amp;#xFF0C;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A;20&amp;#xFF0C;v[0]~v[19]&amp;#x9ED8;&amp;#x8BA4;&amp;#x4E3A;0</span>
vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token function">v4</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token string">"zzuacm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B58;string&amp;#x7C7B;&amp;#x578B;&amp;#x7684;&amp;#x52A8;&amp;#x6001;&amp;#x6570;&amp;#x7EC4;&amp;#xFF0C;&amp;#x957F;&amp;#x5EA6;&amp;#x4E3A;20&amp;#xFF0C;&amp;#x5B58;&amp;#x7684;&amp;#x90FD;&amp;#x662F;"zzuacm"</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span>v5<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&amp;#x76F8;&amp;#x5F53;&amp;#x4E8E;&amp;#x5B58;int&amp;#x7684;&amp;#x4E8C;&amp;#x7EF4;&amp;#x6570;&amp;#x7EC4;&amp;#xFF0C;&amp;#x4E00;&amp;#x5171;3&amp;#x884C;&amp;#xFF0C;&amp;#x6BCF;&amp;#x884C;&amp;#x7684;&amp;#x5217;&amp;#x53EF;&amp;#x53D8;</span>
vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span>v5<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&amp;#x5B58;int&amp;#x7684;&amp;#x4E8C;&amp;#x7EF4;&amp;#x6570;&amp;#x7EC4;&amp;#xFF0C;&amp;#x884C;&amp;#x548C;&amp;#x5217;&amp;#x90FD;&amp;#x53EF;&amp;#x53D8;&amp;#xFF0C;&amp;#x521D;&amp;#x59CB;&amp;#x72B6;&amp;#x6001;</span>

queue<span class="token operator">:</span>
q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>q<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6DFB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x52A0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span>type<span class="token operator">&amp;</span>#x7C7B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x578B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span>item<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F7F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>q<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x524D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2FAF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x51FA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x961F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x83B7<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53D6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>q<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x524D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2FAF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 
q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x83B7<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53D6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>q<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5224<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65AD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>q<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x662F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5426<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token number">1</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    
priority_queue<span class="token operator">:</span>
pq<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>pq<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6DFB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x52A0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
pq<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x83B7<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53D6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>pq<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5927<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
pq<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F7F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>pq<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5927<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x51FA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x961F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
pq<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x83B7<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53D6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>pq<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
pq<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5224<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65AD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>pq<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x662F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5426<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    
Set
<span class="token operator">&amp;</span>#x5EFA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7ACB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65B9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6CD5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span>
set<span class="token operator">&lt;</span>Type<span class="token operator">></span>s<span class="token punctuation">;</span>
multiset<span class="token operator">&lt;</span>Type<span class="token operator">></span>s<span class="token punctuation">;</span>
unordered_set<span class="token operator">&lt;</span>Type<span class="token operator">></span>s<span class="token punctuation">;</span>
unordered_multiset<span class="token operator">&lt;</span>Type<span class="token operator">></span>s<span class="token punctuation">;</span>
<span class="token operator">&amp;</span>#x5982<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x679C<span class="token punctuation">;</span>Type<span class="token operator">&amp;</span>#x65E0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6CD5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FDB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x884C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6BD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8F83<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD8<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8981<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x548C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F18<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5148<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x961F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5217<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6837<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B9A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E49<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span>#x8FD0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B97<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B26<span class="token punctuation">;</span>

s<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63D2<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F0A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x83B7<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53D6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5224<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65AD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x662F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5426<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6E05<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x67E5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E76<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5176<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8BDD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C0F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6CE8<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x610F<span class="token punctuation">;</span>set<span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x548C<span class="token punctuation">;</span>vector<span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65E0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6CD5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x76F4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63A5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x52A0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x67D0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56E0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6B64<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8981<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7ECF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E38<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7528<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">&amp;</span>#x548C<span class="token punctuation">;</span><span class="token operator">++</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5927<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>item<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x91CF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x3002<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span>set<span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56E0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6240<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6709<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53EA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x80FD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x51FA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x73B0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6B21<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6240<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x503C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53EA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x80FD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x662F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6216<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token number">1</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span>multiset<span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B58<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5220<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9664<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span>position<span class="token operator">&amp;</span>#x5BF9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E94<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F4D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7F6E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5220<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9664<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5BF9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E94<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>pos1<span class="token punctuation">,</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>pos2<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5220<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9664<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token punctuation">[</span>pos1<span class="token punctuation">,</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>pos2<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x533A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x95F4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F4D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7F6E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">+</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>pos2<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">-</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>pos1<span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">lower_bound</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B2C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5927<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E8E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B49<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E8E<span class="token punctuation">;</span>item<span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C31<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">upper_bound</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B2C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5927<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E8E<span class="token punctuation">;</span>item<span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C31<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>

                        
Map<span class="token operator">:</span>                        
map<span class="token operator">&lt;</span>key<span class="token punctuation">,</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>value<span class="token operator">></span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token punctuation">;</span>
unordered_map<span class="token operator">&lt;</span>key<span class="token punctuation">,</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>value<span class="token operator">></span>mp<span class="token punctuation">;</span>

mp<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x83B7<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53D6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
mp<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5224<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65AD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x662F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5426<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
mp<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6E05<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7A7A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
mp<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C0F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x548C<span class="token punctuation">;</span>set<span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6837<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53EA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53EF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7528<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">&amp;</span>#x548C<span class="token punctuation">;</span><span class="token operator">++</span><span class="token operator">&amp;</span>#x64CD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F5C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
mp<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5927<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
mp<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x67E5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E76<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5176<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>iterator<span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8BDD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
mp<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x67E5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x91CF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56E0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>map<span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x552F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6240<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53EA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6216<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token number">1</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
mp<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">:</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5220<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9664<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6240<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9879<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#x548C<span class="token punctuation">;</span>value<span class="token operator">&amp;</span>#x90FD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x88AB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5220<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9664<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
mp<span class="token punctuation">.</span><span class="token function">lower_bound</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B2C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#x5927<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E8E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B49<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E8E<span class="token punctuation">;</span>item<span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C31<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span>mp<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
mp<span class="token punctuation">.</span><span class="token function">upper_bound</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7B2C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#x5927<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E8E<span class="token punctuation">;</span>item<span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C31<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span>mp<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
mp<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5BF9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E94<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>value<span class="token operator">&amp;</span>#x3002<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5982<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x679C<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B58<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5219<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>value<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7C7B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x578B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9ED8<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8BA4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6784<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9020<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF08<span class="token punctuation">;</span>defaultconstructor<span class="token operator">&amp;</span>#xFF09<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6240<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6784<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9020<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x503C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E76<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8BE5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x952E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x503C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5BF9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63D2<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F0A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>
mp<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>xxx<span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5982<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x679C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x627E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5BF9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E94<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5219<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C06<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x952E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x503C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5BF9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token punctuation">(</span>key<span class="token operator">:</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>xxx<span class="token punctuation">)</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63D2<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x2F0A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5230<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>mp<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5982<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x679C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B58<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5728<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5219<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C06<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FD9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>key<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5BF9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5E94<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x503C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6539<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53D8<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E3A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>xxx<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token function">O</span><span class="token punctuation">(</span>logn<span class="token punctuation">)</span>

                        
        
bitset<span class="token operator">:</span>
bitset<span class="token operator">&lt;</span>n<span class="token operator">></span>b<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;#x5EFA;&amp;#x7ACB;&amp;#x4E00;&amp;#x4E2A;&amp;#x53EF;&amp;#x4EE5;&amp;#x5B58;n&amp;#x4F4D;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x7684;&amp;#x6709;&amp;#x5E8F;&amp;#x96C6;</span>
bitset<span class="token operator">&lt;</span>n<span class="token operator">></span><span class="token function">b</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token keyword">long</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;#x5750;&amp;#x6807;&amp;#x4ECE;&amp;#x540E;&amp;#x5F80;&amp;#x524D;&amp;#x8BA1;&amp;#x6570;&amp;#xFF0C;&amp;#x9AD8;&amp;#x4F4D;&amp;#x5728;&amp;#x524D;</span>
bitset<span class="token operator">&lt;</span>n<span class="token operator">></span><span class="token function">b</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;#x5C06;&amp;#x7531;&amp;apos;0&amp;apos;&amp;#x548C;&amp;apos;1&amp;apos;&amp;#x7EC4;&amp;#x6210;&amp;#x7684;&amp;#x5B57;&amp;#x7B26;&amp;#x4E32;&amp;#x8D4B;&amp;#x503C;&amp;#x7ED9;</span>
<span class="token operator">&amp;</span>#x652F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6301<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6240<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6709<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F4D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x64CD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F5C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span><span class="token operator">|</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">|</span><span class="token operator">=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&amp;</span><span class="token operator">=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">&lt;&lt;=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">>></span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">>>=</span>
cout<span class="token operator">&lt;&lt;</span>b<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//bitset&amp;#x53EF;&amp;#x4EE5;&amp;#x76F4;&amp;#x63A5;&amp;#x7528;cout&amp;#x8F93;&amp;#x51FA;</span>
b<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x4E0B;&amp;#x6807;&amp;#x64CD;&amp;#x4F5C;&amp;#x7B26;&amp;#x6765;&amp;#x8BFB;&amp;#x6216;&amp;#x5199;&amp;#x67D0;&amp;#x4E2A;&amp;#x7D22;&amp;#x5F15;&amp;#x4F4D;&amp;#x7F6E;&amp;#x7684;&amp;#x4E8C;&amp;#x8FDB;&amp;#x5236;&amp;#x4F4D;</span>
<span class="token comment" spellcheck="true">//&amp;#x6BD4;&amp;#x5982;bitset&lt;10>b(5);&amp;#x7B49;&amp;#x4EF7;&amp;#x4E8E;bitset&lt;10>b("1010");</span>
<span class="token comment" spellcheck="true">//&amp;#x5176;&amp;#x4E2D;cout&lt;&lt;b&amp;#x8F93;&amp;#x51FA;0000001010</span>
<span class="token comment" spellcheck="true">//for(int&amp;#xA0;i=0;i&lt;10;i++)cout&lt;&lt;b[i];&amp;#x8F93;&amp;#x51FA;0101000000</span>
                        
b<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//count&amp;#x51FD;&amp;#x6570;&amp;#x7528;&amp;#x6765;&amp;#x6C42;bitset&amp;#x4E2D;1&amp;#x7684;&amp;#x4F4D;&amp;#x6570;</span>
b<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//size&amp;#x51FD;&amp;#x6570;&amp;#x7528;&amp;#x6765;&amp;#x6C42;bitset&amp;#x7684;&amp;#x5927;&amp;#x5C0F;</span>
b<span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//any&amp;#x51FD;&amp;#x6570;&amp;#x68C0;&amp;#x67E5;bitset&amp;#x4E2D;&amp;#x662F;&amp;#x5426;&amp;#x6709;&amp;#xFF11;</span>
b<span class="token punctuation">.</span><span class="token function">none</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//none&amp;#x51FD;&amp;#x6570;&amp;#x68C0;&amp;#x67E5;bitset&amp;#x4E2D;&amp;#x662F;&amp;#x5426;&amp;#x6CA1;&amp;#x6709;&amp;#xFF11;</span>
b<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//all&amp;#x51FD;&amp;#x6570;&amp;#x68C0;&amp;#x67E5;bitset&amp;#x4E2D;&amp;#x662F;&amp;#x5168;&amp;#x90E8;&amp;#x4E3A;&amp;#xFF11;</span>
foo<span class="token punctuation">.</span><span class="token function">flip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//flip&amp;#x51FD;&amp;#x6570;&amp;#x4E0D;&amp;#x6307;&amp;#x5B9A;&amp;#x53C2;&amp;#x6570;&amp;#x65F6;&amp;#xFF0C;&amp;#x5C06;bitset&amp;#x6BCF;&amp;#x4E00;&amp;#x4F4D;&amp;#x5168;&amp;#x90E8;&amp;#x53D6;&amp;#x53CD;</span>
foo<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//set&amp;#x51FD;&amp;#x6570;&amp;#x4E0D;&amp;#x6307;&amp;#x5B9A;&amp;#x53C2;&amp;#x6570;&amp;#x65F6;&amp;#xFF0C;&amp;#x5C06;bitset&amp;#x7684;&amp;#x6BCF;&amp;#x4E00;&amp;#x4F4D;&amp;#x5168;&amp;#x90E8;&amp;#x7F6E;&amp;#x4E3A;&amp;#xFF11;</span>
foo<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//reset&amp;#x51FD;&amp;#x6570;&amp;#x4E0D;&amp;#x4F20;&amp;#x53C2;&amp;#x6570;&amp;#x65F6;&amp;#x5C06;bitset&amp;#x7684;&amp;#x6BCF;&amp;#x4E00;&amp;#x4F4D;&amp;#x5168;&amp;#x90E8;&amp;#x7F6E;&amp;#x4E3A;&amp;#xFF10;</span>
string<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>s<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>foo<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;#x5C06;bitset&amp;#x8F6C;&amp;#x6362;&amp;#x6210;string&amp;#x7C7B;&amp;#x578B;</span>
<span class="token keyword">unsigned</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token keyword">long</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>a<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>foo<span class="token punctuation">.</span><span class="token function">to_ulong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;#x5C06;bitset&amp;#x8F6C;&amp;#x6362;&amp;#x6210;unsigned&amp;#xA0;long&amp;#x7C7B;&amp;#x578B;</span>
<span class="token keyword">unsigned</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token keyword">long</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token keyword">long</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>b<span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span><span class="token operator">=</span><span class="token operator">&amp;</span>#xA0<span class="token punctuation">;</span>foo<span class="token punctuation">.</span><span class="token function">to_ullong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;#x5C06;bitset&amp;#x8F6C;&amp;#x6362;&amp;#x6210;unsigned&amp;#xA0;long&amp;#xA0;long&amp;#x7C7B;&amp;#x578B;</span>


<span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#x8FD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56DE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x53BB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x91CD<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x540E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5143<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7D20<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E0B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E00<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FED<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EE3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5668<span class="token punctuation">;</span>
                        
next_permutation
</code></pre>
<h1 id="&#x57FA;&#x7840;&#x7B97;&#x6CD5;"><a href="#&#x57FA;&#x7840;&#x7B97;&#x6CD5;" class="headerlink" title="&#x57FA;&#x7840;&#x7B97;&#x6CD5;"></a>&#x57FA;&#x7840;&#x7B97;&#x6CD5;</h1><h2 id="int128&#x8F93;&#x5165;&#x8F93;&#x51FA;"><a href="#int128&#x8F93;&#x5165;&#x8F93;&#x51FA;" class="headerlink" title="int128&#x8F93;&#x5165;&#x8F93;&#x51FA;"></a>int128&#x8F93;&#x5165;&#x8F93;&#x51FA;</h2><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">inline</span> __int128 <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    __int128 x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>f<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>ch<span class="token operator">&lt;</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token operator">||</span>ch<span class="token operator">></span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token number">9</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ch<span class="token operator">==</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token operator">-</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">)</span>
            f<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>ch<span class="token operator">>=</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token operator">&amp;&amp;</span>ch<span class="token operator">&lt;=</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token number">9</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        x<span class="token operator">=</span>x<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span>ch<span class="token operator">-</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">;</span>
        ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> x<span class="token operator">*</span>f<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span>__int128 x<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token operator">-</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        x<span class="token operator">=</span><span class="token operator">-</span>x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">></span><span class="token number">9</span><span class="token punctuation">)</span>
        <span class="token function">write</span><span class="token punctuation">(</span>x<span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">putchar</span><span class="token punctuation">(</span>x<span class="token operator">%</span><span class="token number">10</span><span class="token operator">+</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    __int128 a <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    __int128 b <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">write</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x9AD8;&#x7CBE;&#x5EA6;"><a href="#&#x9AD8;&#x7CBE;&#x5EA6;" class="headerlink" title="&#x9AD8;&#x7CBE;&#x5EA6;"></a>&#x9AD8;&#x7CBE;&#x5EA6;</h2><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">// C = A + B, A >= 0, B >= 0</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">add</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">&amp;</span>A<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">&amp;</span>B<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> B<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">add</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> A<span class="token punctuation">)</span><span class="token punctuation">;</span>

    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> C<span class="token punctuation">;</span>
    <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> A<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        t <span class="token operator">+</span><span class="token operator">=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> B<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> t <span class="token operator">+</span><span class="token operator">=</span> B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        C<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>t <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t <span class="token operator">/</span><span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">)</span> C<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> C<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// C = A - B, &amp;#x6EE1;&amp;#x8DB3;A >= B, A >= 0, B >= 0</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">sub</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">&amp;</span>A<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">&amp;</span>B<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> C<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> A<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        t <span class="token operator">=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> t<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> B<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> t <span class="token operator">-</span><span class="token operator">=</span> B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        C<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> t <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>C<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> C<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> C<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> C<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// C = A * b, A >= 0, b >= 0</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">mul</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">&amp;</span>A<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> C<span class="token punctuation">;</span>

    <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> A<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> t<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> A<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> t <span class="token operator">+</span><span class="token operator">=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> b<span class="token punctuation">;</span>
        C<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>t <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t <span class="token operator">/</span><span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>C<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> C<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> C<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> C<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// A / b = C ... r, A >= 0, b > 0</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">div</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">&amp;</span>A<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>r<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> C<span class="token punctuation">;</span>
    r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> A<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">--</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        r <span class="token operator">=</span> r <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        C<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>r <span class="token operator">/</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        r <span class="token operator">%</span><span class="token operator">=</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">reverse</span><span class="token punctuation">(</span>C<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> C<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>C<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> C<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> C<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> C<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="RMQ"><a href="#RMQ" class="headerlink" title="RMQ"></a>RMQ</h2><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">200010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span><span class="token number">200010</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// &amp;#x521D;&amp;#x59CB;&amp;#x5316;</span>
<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">17</span><span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">+</span> len <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token punctuation">(</span>len <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        len <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// &amp;#x67E5;&amp;#x8BE2;[l, r]&amp;#x4E2D;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;</span>
<span class="token keyword">int</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token function">log</span><span class="token punctuation">(</span>r <span class="token operator">-</span> l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span>r <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> k<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="&#x641C;&#x7D22;"><a href="#&#x641C;&#x7D22;" class="headerlink" title="&#x641C;&#x7D22;"></a>&#x641C;&#x7D22;</h1><h1 id="&#x8BA1;&#x7B97;&#x51E0;&#x4F55;"><a href="#&#x8BA1;&#x7B97;&#x51E0;&#x4F55;" class="headerlink" title="&#x8BA1;&#x7B97;&#x51E0;&#x4F55;"></a>&#x8BA1;&#x7B97;&#x51E0;&#x4F55;</h1><h2 id="&#x57FA;&#x7840;&#x6A21;&#x677F;"><a href="#&#x57FA;&#x7840;&#x6A21;&#x677F;" class="headerlink" title="&#x57FA;&#x7840;&#x6A21;&#x677F;"></a>&#x57FA;&#x7840;&#x6A21;&#x677F;</h2><h3 id="&#x8BA1;&#x7B97;&#x51E0;&#x4F55;&#x6A21;&#x677F;"><a href="#&#x8BA1;&#x7B97;&#x51E0;&#x4F55;&#x6A21;&#x677F;" class="headerlink" title="&#x8BA1;&#x7B97;&#x51E0;&#x4F55;&#x6A21;&#x677F;"></a>&#x8BA1;&#x7B97;&#x51E0;&#x4F55;&#x6A21;&#x677F;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//&amp;#x8BA1;&amp;#x7B97;&amp;#x51E0;&amp;#x4F55;&amp;#x57FA;&amp;#x7840;&amp;#x6A21;&amp;#x677F;&amp;#xFF0C;&amp;#x8BE5;&amp;#x6A21;&amp;#x677F;&amp;#x672A;&amp;#x5B8C;&amp;#x6210;&amp;#xFF0C;&amp;#x5F85;&amp;#x66F4;&amp;#x65B0;</span>
<span class="token comment" spellcheck="true">//&amp;#x53C2;&amp;#x8003;https://linxi99.gitee.io/20190211/ACM%E5%87%A0%E4%BD%95%E5%9F%BA%E7%A1%80%E7%AF%87/</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl puts("")</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> pi <span class="token operator">=</span> <span class="token function">acos</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> inf <span class="token operator">=</span> <span class="token number">1e100</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> eps <span class="token operator">=</span> <span class="token number">1e-6</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&amp;#x7B26;&amp;#x53F7;&amp;#x51FD;&amp;#x6570;&amp;#xFF0C;&amp;#x9A8C;&amp;#x8BC1;&amp;#x53C2;&amp;#x6570;&amp;#x7684;&amp;#x7B26;&amp;#x53F7;</span>
<span class="token keyword">int</span> <span class="token function">sgn</span><span class="token punctuation">(</span><span class="token keyword">double</span> d<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">&lt;</span> eps<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x6D6E;&amp;#x70B9;&amp;#x5224;&amp;#x7B49;&amp;#x51FD;&amp;#x6570;</span>
<span class="token keyword">int</span> <span class="token function">dcmp</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>x <span class="token operator">-</span> y<span class="token punctuation">)</span> <span class="token operator">&lt;</span> eps<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">></span> y<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> Point<span class="token punctuation">{</span>
    <span class="token keyword">double</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
    <span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">typedef</span> Point Vector<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&amp;#x5411;&amp;#x91CF;&amp;#x52A0;&amp;#x51CF;</span>
Vector <span class="token keyword">operator</span> <span class="token operator">+</span> <span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> Vector B<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">+</span>B<span class="token punctuation">.</span>x<span class="token punctuation">,</span> A<span class="token punctuation">.</span>y<span class="token operator">+</span>B<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
Vector <span class="token keyword">operator</span> <span class="token operator">-</span> <span class="token punctuation">(</span>Point A<span class="token punctuation">,</span> Point B<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">-</span>B<span class="token punctuation">.</span>x<span class="token punctuation">,</span> A<span class="token punctuation">.</span>y<span class="token operator">-</span>B<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5411;&amp;#x91CF;&amp;#x4F38;&amp;#x7F29;</span>
Vector <span class="token keyword">operator</span> <span class="token operator">*</span> <span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">*</span>p<span class="token punctuation">,</span> A<span class="token punctuation">.</span>y<span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
Vector <span class="token keyword">operator</span> <span class="token operator">/</span> <span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">/</span>p<span class="token punctuation">,</span> A<span class="token punctuation">.</span>y<span class="token operator">/</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5411;&amp;#x91CF;&amp;#x6BD4;&amp;#x8F83;</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">&lt;</span>b<span class="token punctuation">.</span>x<span class="token operator">||</span>a<span class="token punctuation">.</span>x<span class="token operator">==</span>b<span class="token punctuation">.</span>x<span class="token operator">&amp;&amp;</span>a<span class="token punctuation">.</span>y<span class="token operator">&lt;</span>b<span class="token punctuation">.</span>y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>x<span class="token operator">></span>b<span class="token punctuation">.</span>x<span class="token operator">||</span>a<span class="token punctuation">.</span>x<span class="token operator">==</span>b<span class="token punctuation">.</span>x<span class="token operator">&amp;&amp;</span>a<span class="token punctuation">.</span>y<span class="token operator">></span>b<span class="token punctuation">.</span>y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">dcmp</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span>b<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">dcmp</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>y<span class="token punctuation">,</span>b<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5185;&amp;#x79EF;&amp;#x8FD0;&amp;#x7B97;&amp;#xFF1A;1.&amp;#x5185;&amp;#x79EF;&amp;#x4E3A;&amp;#x6B63;&amp;#x4E3A;&amp;#x9510;&amp;#x89D2; 2.&amp;#x5185;&amp;#x79EF;&amp;#x4E3A;&amp;#x8D1F;&amp;#x4E3A;&amp;#x949D;&amp;#x89D2; 3.&amp;#x5185;&amp;#x79EF;&amp;#x4E3A;0&amp;#x4E3A;&amp;#x76F4;&amp;#x89D2;</span>
<span class="token keyword">double</span> <span class="token keyword">operator</span> <span class="token operator">*</span> <span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> Vector B<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> A<span class="token punctuation">.</span>x<span class="token operator">*</span>B<span class="token punctuation">.</span>x <span class="token operator">+</span> A<span class="token punctuation">.</span>y<span class="token operator">*</span>B<span class="token punctuation">.</span>y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5916;&amp;#x79EF;&amp;#x8FD0;&amp;#x7B97;&amp;#xFF1A;&amp;#xFF08;&amp;#x53F3;&amp;#x624B;&amp;#x5B9A;&amp;#x5219;&amp;#xFF09;1.B&amp;#x5728;A&amp;#x7684;&amp;#x9006;&amp;#x65F6;&amp;#x9488;&amp;#x65B9;&amp;#x5411;&amp;#x4E3A;&amp;#x6B63;&amp;#x503C; 2.&amp;#x987A;&amp;#x65F6;&amp;#x9488;&amp;#x4E3A;&amp;#x8D1F;&amp;#x503C; 3.&amp;#x5171;&amp;#x7EBF;&amp;#x4E3A;0</span>
<span class="token keyword">double</span> <span class="token keyword">operator</span> <span class="token operator">^</span> <span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> Vector B<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> A<span class="token punctuation">.</span>x<span class="token operator">*</span>B<span class="token punctuation">.</span>y<span class="token operator">-</span>A<span class="token punctuation">.</span>y<span class="token operator">*</span>B<span class="token punctuation">.</span>x<span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x53D6;&amp;#x6A21;</span>
<span class="token keyword">double</span> <span class="token function">Length</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>A<span class="token operator">*</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x8BA1;&amp;#x7B97;&amp;#x4E24;&amp;#x5411;&amp;#x91CF;&amp;#x5939;&amp;#x89D2;</span>
<span class="token keyword">double</span> <span class="token function">Angle</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> Vector B<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">acos</span><span class="token punctuation">(</span>A<span class="token operator">*</span>B <span class="token operator">/</span> <span class="token function">Length</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">Length</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x8BA1;&amp;#x7B97;&amp;#x4E24;&amp;#x5411;&amp;#x91CF;&amp;#x6784;&amp;#x6210;&amp;#x7684;&amp;#x5E73;&amp;#x884C;&amp;#x56DB;&amp;#x8FB9;&amp;#x5F62;&amp;#x6709;&amp;#x5411;&amp;#x9762;&amp;#x79EF;</span>
<span class="token keyword">double</span> <span class="token function">Area2</span><span class="token punctuation">(</span>Point A<span class="token punctuation">,</span> Point B<span class="token punctuation">,</span> Point C<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>B<span class="token operator">-</span>A<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>C<span class="token operator">-</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//rad&amp;#x4E3A;&amp;#x5F27;&amp;#x5EA6;&amp;#xFF0C;&amp;#x4E14;&amp;#x4E3A;&amp;#x9006;&amp;#x65F6;&amp;#x9488;&amp;#x65CB;&amp;#x8F6C;&amp;#x7684;&amp;#x89D2;</span>
Vector <span class="token function">Rotate1</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> <span class="token keyword">double</span> rad<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token operator">-</span>A<span class="token punctuation">.</span>y<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token punctuation">.</span>x<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token operator">+</span>A<span class="token punctuation">.</span>y<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//rad&amp;#x4E3A;&amp;#x5F27;&amp;#x5EA6;&amp;#xFF0C;&amp;#x4E14;&amp;#x4E3A;&amp;#x987A;&amp;#x65F6;&amp;#x9488;&amp;#x65CB;&amp;#x8F6C;&amp;#x7684;&amp;#x89D2;</span>
Vector <span class="token function">Rotate2</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">,</span> <span class="token keyword">double</span> rad<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>x<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token operator">+</span>A<span class="token punctuation">.</span>y<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token punctuation">.</span>y<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token operator">-</span>A<span class="token punctuation">.</span>x<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5411;&amp;#x91CF;A&amp;#x5DE6;&amp;#x8F6C;90&amp;#xB0;&amp;#x7684;&amp;#x5355;&amp;#x4F4D;&amp;#x6CD5;&amp;#x5411;&amp;#x91CF;</span>
Vector <span class="token function">Normal1</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span><span class="token operator">-</span>A<span class="token punctuation">.</span>y<span class="token operator">/</span><span class="token function">Length</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token punctuation">.</span>x<span class="token operator">/</span><span class="token function">Length</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5411;&amp;#x91CF;A&amp;#x53F3;&amp;#x8F6C;90&amp;#xB0;&amp;#x7684;&amp;#x5355;&amp;#x4F4D;&amp;#x6CD5;&amp;#x5411;&amp;#x91CF;</span>
Vector <span class="token function">Normal2</span><span class="token punctuation">(</span>Vector A<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">Vector</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>y<span class="token operator">/</span><span class="token function">Length</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span>A<span class="token punctuation">.</span>x<span class="token operator">/</span><span class="token function">Length</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5224;&amp;#x65AD;&amp;#x6298;&amp;#x7EBF;&amp;#x2192;bc&amp;#x662F;&amp;#x4E0D;&amp;#x662F;&amp;#x5411;&amp;#x2192;ab&amp;#x7684;&amp;#x9006;&amp;#x65F6;&amp;#x9488;&amp;#x65B9;&amp;#x5411;&amp;#xFF08;&amp;#x5DE6;&amp;#x8FB9;&amp;#xFF09;&amp;#x8F6C;&amp;#x5411;&amp;#xFF0C;&amp;#x51F8;&amp;#x5305;&amp;#x6784;&amp;#x9020;&amp;#x65F6;&amp;#x5C06;&amp;#x4F1A;&amp;#x9891;&amp;#x7E41;&amp;#x7528;&amp;#x5230;&amp;#x6B64;&amp;#x516C;&amp;#x5F0F;</span>
<span class="token keyword">bool</span> <span class="token function">ToLeftTest</span><span class="token punctuation">(</span>Point a<span class="token punctuation">,</span> Point b<span class="token punctuation">,</span> Point c<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">double</span> v <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token operator">-</span>a<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>c<span class="token operator">-</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> v <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment" spellcheck="true">//&amp;#x76F4;&amp;#x7EBF;&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x76F4;&amp;#x7EBF;&amp;#x4E0A;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;P0&amp;#x548C;&amp;#x65B9;&amp;#x5411;&amp;#x5411;&amp;#x91CF;v&amp;#x8868;&amp;#x793A;&amp;#xFF0C;P=P0+vt&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;t&amp;#x4E3A;&amp;#x53C2;&amp;#x6570;</span>
<span class="token comment" spellcheck="true">//&amp;#x76F4;&amp;#x7EBF;&amp;#x5B9A;&amp;#x4E49;</span>
<span class="token keyword">struct</span> Line <span class="token punctuation">{</span>
    Point v<span class="token punctuation">,</span> p<span class="token punctuation">;</span>
    <span class="token function">Line</span><span class="token punctuation">(</span>Point v<span class="token punctuation">,</span> Point p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">v</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">p</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">//&amp;#x8FD4;&amp;#x56DE;&amp;#x70B9;P = v + (p - v)*t</span>
    Point <span class="token function">point</span><span class="token punctuation">(</span><span class="token keyword">double</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> v <span class="token operator">+</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> v<span class="token punctuation">)</span><span class="token operator">*</span>t<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&amp;#x5224;&amp;#x65AD;&amp;#x70B9;&amp;#x5728;&amp;#x76F4;&amp;#x7EBF;&amp;#x4E0A;&amp;#xFF0C;&amp;#x5229;&amp;#x7528;&amp;#x4E09;&amp;#x70B9;&amp;#x5171;&amp;#x7EBF;&amp;#x7684;&amp;#x7B49;&amp;#x4EF7;&amp;#x6761;&amp;#x4EF6;&amp;#xFF1A;&amp;#x5373;&amp;#x53C9;&amp;#x79EF;&amp;#x4E3A;0</span>
<span class="token keyword">void</span> <span class="token function">void_cmp</span><span class="token punctuation">(</span>Point a<span class="token punctuation">,</span>Line L<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5224;&amp;#x65AD;&amp;#x4E24;&amp;#x76F4;&amp;#x7EBF;&amp;#x4EA4;&amp;#x70B9;</span>
<span class="token comment" spellcheck="true">//&amp;#x8C03;&amp;#x7528;&amp;#x524D;&amp;#x9700;&amp;#x4FDD;&amp;#x8BC1; v^w != 0</span>
Point <span class="token function">GetLineIntersection</span><span class="token punctuation">(</span>Point P<span class="token punctuation">,</span> Vector v<span class="token punctuation">,</span> Point Q<span class="token punctuation">,</span> Vector w<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Vector u <span class="token operator">=</span> P<span class="token operator">-</span>Q<span class="token punctuation">;</span>
    <span class="token keyword">double</span> t <span class="token operator">=</span> <span class="token punctuation">(</span>w<span class="token operator">^</span>u<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>v<span class="token operator">^</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> P<span class="token operator">+</span>v<span class="token operator">*</span>t<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x70B9;P&amp;#x5230;&amp;#x76F4;&amp;#x7EBF;AB&amp;#x8DDD;&amp;#x79BB;&amp;#x516C;&amp;#x5F0F;&amp;#xFF0C;&amp;#x4E0D;&amp;#x53BB;&amp;#x7EDD;&amp;#x5BF9;&amp;#x503C;&amp;#xFF0C;&amp;#x5F97;&amp;#x5230;&amp;#x7684;&amp;#x662F;&amp;#x6709;&amp;#x5411;&amp;#x8DDD;&amp;#x79BB;</span>
<span class="token keyword">double</span> <span class="token function">DistanceToLine</span><span class="token punctuation">(</span>Point P<span class="token punctuation">,</span> Point A<span class="token punctuation">,</span> Point B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Vector v1 <span class="token operator">=</span> B<span class="token operator">-</span>A<span class="token punctuation">,</span> v2 <span class="token operator">=</span> P<span class="token operator">-</span>A<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">fabs</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v1<span class="token operator">^</span>v2<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">Length</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x70B9;P&amp;#x5230;&amp;#x7EBF;&amp;#x6BB5;AB&amp;#x8DDD;&amp;#x79BB;&amp;#x516C;&amp;#x5F0F;</span>
<span class="token keyword">double</span> <span class="token function">DistanceToSegment</span><span class="token punctuation">(</span>Point P<span class="token punctuation">,</span> Point A<span class="token punctuation">,</span> Point B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>A <span class="token operator">==</span> B<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">Length</span><span class="token punctuation">(</span>P<span class="token operator">-</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Vector v1 <span class="token operator">=</span> B<span class="token operator">-</span>A<span class="token punctuation">,</span> v2 <span class="token operator">=</span> P<span class="token operator">-</span>A<span class="token punctuation">,</span> v3 <span class="token operator">=</span> P<span class="token operator">-</span>B<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>v1<span class="token operator">*</span>v2<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">Length</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>v1<span class="token operator">*</span>v3<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">Length</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">DistanceToLine</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x70B9;P&amp;#x5728;&amp;#x76F4;&amp;#x7EBF;AB&amp;#x4E0A;&amp;#x7684;&amp;#x6295;&amp;#x5F71;&amp;#x70B9;</span>
Point <span class="token function">GetLineProjection</span><span class="token punctuation">(</span>Point P<span class="token punctuation">,</span> Point A<span class="token punctuation">,</span> Point B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Vector v <span class="token operator">=</span> B<span class="token operator">-</span>A<span class="token punctuation">;</span>
    <span class="token keyword">return</span> A<span class="token operator">+</span>v<span class="token operator">*</span><span class="token punctuation">(</span>v<span class="token operator">*</span><span class="token punctuation">(</span>P<span class="token operator">-</span>A<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>v<span class="token operator">*</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5224;&amp;#x65AD;&amp;#x70B9;&amp;#x662F;&amp;#x5426;&amp;#x5728;&amp;#x7EBF;&amp;#x6BB5;&amp;#x4E0A;</span>
<span class="token keyword">bool</span> <span class="token function">OnSegment</span><span class="token punctuation">(</span>Point p<span class="token punctuation">,</span> Point a1<span class="token punctuation">,</span> Point a2<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">sgn</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a1<span class="token operator">-</span>p<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>a2<span class="token operator">-</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sgn</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a1<span class="token operator">-</span>p<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>a2<span class="token operator">-</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5224;&amp;#x65AD;&amp;#x4E24;&amp;#x7EBF;&amp;#x6BB5;&amp;#x662F;&amp;#x5426;&amp;#x76F8;&amp;#x4EA4;&amp;#xFF0C;&amp;#x4E0D;&amp;#x5141;&amp;#x8BB8;&amp;#x5728;&amp;#x7AEF;&amp;#x70B9;&amp;#x5904;&amp;#x76F8;&amp;#x4EA4;</span>
<span class="token keyword">bool</span> <span class="token function">SegmentProperIntersection</span><span class="token punctuation">(</span>Point a1<span class="token punctuation">,</span> Point a2<span class="token punctuation">,</span> Point b1<span class="token punctuation">,</span> Point b2<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">double</span> c1 <span class="token operator">=</span> <span class="token punctuation">(</span>a2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>b1 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token punctuation">,</span> c2 <span class="token operator">=</span> <span class="token punctuation">(</span>a2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>b2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> c3 <span class="token operator">=</span> <span class="token punctuation">(</span>b2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>a1 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token punctuation">,</span> c4 <span class="token operator">=</span> <span class="token punctuation">(</span>b2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>a2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">sgn</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sgn</span><span class="token punctuation">(</span>c3<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">sgn</span><span class="token punctuation">(</span>c4<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5224;&amp;#x65AD;&amp;#x4E24;&amp;#x7EBF;&amp;#x6BB5;&amp;#x662F;&amp;#x5426;&amp;#x76F8;&amp;#x4EA4;&amp;#xFF0C;&amp;#x5141;&amp;#x8BB8;&amp;#x5728;&amp;#x7AEF;&amp;#x70B9;&amp;#x5904;&amp;#x76F8;&amp;#x4EA4;</span>
<span class="token keyword">bool</span> <span class="token function">SegmentProperIntersection</span><span class="token punctuation">(</span>Point a1<span class="token punctuation">,</span> Point a2<span class="token punctuation">,</span> Point b1<span class="token punctuation">,</span> Point b2<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">double</span> c1 <span class="token operator">=</span> <span class="token punctuation">(</span>a2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>b1 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token punctuation">,</span> c2 <span class="token operator">=</span> <span class="token punctuation">(</span>a2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>b2 <span class="token operator">-</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> c3 <span class="token operator">=</span> <span class="token punctuation">(</span>b2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>a1 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token punctuation">,</span> c4 <span class="token operator">=</span> <span class="token punctuation">(</span>b2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>a2 <span class="token operator">-</span> b1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//if&amp;#x5224;&amp;#x65AD;&amp;#x63A7;&amp;#x5236;&amp;#x662F;&amp;#x5426;&amp;#x5141;&amp;#x8BB8;&amp;#x7EBF;&amp;#x6BB5;&amp;#x5728;&amp;#x7AEF;&amp;#x70B9;&amp;#x5904;&amp;#x76F8;&amp;#x4EA4;&amp;#xFF0C;&amp;#x6839;&amp;#x636E;&amp;#x9700;&amp;#x8981;&amp;#x6DFB;&amp;#x52A0;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">sgn</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">sgn</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">sgn</span><span class="token punctuation">(</span>c3<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">sgn</span><span class="token punctuation">(</span>c4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">bool</span> f1 <span class="token operator">=</span> <span class="token function">OnSegment</span><span class="token punctuation">(</span>b1<span class="token punctuation">,</span> a1<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> f2 <span class="token operator">=</span> <span class="token function">OnSegment</span><span class="token punctuation">(</span>b2<span class="token punctuation">,</span> a1<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> f3 <span class="token operator">=</span> <span class="token function">OnSegment</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> b2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> f4 <span class="token operator">=</span> <span class="token function">OnSegment</span><span class="token punctuation">(</span>a2<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> b2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> f <span class="token operator">=</span> <span class="token punctuation">(</span>f1<span class="token operator">|</span>f2<span class="token operator">|</span>f3<span class="token operator">|</span>f4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> f<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">sgn</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sgn</span><span class="token punctuation">(</span>c3<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">sgn</span><span class="token punctuation">(</span>c4<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x6C42;&amp;#x51F8;&amp;#x591A;&amp;#x8FB9;&amp;#x5F62;&amp;#x9762;&amp;#x79EF;&amp;#xFF0C;p&amp;#x4E3A;&amp;#x7AEF;&amp;#x70B9;&amp;#x96C6;&amp;#x5408;&amp;#xFF0C;n&amp;#x4E3A;&amp;#x7AEF;&amp;#x70B9;&amp;#x4E2A;&amp;#x6570;</span>
<span class="token keyword">double</span> <span class="token function">PolygonArea</span><span class="token punctuation">(</span>Point<span class="token operator">*</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">double</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token number">-1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
        s <span class="token operator">+</span><span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5224;&amp;#x65AD;&amp;#x70B9;&amp;#x662F;&amp;#x5426;&amp;#x5728;&amp;#x591A;&amp;#x8FB9;&amp;#x5F62;&amp;#x5185;&amp;#xFF0C;&amp;#x82E5;&amp;#x70B9;&amp;#x5728;&amp;#x591A;&amp;#x8FB9;&amp;#x5F62;&amp;#x5185;&amp;#x8FD4;&amp;#x56DE;1&amp;#xFF0C;&amp;#x5728;&amp;#x591A;&amp;#x8FB9;&amp;#x5F62;&amp;#x5916;&amp;#x90E8;&amp;#x8FD4;&amp;#x56DE;0&amp;#xFF0C;&amp;#x5728;&amp;#x591A;&amp;#x8FB9;&amp;#x5F62;&amp;#x4E0A;&amp;#x8FD4;&amp;#x56DE;-1</span>
<span class="token keyword">int</span> <span class="token function">isPointInPolygon</span><span class="token punctuation">(</span>Point p<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>Point<span class="token operator">></span> poly<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> wn <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> poly<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">OnSegment</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> poly<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> poly<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token function">sgn</span><span class="token punctuation">(</span><span class="token punctuation">(</span>poly<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">]</span> <span class="token operator">-</span> poly<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>p <span class="token operator">-</span> poly<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> d1 <span class="token operator">=</span> <span class="token function">sgn</span><span class="token punctuation">(</span>poly<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-</span> p<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> d2 <span class="token operator">=</span> <span class="token function">sgn</span><span class="token punctuation">(</span>poly<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-</span> p<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> d1 <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> d2 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> wn<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> d2 <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> d1 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> wn<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>wn <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x5224;&amp;#x65AD;&amp;#x70B9;&amp;#x5728;&amp;#x51F8;&amp;#x591A;&amp;#x8FB9;&amp;#x5F62;&amp;#x5185;&amp;#xFF0C;&amp;#x53EA;&amp;#x9700;&amp;#x8981;&amp;#x5224;&amp;#x65AD;&amp;#x70B9;&amp;#x662F;&amp;#x5426;&amp;#x5728;&amp;#x6240;&amp;#x6709;&amp;#x8FB9;&amp;#x7684;&amp;#x5DE6;&amp;#x8FB9;&amp;#xFF08;&amp;#x6309;&amp;#x9006;&amp;#x65F6;&amp;#x9488;&amp;#x987A;&amp;#x5E8F;&amp;#x6392;&amp;#x5217;&amp;#x7684;&amp;#x9876;&amp;#x70B9;&amp;#x96C6;&amp;#xFF09;ToLeftTest</span>
<span class="token keyword">int</span> <span class="token function">void_isXXXXXX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>


<span class="token comment" spellcheck="true">//&amp;#x5706;&amp;#x7684;&amp;#x5B9A;&amp;#x4E49;</span>
<span class="token keyword">struct</span> Circle<span class="token punctuation">{</span>
    Point c<span class="token punctuation">;</span>
    <span class="token keyword">double</span> r<span class="token punctuation">;</span>
    <span class="token function">Circle</span><span class="token punctuation">(</span>Point c<span class="token punctuation">,</span> <span class="token keyword">double</span> r<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">c</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">r</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    Point <span class="token function">point</span><span class="token punctuation">(</span><span class="token keyword">double</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//&amp;#x901A;&amp;#x8FC7;&amp;#x5706;&amp;#x5FC3;&amp;#x89D2;&amp;#x6C42;&amp;#x5750;&amp;#x6807;</span>
        <span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token function">cos</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">*</span>r<span class="token punctuation">,</span> c<span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token function">sin</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">*</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&amp;#x6C42;&amp;#x5706;&amp;#x4E0E;&amp;#x76F4;&amp;#x7EBF;&amp;#x4EA4;&amp;#x70B9;</span>
<span class="token keyword">int</span> <span class="token function">getLineCircleIntersection</span><span class="token punctuation">(</span>Line L<span class="token punctuation">,</span> Circle C<span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&amp;</span> t1<span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&amp;</span> t2<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>Point<span class="token operator">></span><span class="token operator">&amp;</span> sol<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">double</span> a <span class="token operator">=</span> L<span class="token punctuation">.</span>v<span class="token punctuation">.</span>x<span class="token punctuation">,</span> b <span class="token operator">=</span> L<span class="token punctuation">.</span>p<span class="token punctuation">.</span>x <span class="token operator">-</span> C<span class="token punctuation">.</span>c<span class="token punctuation">.</span>x<span class="token punctuation">,</span> c <span class="token operator">=</span> L<span class="token punctuation">.</span>v<span class="token punctuation">.</span>y<span class="token punctuation">,</span> d <span class="token operator">=</span> L<span class="token punctuation">.</span>p<span class="token punctuation">.</span>y <span class="token operator">-</span> C<span class="token punctuation">.</span>c<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
    <span class="token keyword">double</span> e <span class="token operator">=</span> a<span class="token operator">*</span>a <span class="token operator">+</span> c<span class="token operator">*</span>c<span class="token punctuation">,</span> f <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">*</span>b <span class="token operator">+</span> c<span class="token operator">*</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span> g <span class="token operator">=</span> b<span class="token operator">*</span>b <span class="token operator">+</span> d<span class="token operator">*</span>d <span class="token operator">-</span> C<span class="token punctuation">.</span>r<span class="token operator">*</span>C<span class="token punctuation">.</span>r<span class="token punctuation">;</span>
    <span class="token keyword">double</span> delta <span class="token operator">=</span> f<span class="token operator">*</span>f <span class="token operator">-</span> <span class="token number">4</span><span class="token operator">*</span>e<span class="token operator">*</span>g<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;#x5224;&amp;#x522B;&amp;#x5F0F;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//&amp;#x76F8;&amp;#x79BB;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sgn</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//&amp;#x76F8;&amp;#x5207;</span>
        t1 <span class="token operator">=</span> <span class="token operator">-</span>f <span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t2 <span class="token operator">=</span> <span class="token operator">-</span>f <span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sol<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//sol&amp;#x5B58;&amp;#x653E;&amp;#x4EA4;&amp;#x70B9;&amp;#x672C;&amp;#x8EAB;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">//&amp;#x76F8;&amp;#x4EA4;</span>
    t1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>f <span class="token operator">-</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sol<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>f <span class="token operator">+</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sol<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span>t2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x4E24;&amp;#x5706;&amp;#x76F8;&amp;#x4EA4;&amp;#x9762;&amp;#x79EF;&amp;#xFF1A;&amp;#x901A;&amp;#x8FC7;&amp;#x8BA1;&amp;#x7B97;&amp;#x4E24;&amp;#x4E2A;&amp;#x5706;&amp;#x76F8;&amp;#x4EA4;&amp;#x6240;&amp;#x6784;&amp;#x6210;&amp;#x7684;&amp;#x4E24;&amp;#x4E2A;&amp;#x6247;&amp;#x5F62;&amp;#x9762;&amp;#x79EF;&amp;#x548C;&amp;#x51CF;&amp;#x53BB;&amp;#x5176;&amp;#x6784;&amp;#x6210;&amp;#x7684;&amp;#x7B5D;&amp;#x5F62;&amp;#x7684;&amp;#x9762;&amp;#x79EF;</span>
<span class="token keyword">double</span> <span class="token function">AreaOfOverlap</span><span class="token punctuation">(</span>Point c1<span class="token punctuation">,</span> <span class="token keyword">double</span> r1<span class="token punctuation">,</span> Point c2<span class="token punctuation">,</span> <span class="token keyword">double</span> r2<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token function">Length</span><span class="token punctuation">(</span>c1 <span class="token operator">-</span> c2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>r1 <span class="token operator">+</span> r2 <span class="token operator">&lt;</span> d <span class="token operator">+</span> eps<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">&lt;</span> <span class="token function">fabs</span><span class="token punctuation">(</span>r1 <span class="token operator">-</span> r2<span class="token punctuation">)</span> <span class="token operator">+</span> eps<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">double</span> r <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> pi<span class="token operator">*</span>r<span class="token operator">*</span>r<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token punctuation">(</span>d<span class="token operator">*</span>d <span class="token operator">+</span> r1<span class="token operator">*</span>r1 <span class="token operator">-</span> r2<span class="token operator">*</span>r2<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token operator">*</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> p <span class="token operator">=</span> <span class="token punctuation">(</span>r1 <span class="token operator">+</span> r2 <span class="token operator">+</span> d<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2.0</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> t1 <span class="token operator">=</span> <span class="token function">acos</span><span class="token punctuation">(</span>x<span class="token operator">/</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> t2 <span class="token operator">=</span> <span class="token function">acos</span><span class="token punctuation">(</span><span class="token punctuation">(</span>d <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token operator">/</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> s1 <span class="token operator">=</span> r1<span class="token operator">*</span>r1<span class="token operator">*</span>t1<span class="token punctuation">;</span>
    <span class="token keyword">double</span> s2 <span class="token operator">=</span> r2<span class="token operator">*</span>r2<span class="token operator">*</span>t2<span class="token punctuation">;</span>
    <span class="token keyword">double</span> s3 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span><span class="token function">sqrt</span><span class="token punctuation">(</span>p<span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">-</span> r1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">-</span> r2<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">-</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> s1 <span class="token operator">+</span> s2 <span class="token operator">-</span> s3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">1.49999</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> fx <span class="token operator">=</span> <span class="token function">floor</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;#x5411;&amp;#x4E0B;&amp;#x53D6;&amp;#x6574;&amp;#x51FD;&amp;#x6570;</span>
    <span class="token keyword">int</span> cx <span class="token operator">=</span> <span class="token function">ceil</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;#x5411;&amp;#x4E0A;&amp;#x53D6;&amp;#x6574;&amp;#x51FD;&amp;#x6570;</span>
    <span class="token keyword">int</span> rx <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;#x56DB;&amp;#x820D;&amp;#x4E94;&amp;#x5165;&amp;#x51FD;&amp;#x6570;</span>

    <span class="token comment" spellcheck="true">//&amp;#x8F93;&amp;#x51FA;&amp;#x8981;&amp;#x5C0F;&amp;#x5FC3;&amp;#x907F;&amp;#x514D;&amp;#x8F93;&amp;#x51FA;-0&amp;#xFF0C;&amp;#x6BD4;&amp;#x5982;&amp;#xFF1A;double a = -0.000001,printf("%.4f",a);</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%f %d %d %d\n"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> fx<span class="token punctuation">,</span> cx<span class="token punctuation">,</span> rx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x8F93;&amp;#x51FA;&amp;#x7ED3;&amp;#x679C; 1.499990 1 2 1</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/*

&amp;#x4F7F;&amp;#x7528;&amp;#x53CD;&amp;#x4E09;&amp;#x89D2;&amp;#x51FD;&amp;#x6570;&amp;#x4E00;&amp;#x5B9A;&amp;#x8981;&amp;#x6CE8;&amp;#x610F;&amp;#x8303;&amp;#x56F4;
double x = 1.000001;
double acx = acos(x);
//&amp;#x53EF;&amp;#x80FD;&amp;#x4F1A;&amp;#x8FD4;&amp;#x56DE;runtime error

//&amp;#x6B64;&amp;#x65F6;&amp;#x6211;&amp;#x4EEC;&amp;#x53EF;&amp;#x4EE5;&amp;#x52A0;&amp;#x4E00;&amp;#x53E5;&amp;#x5224;&amp;#x65AD;
double x = 1.000001;
if(fabs(x - 1.0) &lt; eps || fabs(x + 1.0) &lt; eps)
    x = round(x);
double acx = acos(x);

*/</span>
</code></pre>
<h2 id="&#x8FDB;&#x9636;&#x5185;&#x5BB9;"><a href="#&#x8FDB;&#x9636;&#x5185;&#x5BB9;" class="headerlink" title="&#x8FDB;&#x9636;&#x5185;&#x5BB9;"></a>&#x8FDB;&#x9636;&#x5185;&#x5BB9;</h2><h1 id="&#x6570;&#x5B66;"><a href="#&#x6570;&#x5B66;" class="headerlink" title="&#x6570;&#x5B66;"></a>&#x6570;&#x5B66;</h1><h2 id="&#x6570;&#x8BBA;"><a href="#&#x6570;&#x8BBA;" class="headerlink" title="&#x6570;&#x8BBA;"></a>&#x6570;&#x8BBA;</h2><h3 id="&#x6570;&#x8BBA;&#x57FA;&#x7840;&#xFF0C;&#x6B27;&#x51E0;&#x57C3;&#x6C0F;&#x7B5B;&#x6269;&#x6B27;&#x53D6;&#x6A21;&#x5FEB;&#x901F;&#x5E42;"><a href="#&#x6570;&#x8BBA;&#x57FA;&#x7840;&#xFF0C;&#x6B27;&#x51E0;&#x57C3;&#x6C0F;&#x7B5B;&#x6269;&#x6B27;&#x53D6;&#x6A21;&#x5FEB;&#x901F;&#x5E42;" class="headerlink" title="&#x6570;&#x8BBA;&#x57FA;&#x7840;&#xFF0C;&#x6B27;&#x51E0;&#x57C3;&#x6C0F;&#x7B5B;&#x6269;&#x6B27;&#x53D6;&#x6A21;&#x5FEB;&#x901F;&#x5E42;"></a>&#x6570;&#x8BBA;&#x57FA;&#x7840;&#xFF0C;&#x6B27;&#x51E0;&#x57C3;&#x6C0F;&#x7B5B;&#x6269;&#x6B27;&#x53D6;&#x6A21;&#x5FEB;&#x901F;&#x5E42;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">20003</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">gcd</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token operator">%</span>b<span class="token operator">?</span><span class="token function">gcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token operator">%</span>b<span class="token punctuation">)</span><span class="token operator">:</span>b<span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">//a>b</span>
<span class="token keyword">int</span> <span class="token function">lcm</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token operator">/</span><span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token operator">*</span>b<span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">//a>b</span>

<span class="token comment" spellcheck="true">//&amp;#x66F4;&amp;#x76F8;&amp;#x51CF;&amp;#x635F;&amp;#x672F;&amp;#xFF08;stein&amp;#x7B97;&amp;#x6CD5;&amp;#xFF09;</span>
<span class="token keyword">int</span> <span class="token function">stein</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">&lt;</span> b<span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>a<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">stein</span><span class="token punctuation">(</span>a<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>a<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">stein</span><span class="token punctuation">(</span>a<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">stein</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token function">stein</span><span class="token punctuation">(</span>a<span class="token operator">-</span>b<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x57C3;&amp;#x6C0F;&amp;#x7B5B;&amp;#xFF0C;&amp;#x751F;&amp;#x6210;n&amp;#x4EE5;&amp;#x5185;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x7D20;&amp;#x6570;&amp;#xFF0C;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;O(nlognlogn)</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> prim<span class="token punctuation">;</span>
<span class="token keyword">int</span> vis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">create_prim</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span>i<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">+</span><span class="token operator">=</span>i<span class="token punctuation">)</span> vis<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//&amp;#x6B27;&amp;#x62C9;&amp;#x7B5B;&amp;#xFF0C;&amp;#x590D;&amp;#x6742;&amp;#x5EA6;O(n)</span>
<span class="token keyword">void</span> <span class="token function">_create_prim</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> prim<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>prim<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>i<span class="token operator">*</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            vis<span class="token punctuation">[</span>i<span class="token operator">*</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">%</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment" spellcheck="true">//&amp;#x6269;&amp;#x6B27;&amp;#xFF0C;&amp;#x6C42;ax+by=d&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;d=gcd(a,b)&amp;#x7684;&amp;#x6574;&amp;#x6570;&amp;#x89E3;</span>
<span class="token keyword">void</span> <span class="token function">ex_gcd</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> d<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> y<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        d <span class="token operator">=</span> a<span class="token punctuation">;</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> 
        <span class="token function">ex_gcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token operator">%</span>b<span class="token punctuation">,</span> d<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">-</span><span class="token operator">=</span> x<span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">/</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//ax=b(modn) => n|ax-b => b=ax-ny&amp;#xFF0C;&amp;#x7528;&amp;#x6269;&amp;#x6B27;&amp;#x6C42;</span>
<span class="token comment" spellcheck="true">//&amp;#x6CE8;&amp;#x610F;ax=1(modn)&amp;#xFF0C;a&amp;#x4E0E;x&amp;#x4E92;&amp;#x9006;&amp;#xFF0C;&amp;#x6B64;&amp;#x65F6;&amp;#x82E5;gcd(a,n)=1&amp;#x624D;&amp;#x6709;&amp;#x89E3;</span>

<span class="token comment" spellcheck="true">//&amp;#x53D6;&amp;#x6A21;&amp;#x5FEB;&amp;#x901F;&amp;#x5E42;</span>
<span class="token keyword">int</span> <span class="token function">fastpow</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token punctuation">(</span>res<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token operator">%</span>m<span class="token punctuation">;</span>
        b <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        a <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token operator">%</span>m<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x9006;&#x5143;&#x53CA;&#x9006;&#x5143;&#x6C42;&#x6CD5;"><a href="#&#x9006;&#x5143;&#x53CA;&#x9006;&#x5143;&#x6C42;&#x6CD5;" class="headerlink" title="&#x9006;&#x5143;&#x53CA;&#x9006;&#x5143;&#x6C42;&#x6CD5;"></a>&#x9006;&#x5143;&#x53CA;&#x9006;&#x5143;&#x6C42;&#x6CD5;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//1.&amp;#x5F53;p&amp;#x4E3A;&amp;#x7D20;&amp;#x6570;&amp;#x65F6;&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x8D39;&amp;#x9A6C;&amp;#x5C0F;&amp;#x5B9A;&amp;#x7406;</span>
<span class="token keyword">int</span> <span class="token function">fastpow</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">,</span><span class="token keyword">int</span> p<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token punctuation">(</span>res<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
        b <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        a <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">inv1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">fastpow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>p<span class="token number">-2</span><span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//a&amp;#x5173;&amp;#x4E8E;p&amp;#x7684;&amp;#x9006;&amp;#x5143;</span>

<span class="token comment" spellcheck="true">//2.p&amp;#x82E5;&amp;#x4E0D;&amp;#x662F;&amp;#x8D28;&amp;#x6570;&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x6269;&amp;#x6B27;</span>
<span class="token keyword">void</span> <span class="token function">ex_gcd</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> d<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> y<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        d <span class="token operator">=</span> a<span class="token punctuation">;</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> 
        <span class="token function">ex_gcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token operator">%</span>b<span class="token punctuation">,</span> d<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">-</span><span class="token operator">=</span> x<span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">/</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">inv2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> p<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#x8FD4;&amp;#x56DE;-1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> d<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
    <span class="token function">ex_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>p<span class="token punctuation">,</span>d<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> d <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token punctuation">(</span>x<span class="token operator">%</span>p <span class="token operator">+</span> p<span class="token punctuation">)</span> <span class="token operator">%</span> p <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//x&amp;#x53EF;&amp;#x80FD;&amp;#x4E3A;&amp;#x8D1F;&amp;#x6570;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//3.&amp;#x5F53;p&amp;#x4E3A;&amp;#x8D28;&amp;#x6570;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;O(n)&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x5185;&amp;#x6C42;&amp;#x591A;&amp;#x4E2A;&amp;#x6570;&amp;#x5173;&amp;#x4E8E;p&amp;#x7684;&amp;#x9006;&amp;#x5143;</span>
<span class="token keyword">int</span> <span class="token function">inv3</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//&amp;#x6C42;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x7684;&amp;#x9006;&amp;#x5143;&amp;#x65F6;</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> p<span class="token operator">/</span>a<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">inv3</span><span class="token punctuation">(</span>p<span class="token operator">%</span>a <span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">%</span>p <span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
<span class="token keyword">int</span> ainv<span class="token punctuation">[</span><span class="token number">3003</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">ex_inv</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ainv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        ainv<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> p<span class="token operator">/</span>i<span class="token punctuation">)</span> <span class="token operator">*</span> ainv<span class="token punctuation">[</span>p<span class="token operator">%</span>i<span class="token punctuation">]</span> <span class="token operator">%</span> p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x6B27;&#x62C9;&#x51FD;&#x6570;"><a href="#&#x6B27;&#x62C9;&#x51FD;&#x6570;" class="headerlink" title="&#x6B27;&#x62C9;&#x51FD;&#x6570;"></a>&#x6B27;&#x62C9;&#x51FD;&#x6570;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl puts("")</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e4</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> phi<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span> vis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> prim<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&amp;#x5728;O(sqrt(n))&amp;#x4E0B;&amp;#x6C42;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x7684;&amp;#x6B27;&amp;#x62C9;&amp;#x51FD;&amp;#x6570;&amp;#x503C;</span>
<span class="token keyword">int</span> <span class="token function">Phi</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> n<span class="token punctuation">,</span> a <span class="token operator">=</span> n<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">*</span>i<span class="token operator">&lt;=</span>a<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">%</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token operator">=</span>res<span class="token operator">/</span>i<span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&amp;#x9632;&amp;#x6EA2;&amp;#x51FA;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>a<span class="token operator">%</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> a<span class="token operator">/</span><span class="token operator">=</span>i<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span> res<span class="token operator">=</span>res<span class="token operator">/</span>a<span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&amp;#x5269;&amp;#x4E0B;&amp;#x7684;&amp;#x9664;&amp;#x4E0D;&amp;#x5B8C;&amp;#x7684;a&amp;#x5FC5;&amp;#x4E3A;&amp;#x8D28;&amp;#x6570;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x6B27;&amp;#x62C9;&amp;#x7B5B;&amp;#x6539;&amp;#xFF0C;&amp;#x5728;O(n)&amp;#x4E0B;&amp;#x9012;&amp;#x63A8;&amp;#x6C42;&amp;#x6B27;&amp;#x62C9;&amp;#x51FD;&amp;#x6570;&amp;#x503C;&amp;#xFF0C;&amp;#x540C;&amp;#x65F6;&amp;#x7B5B;&amp;#x51FA;&amp;#x8D28;&amp;#x6570;</span>
<span class="token keyword">void</span> <span class="token function">Get_Phi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    phi<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>maxn<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            prim<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            phi<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token number">-1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>prim<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>i<span class="token operator">*</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;=</span>maxn<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            vis<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">%</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                phi<span class="token punctuation">[</span>i<span class="token operator">*</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> phi<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> phi<span class="token punctuation">[</span>i<span class="token operator">*</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> phi<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> phi<span class="token punctuation">[</span>prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x7B5B;&amp;#x51FA;&amp;#x4E86;n&amp;#x4EE5;&amp;#x5185;&amp;#x7684;&amp;#x6B27;&amp;#x62C9;&amp;#x51FD;&amp;#x6570;&amp;#x503C;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x5927;&amp;#x4E8E;n&amp;#x7684;&amp;#x6B27;&amp;#x62C9;&amp;#x51FD;&amp;#x6570;&amp;#x503C;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x7528;&amp;#x6027;&amp;#x8D28;&amp;#x7F29;&amp;#x5C0F;&amp;#x81F3;[1,n]&amp;#x5185;&amp;#x6C42;&amp;#x89E3;</span>
<span class="token keyword">int</span> <span class="token function">_Phi</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>prim<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> maxn<span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token operator">*</span>phi<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">%</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            n<span class="token operator">/</span><span class="token operator">=</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">%</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> res<span class="token operator">*</span><span class="token operator">=</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                res<span class="token operator">*</span><span class="token operator">=</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">></span><span class="token function">sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&amp;#x8FD9;&amp;#x91CC;&amp;#x8BF4;&amp;#x660E;n&amp;#x5DF2;&amp;#x7ECF;&amp;#x4E3A;&amp;#x8D28;&amp;#x6570;&amp;#x4E86;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x4E00;&#x6B21;&#x540C;&#x4F59;&#x65B9;&#x7A0B;&#x548C;&#x4E8C;&#x6B21;&#x540C;&#x4F59;&#x65B9;&#x7A0B;"><a href="#&#x4E00;&#x6B21;&#x540C;&#x4F59;&#x65B9;&#x7A0B;&#x548C;&#x4E8C;&#x6B21;&#x540C;&#x4F59;&#x65B9;&#x7A0B;" class="headerlink" title="&#x4E00;&#x6B21;&#x540C;&#x4F59;&#x65B9;&#x7A0B;&#x548C;&#x4E8C;&#x6B21;&#x540C;&#x4F59;&#x65B9;&#x7A0B;"></a>&#x4E00;&#x6B21;&#x540C;&#x4F59;&#x65B9;&#x7A0B;&#x548C;&#x4E8C;&#x6B21;&#x540C;&#x4F59;&#x65B9;&#x7A0B;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//&amp;#x4E00;&amp;#x6B21;&amp;#x540C;&amp;#x4F59;&amp;#x65B9;&amp;#x7A0B;&amp;#xFF0C;&amp;#x4E8C;&amp;#x6B21;&amp;#x540C;&amp;#x4F59;&amp;#x65B9;&amp;#x7A0B;&amp;#xFF08;&amp;#x4E8C;&amp;#x6B21;&amp;#x5269;&amp;#x4F59;&amp;#xFF09;&amp;#x7684;&amp;#x6C42;&amp;#x89E3;</span>
<span class="token comment" spellcheck="true">//&amp;#x6CE8;&amp;#xFF1A;&amp;#x968F;&amp;#x673A;&amp;#x6570;&amp;#x751F;&amp;#x6210;&amp;#x51FD;&amp;#x6570;&amp;#x7684;&amp;#x5934;&amp;#x6587;&amp;#x4EF6;&amp;#xFF1A;cstdlib&amp;#x4E0E;ctime</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> random(a,b) (rand()%(b-a+1)+a)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl puts("")</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&amp;#x6C42;ax=b(mod p)&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x975E;&amp;#x8D1F;&amp;#x89E3;(&amp;#x6269;&amp;#x6B27;)</span>
<span class="token keyword">struct</span> One
<span class="token punctuation">{</span>
    ll a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>p<span class="token punctuation">,</span>x<span class="token punctuation">;</span>

    <span class="token function">One</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">One</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span>ll b<span class="token punctuation">,</span>ll p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">a</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">b</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">p</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">ex_gcd</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span> ll b<span class="token punctuation">,</span> ll<span class="token operator">&amp;</span> d<span class="token punctuation">,</span> ll<span class="token operator">&amp;</span> x<span class="token punctuation">,</span> ll<span class="token operator">&amp;</span> y<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//&amp;#x6269;&amp;#x6B27; </span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
            d <span class="token operator">=</span> a<span class="token punctuation">;</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> 
            <span class="token function">ex_gcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token operator">%</span>b<span class="token punctuation">,</span> d<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">-</span><span class="token operator">=</span> x<span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">/</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ll d<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
        <span class="token function">ex_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>p<span class="token punctuation">,</span>d<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ax+py=b</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token operator">%</span>d<span class="token punctuation">)</span> x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&amp;#x65E0;&amp;#x89E3;</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            x<span class="token operator">*</span><span class="token operator">=</span>b<span class="token operator">/</span>d<span class="token punctuation">;</span> y<span class="token operator">*</span><span class="token operator">=</span>b<span class="token operator">/</span>d<span class="token punctuation">;</span>
            x <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">%</span>p<span class="token operator">+</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cin <span class="token operator">>></span> a <span class="token operator">>></span> b <span class="token operator">>></span> p<span class="token punctuation">;</span>
        b <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token operator">%</span>p<span class="token operator">+</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
        <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"No solution!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">else</span> cout <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&amp;#x6C42;n&amp;#x5173;&amp;#x4E8E;p&amp;#x7684;&amp;#x4E8C;&amp;#x6B21;&amp;#x5269;&amp;#x4F59;&amp;#xFF08;&amp;#x5373;&amp;#x6C42;x^2=n(mod p)&amp;#x7684;&amp;#x89E3;&amp;#xFF09;</span>
<span class="token comment" spellcheck="true">//&amp;#x8BF4;&amp;#x660E;&amp;#xFF1A;&amp;#x660E;&amp;#x663E;&amp;#x89E3;&amp;#x4E3A;&amp;#x4E00;&amp;#x4E2A;&amp;#x5269;&amp;#x4F59;&amp;#x7C7B;&amp;#xFF08;&amp;#x5373;&amp;#x5982;&amp;#x679C;&amp;#x6709;&amp;#x89E3;&amp;#x5219;&amp;#x6709;&amp;#x65E0;&amp;#x7A77;&amp;#x4E2A;&amp;#x89E3;&amp;#xFF09;</span>
<span class="token comment" spellcheck="true">//&amp;#x82E5;x&amp;#x4E3A;&amp;#x89E3;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;x+mp&amp;#x4E5F;&amp;#x4E3A;&amp;#x89E3;&amp;#xFF0C;&amp;#x540C;&amp;#x65F6;&amp;#x5F88;&amp;#x663E;&amp;#x7136;&amp;#xFF0C;p-x&amp;#x4E5F;&amp;#x4E3A;&amp;#x89E3;&amp;#xFF0C;&amp;#x6545;&amp;#x57FA;&amp;#x672C;&amp;#x89E3;&amp;#x6709;&amp;#x4E24;&amp;#x4E2A;&amp;#xFF0C;x&amp;#x548C;p-x</span>

<span class="token comment" spellcheck="true">//&amp;#x4E8C;&amp;#x6B21;&amp;#x57DF;&amp;#xFF08;&amp;#x6709;&amp;#x7406;&amp;#x6570;&amp;#x7684;&amp;#x4E8C;&amp;#x6B21;&amp;#x6269;&amp;#x57DF;&amp;#xFF09;&amp;#x7C7B;&amp;#xFF0C;&amp;#x91CD;&amp;#x8F7D;&amp;#x4E86;&amp;#x4E58;&amp;#x53F7;&amp;#x548C;&amp;#x5FEB;&amp;#x901F;&amp;#x5E42;</span>
<span class="token keyword">struct</span> QuadraticFild
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//w&amp;#x4E3A;&amp;#x65E0;&amp;#x7406;&amp;#x6570;&amp;#x57DF;&amp;#xFF0C;x&amp;#x4E3A;&amp;#x6709;&amp;#x7406;&amp;#x6570;&amp;#x57DF;&amp;#x7684;&amp;#x503C;&amp;#xFF0C;y&amp;#x4E3A;&amp;#x65E0;&amp;#x7406;&amp;#x6570;&amp;#x57DF;&amp;#x7684;&amp;#x503C;&amp;#xFF0C;p&amp;#x4E3A;&amp;#x6A21;&amp;#x6570;</span>
    ll x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>w<span class="token punctuation">,</span>p<span class="token punctuation">;</span>
    <span class="token function">QuadraticFild</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">QuadraticFild</span><span class="token punctuation">(</span>ll x<span class="token punctuation">,</span>ll y<span class="token punctuation">,</span>ll w<span class="token punctuation">,</span>ll p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">w</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">p</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">//&amp;#x91CD;&amp;#x8F7D;&amp;#x4E58;&amp;#x53F7;</span>
    QuadraticFild <span class="token keyword">operator</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">const</span> QuadraticFild<span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        QuadraticFild ans<span class="token punctuation">;</span>
        ans<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">*</span>b<span class="token punctuation">.</span>x<span class="token operator">%</span>p <span class="token operator">+</span> y<span class="token operator">*</span>b<span class="token punctuation">.</span>y<span class="token operator">%</span>p<span class="token operator">*</span>w<span class="token operator">%</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> p<span class="token punctuation">;</span>
        ans<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">*</span>b<span class="token punctuation">.</span>y<span class="token operator">%</span>p <span class="token operator">+</span> y<span class="token operator">*</span>b<span class="token punctuation">.</span>x<span class="token operator">%</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> p <span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//&amp;#x4E00;&amp;#x5B9A;&amp;#x8981;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x6210;&amp;#x5458;&amp;#x53D8;&amp;#x91CF;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x5B8C;&amp;#x6BD5;&amp;#x540E;&amp;#x624D;&amp;#x80FD;&amp;#x8FD4;&amp;#x56DE;&amp;#xFF01;&amp;#xFF01;&amp;#xFF01;&amp;#xFF01;&amp;#xFF01;&amp;#xFF01;&amp;#xFF01;&amp;#xFF01;&amp;#xFF01;</span>
        ans<span class="token punctuation">.</span>w <span class="token operator">=</span> w<span class="token punctuation">;</span> ans<span class="token punctuation">.</span>p <span class="token operator">=</span> p<span class="token punctuation">;</span>
        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">//&amp;#x91CD;&amp;#x8F7D;&amp;#x5FEB;&amp;#x901F;&amp;#x5E42;</span>
    QuadraticFild <span class="token keyword">operator</span> <span class="token operator">^</span> <span class="token punctuation">(</span>ll b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        QuadraticFild <span class="token function">res</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> a <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span> res <span class="token operator">=</span> res <span class="token operator">*</span> a<span class="token punctuation">;</span>
            b<span class="token operator">>>=</span><span class="token number">1</span><span class="token punctuation">;</span>
            a <span class="token operator">=</span> a<span class="token operator">*</span>a<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&amp;#x6C42;&amp;#x4E8C;&amp;#x6B21;&amp;#x5269;&amp;#x4F59;&amp;#x7C7B;</span>
<span class="token keyword">struct</span> Two
<span class="token punctuation">{</span>
    ll n<span class="token punctuation">,</span>p<span class="token punctuation">;</span>
    <span class="token function">Two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">Two</span><span class="token punctuation">(</span>ll n<span class="token punctuation">,</span>ll p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">p</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    
    ll <span class="token function">fastpow</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span>ll b<span class="token punctuation">,</span>ll m<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ll res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span> res <span class="token operator">=</span> res <span class="token operator">*</span> a <span class="token operator">%</span> m<span class="token punctuation">;</span>
            b <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            a <span class="token operator">=</span> a <span class="token operator">*</span> a <span class="token operator">%</span> m<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">//&amp;#x6C42;&amp;#x52D2;&amp;#x8BA9;&amp;#x5FB7;&amp;#x7B26;&amp;#x53F7;</span>
    ll <span class="token function">Legender</span><span class="token punctuation">(</span>ll a<span class="token punctuation">,</span>ll p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ll ans <span class="token operator">=</span> <span class="token function">fastpow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ans <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">==</span> p<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">bool</span> <span class="token function">solve</span><span class="token punctuation">(</span>ll<span class="token operator">&amp;</span> res<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ll a<span class="token punctuation">,</span>w<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">||</span> n <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//&amp;#x6B64;&amp;#x65F6;&amp;#x89E3;&amp;#x5B8C;&amp;#x5168;&amp;#x53D6;&amp;#x51B3;&amp;#x4E8E;n&amp;#xFF0C;&amp;#x53EA;&amp;#x6709;0&amp;#x6216;1&amp;#x4E24;&amp;#x4E2A;&amp;#x89E3;</span>
            res <span class="token operator">=</span> n<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>  
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">Legender</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&amp;#x65E0;&amp;#x89E3;</span>
        <span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">)</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//&amp;#x4E00;&amp;#x76F4;&amp;#x968F;&amp;#x673A;a&amp;#x76F4;&amp;#x5230;&amp;#x751F;&amp;#x6210;&amp;#x7684;w&amp;#x4E3A;&amp;#x5BF9;p&amp;#x7684;&amp;#x975E;&amp;#x4E8C;&amp;#x6B21;&amp;#x5269;&amp;#x4F59;</span>
            a <span class="token operator">=</span> <span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            w <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">*</span>a<span class="token operator">%</span>p<span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token operator">+</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">Legender</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span>p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        QuadraticFild <span class="token function">ans</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ans <span class="token operator">=</span> ans <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res <span class="token operator">=</span> ans<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cin <span class="token operator">>></span> n <span class="token operator">>></span> p<span class="token punctuation">;</span>
        ll res1<span class="token punctuation">,</span>res2<span class="token punctuation">;</span>
        n<span class="token operator">%</span><span class="token operator">=</span>p<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">solve</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"No solution!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        res2 <span class="token operator">=</span> p<span class="token operator">-</span>res1<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>res1 <span class="token operator">></span> res2<span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>res1<span class="token punctuation">,</span>res2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>res1 <span class="token operator">==</span> res2<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> res1 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">else</span> cout <span class="token operator">&lt;&lt;</span> res1 <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> res2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Two o<span class="token punctuation">;</span>
    o<span class="token punctuation">.</span><span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x9636;&#x4E58;&#x5206;&#x89E3;&#x8D28;&#x56E0;&#x6570;"><a href="#&#x9636;&#x4E58;&#x5206;&#x89E3;&#x8D28;&#x56E0;&#x6570;" class="headerlink" title="&#x9636;&#x4E58;&#x5206;&#x89E3;&#x8D28;&#x56E0;&#x6570;"></a>&#x9636;&#x4E58;&#x5206;&#x89E3;&#x8D28;&#x56E0;&#x6570;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e6</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> vis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span> prim<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span> cnt<span class="token punctuation">;</span>

<span class="token keyword">int</span> n<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">get_prim</span><span class="token punctuation">(</span><span class="token keyword">int</span> nn<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> nn<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> prim<span class="token punctuation">[</span><span class="token operator">++</span> cnt<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">*</span> prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> nn<span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            vis<span class="token punctuation">[</span>i <span class="token operator">*</span> prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">%</span> prim<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">get_prim</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> cnt<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token keyword">long</span> j <span class="token operator">=</span> prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token number">1ll</span> <span class="token operator">*</span> n <span class="token operator">/</span> j <span class="token punctuation">;</span> j <span class="token operator">*</span><span class="token operator">=</span> <span class="token number">1ll</span> <span class="token operator">*</span> prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> res <span class="token operator">+</span><span class="token operator">=</span> n <span class="token operator">/</span> j<span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span> prim<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x8BD5;&#x9664;&#x6CD5;&#x6C42;&#x7EA6;&#x6570;"><a href="#&#x8BD5;&#x9664;&#x6CD5;&#x6C42;&#x7EA6;&#x6570;" class="headerlink" title="&#x8BD5;&#x9664;&#x6CD5;&#x6C42;&#x7EA6;&#x6570;"></a>&#x8BD5;&#x9664;&#x6CD5;&#x6C42;&#x7EA6;&#x6570;</h3><pre class=" language-cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">get_divisors</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> res<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> x <span class="token operator">/</span> i<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> x <span class="token operator">/</span> i<span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>x <span class="token operator">/</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token function">sort</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x7EBF;&#x6027;&#x4EE3;&#x6570;"><a href="#&#x7EBF;&#x6027;&#x4EE3;&#x6570;" class="headerlink" title="&#x7EBF;&#x6027;&#x4EE3;&#x6570;"></a>&#x7EBF;&#x6027;&#x4EE3;&#x6570;</h2><h3 id="&#x9AD8;&#x65AF;&#x6D88;&#x5143;&#x89E3;&#x7EBF;&#x6027;&#x65B9;&#x7A0B;&#x7EC4;"><a href="#&#x9AD8;&#x65AF;&#x6D88;&#x5143;&#x89E3;&#x7EBF;&#x6027;&#x65B9;&#x7A0B;&#x7EC4;" class="headerlink" title="&#x9AD8;&#x65AF;&#x6D88;&#x5143;&#x89E3;&#x7EBF;&#x6027;&#x65B9;&#x7A0B;&#x7EC4;"></a>&#x9AD8;&#x65AF;&#x6D88;&#x5143;&#x89E3;&#x7EBF;&#x6027;&#x65B9;&#x7A0B;&#x7EC4;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">;</span>
<span class="token keyword">double</span> inp<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">guass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> c <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> c <span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> t <span class="token operator">=</span> r<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> r<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token function">fabs</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                t <span class="token operator">=</span> i<span class="token punctuation">;</span>
        
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> c<span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">>=</span> c<span class="token punctuation">;</span> j <span class="token operator">--</span><span class="token punctuation">)</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">/</span><span class="token operator">=</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">;</span>
        
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">>=</span> c<span class="token punctuation">;</span> j <span class="token operator">--</span><span class="token punctuation">)</span>
                a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span><span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        
        <span class="token operator">++</span> r<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n<span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">--</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> n<span class="token punctuation">;</span> j <span class="token operator">></span> i<span class="token punctuation">;</span> j <span class="token operator">--</span><span class="token punctuation">)</span>
            a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span><span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            
    <span class="token comment" spellcheck="true">/*
    if (r &lt; n)
    {
        for (int i = r; i &lt; n; i ++ )
            if (fabs(a[i][n]) > eps)
                return 2; // &amp;#x65E0;&amp;#x89E3;
        return 1; // &amp;#x6709;&amp;#x65E0;&amp;#x7A77;&amp;#x591A;&amp;#x7EC4;&amp;#x89E3;
    }
    */</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%lf"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>inp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span>
            a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>inp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> inp<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span>
            a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> inp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> inp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> inp<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> inp<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token function">guass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%.3f "</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x9AD8;&#x65AF;&#x6D88;&#x5143;&#x89E3;&#x5F02;&#x6216;&#x7EBF;&#x6027;&#x65B9;&#x7A0B;&#x7EC4;"><a href="#&#x9AD8;&#x65AF;&#x6D88;&#x5143;&#x89E3;&#x5F02;&#x6216;&#x7EBF;&#x6027;&#x65B9;&#x7A0B;&#x7EC4;" class="headerlink" title="&#x9AD8;&#x65AF;&#x6D88;&#x5143;&#x89E3;&#x5F02;&#x6216;&#x7EBF;&#x6027;&#x65B9;&#x7A0B;&#x7EC4;"></a>&#x9AD8;&#x65AF;&#x6D88;&#x5143;&#x89E3;&#x5F02;&#x6216;&#x7EBF;&#x6027;&#x65B9;&#x7A0B;&#x7EC4;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> T<span class="token punctuation">,</span> n<span class="token punctuation">,</span> a<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">fastpow</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token keyword">long</span> a<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token keyword">long</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">long</span> <span class="token keyword">long</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> res <span class="token operator">*</span><span class="token operator">=</span> a<span class="token punctuation">;</span>
        b <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        a <span class="token operator">*</span><span class="token operator">=</span> a<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">guass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> c<span class="token punctuation">,</span> r<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>c <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> c <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> c <span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> t <span class="token operator">=</span> r<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">></span> a<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span>
                t <span class="token operator">=</span> i<span class="token punctuation">;</span>
        
        <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">continue</span> <span class="token punctuation">;</span>
        
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> c<span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">>=</span> c<span class="token punctuation">;</span> j <span class="token operator">--</span><span class="token punctuation">)</span>
                    a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        
        <span class="token operator">++</span> r<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&lt;=</span> n<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n<span class="token punctuation">;</span> i <span class="token operator">>=</span> r<span class="token punctuation">;</span> i <span class="token operator">--</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">fastpow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> n <span class="token operator">-</span> r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>T <span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">memset</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>x<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span><span class="token operator">=</span>x<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> 
        <span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>y<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">EOF</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">&amp;&amp;</span> y<span class="token punctuation">)</span> a<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//error</span>
        
        <span class="token keyword">long</span> <span class="token keyword">long</span> t <span class="token operator">=</span> <span class="token function">guass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Oh,it&amp;apos;s impossible~!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x7EC4;&#x5408;&#x6570;&#x5B66;"><a href="#&#x7EC4;&#x5408;&#x6570;&#x5B66;" class="headerlink" title="&#x7EC4;&#x5408;&#x6570;&#x5B66;"></a>&#x7EC4;&#x5408;&#x6570;&#x5B66;</h2><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//&amp;#x9012;&amp;#x63A8;&amp;#x6C42;&amp;#x7EC4;&amp;#x5408;&amp;#x6570;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> i<span class="token punctuation">;</span> j <span class="token operator">++</span> <span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>j<span class="token punctuation">)</span> c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> mod<span class="token punctuation">;</span>



<span class="token comment" spellcheck="true">////////////////////////////////////////////////////////////////////</span>
<span class="token comment" spellcheck="true">//&amp;#x9006;&amp;#x5143;&amp;#x6C42;&amp;#x7EC4;&amp;#x5408;&amp;#x6570;</span>
<span class="token keyword">int</span> <span class="token function">qmi</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">// &amp;#x5FEB;&amp;#x901F;&amp;#x5E42;&amp;#x6A21;&amp;#x677F;</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>k<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token punctuation">(</span>LL<span class="token punctuation">)</span>res <span class="token operator">*</span> a <span class="token operator">%</span> p<span class="token punctuation">;</span>
        a <span class="token operator">=</span> <span class="token punctuation">(</span>LL<span class="token punctuation">)</span>a <span class="token operator">*</span> a <span class="token operator">%</span> p<span class="token punctuation">;</span>
        k <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// &amp;#x9884;&amp;#x5904;&amp;#x7406;&amp;#x9636;&amp;#x4E58;&amp;#x7684;&amp;#x4F59;&amp;#x6570;&amp;#x548C;&amp;#x9636;&amp;#x4E58;&amp;#x9006;&amp;#x5143;&amp;#x7684;&amp;#x4F59;&amp;#x6570;</span>
fact<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> infact<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    fact<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>LL<span class="token punctuation">)</span>fact<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> i <span class="token operator">%</span> mod<span class="token punctuation">;</span>
    infact<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>LL<span class="token punctuation">)</span>infact<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">qmi</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> mod <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> mod<span class="token punctuation">)</span> <span class="token operator">%</span> mod<span class="token punctuation">;</span>
<span class="token punctuation">}</span>



<span class="token comment" spellcheck="true">////////////////////////////////////////////////////////////////////</span>
<span class="token comment" spellcheck="true">//lucas&amp;#x5B9A;&amp;#x7406;&amp;#x6C42;&amp;#x7EC4;&amp;#x5408;&amp;#x6570;</span>
<span class="token operator">&amp;</span>#x82E5<span class="token punctuation">;</span>p<span class="token operator">&amp;</span>#x662F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8D28<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5219<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5BF9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E8E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EFB<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x610F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6574<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> m <span class="token operator">&lt;=</span> n<span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6709<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span>
    <span class="token function">C</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">C</span><span class="token punctuation">(</span>n <span class="token operator">%</span> p<span class="token punctuation">,</span> m <span class="token operator">%</span> p<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">C</span><span class="token punctuation">(</span>n <span class="token operator">/</span> p<span class="token punctuation">,</span> m <span class="token operator">/</span> p<span class="token punctuation">)</span> <span class="token punctuation">(</span>mod p<span class="token punctuation">)</span>

<span class="token keyword">int</span> <span class="token function">qmi</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// &amp;#x5FEB;&amp;#x901F;&amp;#x5E42;&amp;#x6A21;&amp;#x677F;</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">%</span> p<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>k<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token punctuation">(</span>LL<span class="token punctuation">)</span>res <span class="token operator">*</span> a <span class="token operator">%</span> p<span class="token punctuation">;</span>
        a <span class="token operator">=</span> <span class="token punctuation">(</span>LL<span class="token punctuation">)</span>a <span class="token operator">*</span> a <span class="token operator">%</span> p<span class="token punctuation">;</span>
        k <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">C</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// &amp;#x901A;&amp;#x8FC7;&amp;#x5B9A;&amp;#x7406;&amp;#x6C42;&amp;#x7EC4;&amp;#x5408;&amp;#x6570;C(a, b)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&lt;</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

    LL x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// x&amp;#x662F;&amp;#x5206;&amp;#x5B50;&amp;#xFF0C;y&amp;#x662F;&amp;#x5206;&amp;#x6BCD;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> a<span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> b<span class="token punctuation">;</span> i <span class="token operator">--</span><span class="token punctuation">,</span> j <span class="token operator">++</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        x <span class="token operator">=</span> <span class="token punctuation">(</span>LL<span class="token punctuation">)</span>x <span class="token operator">*</span> i <span class="token operator">%</span> p<span class="token punctuation">;</span>
        y <span class="token operator">=</span> <span class="token punctuation">(</span>LL<span class="token punctuation">)</span> y <span class="token operator">*</span> j <span class="token operator">%</span> p<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> x <span class="token operator">*</span> <span class="token punctuation">(</span>LL<span class="token punctuation">)</span><span class="token function">qmi</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> p <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">%</span> p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">lucas</span><span class="token punctuation">(</span>LL a<span class="token punctuation">,</span> LL b<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&lt;</span> p <span class="token operator">&amp;&amp;</span> b <span class="token operator">&lt;</span> p<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">C</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>LL<span class="token punctuation">)</span><span class="token function">C</span><span class="token punctuation">(</span>a <span class="token operator">%</span> p<span class="token punctuation">,</span> b <span class="token operator">%</span> p<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">lucas</span><span class="token punctuation">(</span>a <span class="token operator">/</span> p<span class="token punctuation">,</span> b <span class="token operator">/</span> p<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">%</span> p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>



<span class="token comment" spellcheck="true">////////////////////////////////////////////////////////////////////////</span>
<span class="token comment" spellcheck="true">//&amp;#x5206;&amp;#x89E3;&amp;#x8D28;&amp;#x56E0;&amp;#x6570;&amp;#x6C42;&amp;#x7EC4;&amp;#x5408;&amp;#x6570;</span>
<span class="token operator">&amp;</span>#x5F53<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6211<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4EEC<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9700<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8981<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6C42<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x51FA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7EC4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5408<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x771F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B9E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x503C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x800C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x975E<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5BF9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x67D0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4F59<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65F6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF0C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5206<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x89E3<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8D28<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56E0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65B9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5F0F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6BD4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8F83<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x597D<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7528<span class="token punctuation">;</span><span class="token operator">&amp;</span>#xFF1A<span class="token punctuation">;</span>
    <span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">&amp;</span>#x7B5B<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6CD5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6C42<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x51FA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8303<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56F4<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5185<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6240<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6709<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8D28<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span>
    <span class="token number">2</span><span class="token punctuation">.</span> <span class="token operator">&amp;</span>#x901A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8FC7<span class="token punctuation">;</span> <span class="token function">C</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=</span> a<span class="token operator">!</span> <span class="token operator">/</span> b<span class="token operator">!</span> <span class="token operator">/</span> <span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token operator">!</span> <span class="token operator">&amp;</span>#x8FD9<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x516C<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5F0F<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6C42<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x51FA<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6BCF<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E2A<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8D28<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56E0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B50<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6B21<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x3002<span class="token punctuation">;</span> n<span class="token operator">!</span> <span class="token operator">&amp;</span>#x4E2D<span class="token punctuation">;</span>p<span class="token operator">&amp;</span>#x7684<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6B21<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6570<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x662F<span class="token punctuation">;</span> n <span class="token operator">/</span> p <span class="token operator">+</span> n <span class="token operator">/</span> p<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> n <span class="token operator">/</span> p<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token number">3</span><span class="token punctuation">.</span> <span class="token operator">&amp;</span>#x7528<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x9AD8<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x7CBE<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5EA6<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E58<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6CD5<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5C06<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6240<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6709<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x8D28<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x56E0<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x5B50<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x76F8<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x4E58<span class="token punctuation">;</span>

<span class="token keyword">int</span> primes<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> cnt<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// &amp;#x5B58;&amp;#x50A8;&amp;#x6240;&amp;#x6709;&amp;#x8D28;&amp;#x6570;</span>
<span class="token keyword">int</span> sum<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// &amp;#x5B58;&amp;#x50A8;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8D28;&amp;#x6570;&amp;#x7684;&amp;#x6B21;&amp;#x6570;</span>
<span class="token keyword">bool</span> st<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// &amp;#x5B58;&amp;#x50A8;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x662F;&amp;#x5426;&amp;#x5DF2;&amp;#x88AB;&amp;#x7B5B;&amp;#x6389;</span>


<span class="token keyword">void</span> <span class="token function">get_primes</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>      <span class="token comment" spellcheck="true">// &amp;#x7EBF;&amp;#x6027;&amp;#x7B5B;&amp;#x6CD5;&amp;#x6C42;&amp;#x7D20;&amp;#x6570;</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>st<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> primes<span class="token punctuation">[</span>cnt <span class="token operator">++</span> <span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> primes<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> n <span class="token operator">/</span> i<span class="token punctuation">;</span> j <span class="token operator">++</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            st<span class="token punctuation">[</span>primes<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> primes<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span>       <span class="token comment" spellcheck="true">// &amp;#x6C42;n&amp;#xFF01;&amp;#x4E2D;&amp;#x7684;&amp;#x6B21;&amp;#x6570;</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        res <span class="token operator">+</span><span class="token operator">=</span> n <span class="token operator">/</span> p<span class="token punctuation">;</span>
        n <span class="token operator">/</span><span class="token operator">=</span> p<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">mul</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>       <span class="token comment" spellcheck="true">// &amp;#x9AD8;&amp;#x7CBE;&amp;#x5EA6;&amp;#x4E58;&amp;#x4F4E;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6A21;&amp;#x677F;</span>
<span class="token punctuation">{</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> c<span class="token punctuation">;</span>
    <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        t <span class="token operator">+</span><span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> b<span class="token punctuation">;</span>
        c<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>t <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t <span class="token operator">/</span><span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>t<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        c<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>t <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t <span class="token operator">/</span><span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">get_primes</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// &amp;#x9884;&amp;#x5904;&amp;#x7406;&amp;#x8303;&amp;#x56F4;&amp;#x5185;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x8D28;&amp;#x6570;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cnt<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">// &amp;#x6C42;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8D28;&amp;#x56E0;&amp;#x6570;&amp;#x7684;&amp;#x6B21;&amp;#x6570;</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> p <span class="token operator">=</span> primes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    sum<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">get</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">get</span><span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> res<span class="token punctuation">;</span>
res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cnt<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">// &amp;#x7528;&amp;#x9AD8;&amp;#x7CBE;&amp;#x5EA6;&amp;#x4E58;&amp;#x6CD5;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x8D28;&amp;#x56E0;&amp;#x5B50;&amp;#x76F8;&amp;#x4E58;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> sum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> j <span class="token operator">++</span> <span class="token punctuation">)</span>
        res <span class="token operator">=</span> <span class="token function">mul</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> primes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="&#x5BB9;&#x65A5;&#x539F;&#x7406;"><a href="#&#x5BB9;&#x65A5;&#x539F;&#x7406;" class="headerlink" title="&#x5BB9;&#x65A5;&#x539F;&#x7406;"></a>&#x5BB9;&#x65A5;&#x539F;&#x7406;</h2><p>&#x6C42;1&#x5230;n&#x4E2D;&#x81F3;&#x5C11;&#x88AB;p1,p2,&#x2026;,pm&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6574;&#x9664;&#x7684;&#x4E2A;&#x6570;</p>
<pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> LL<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> p<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> cin <span class="token operator">>></span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> j <span class="token operator">++</span> <span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>></span> j <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>LL<span class="token punctuation">)</span>t <span class="token operator">*</span> p<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> n<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    t <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                t <span class="token operator">*</span><span class="token operator">=</span> p<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                s <span class="token operator">++</span> <span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> res <span class="token operator">+</span><span class="token operator">=</span> n <span class="token operator">/</span> t<span class="token punctuation">;</span>
            <span class="token keyword">else</span> res <span class="token operator">-</span><span class="token operator">=</span> n <span class="token operator">/</span> t<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    cout <span class="token operator">&lt;&lt;</span> res <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x535A;&#x5F08;&#x8BBA;"><a href="#&#x535A;&#x5F08;&#x8BBA;" class="headerlink" title="&#x535A;&#x5F08;&#x8BBA;"></a>&#x535A;&#x5F08;&#x8BBA;</h2><h1 id="&#x6570;&#x636E;&#x7ED3;&#x6784;"><a href="#&#x6570;&#x636E;&#x7ED3;&#x6784;" class="headerlink" title="&#x6570;&#x636E;&#x7ED3;&#x6784;"></a>&#x6570;&#x636E;&#x7ED3;&#x6784;</h1><h2 id="&#x57FA;&#x7840;&#x6570;&#x636E;&#x7ED3;&#x6784;"><a href="#&#x57FA;&#x7840;&#x6570;&#x636E;&#x7ED3;&#x6784;" class="headerlink" title="&#x57FA;&#x7840;&#x6570;&#x636E;&#x7ED3;&#x6784;"></a>&#x57FA;&#x7840;&#x6570;&#x636E;&#x7ED3;&#x6784;</h2><h3 id="&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5DEE;&#x5206;&#x6811;&#x72B6;&#x6570;&#x7EC4;&#x6C42;&#x533A;&#x95F4;&#x4FEE;&#x6539;&#x5355;&#x70B9;&#x67E5;&#x8BE2;&#xFF09;"><a href="#&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5DEE;&#x5206;&#x6811;&#x72B6;&#x6570;&#x7EC4;&#x6C42;&#x533A;&#x95F4;&#x4FEE;&#x6539;&#x5355;&#x70B9;&#x67E5;&#x8BE2;&#xFF09;" class="headerlink" title="&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5DEE;&#x5206;&#x6811;&#x72B6;&#x6570;&#x7EC4;&#x6C42;&#x533A;&#x95F4;&#x4FEE;&#x6539;&#x5355;&#x70B9;&#x67E5;&#x8BE2;&#xFF09;"></a>&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5DEE;&#x5206;&#x6811;&#x72B6;&#x6570;&#x7EC4;&#x6C42;&#x533A;&#x95F4;&#x4FEE;&#x6539;&#x5355;&#x70B9;&#x67E5;&#x8BE2;&#xFF09;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//luoguP3368&amp;#x6811;&amp;#x72B6;&amp;#x6570;&amp;#x7EC4;&amp;#x6A21;&amp;#x677F;2</span>
<span class="token comment" spellcheck="true">//&amp;#x533A;&amp;#x95F4;&amp;#x4FEE;&amp;#x6539;&amp;#xFF0C;&amp;#x5355;&amp;#x70B9;&amp;#x67E5;&amp;#x8BE2;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl cout &lt;&lt; "\n"</span>
<span class="token macro property">#<span class="token directive keyword">define</span> jud cout &lt;&lt; "caonima" &lt;&lt; endl;</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pll pair&lt;long long,long long></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token macro property">#<span class="token directive keyword">define</span> Clear(x) while(!x.empty())x.pop()</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pqg(type) priority_queue&lt;type,vector&lt;type>,greater&lt;type>></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pql(type) priority_queue&lt;type,vector&lt;type>,less&lt;type>></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">5e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>op<span class="token punctuation">,</span>a<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">lowbit</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x628A;&amp;#x5DEE;&amp;#x5206;&amp;#x6811;&amp;#x72B6;&amp;#x6570;&amp;#x7EC4;&amp;#x4F4D;&amp;#x7F6E;&amp;#x4E3A;x&amp;#x7684;&amp;#x6570;&amp;#x52A0;&amp;#x4E0A;k</span>
<span class="token keyword">void</span> <span class="token function">updata</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        c<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> k<span class="token punctuation">;</span>
        x <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x6C42;&amp;#x5DEE;&amp;#x5206;&amp;#x6811;&amp;#x72B6;&amp;#x6570;&amp;#x7EC4;&amp;#x533A;&amp;#x95F4;1-x&amp;#x7684;&amp;#x503C;</span>
<span class="token keyword">int</span> <span class="token function">getsum</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res <span class="token operator">+</span><span class="token operator">=</span> c<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
        x <span class="token operator">-</span><span class="token operator">=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> cin <span class="token operator">>></span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>a<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">updata</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>d<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cin <span class="token operator">>></span> op<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x <span class="token operator">>></span> y <span class="token operator">>></span> k<span class="token punctuation">;</span>
            d<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> k<span class="token punctuation">;</span> d<span class="token punctuation">[</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span><span class="token operator">=</span> k<span class="token punctuation">;</span>
            <span class="token function">updata</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">updata</span><span class="token punctuation">(</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> x<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x<span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token function">getsum</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5DEE;&#x5206;&#x6811;&#x72B6;&#x6570;&#x7EC4;&#x6C42;&#x533A;&#x95F4;&#x4FEE;&#x6539;&#x533A;&#x95F4;&#x67E5;&#x8BE2;&#xFF09;"><a href="#&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5DEE;&#x5206;&#x6811;&#x72B6;&#x6570;&#x7EC4;&#x6C42;&#x533A;&#x95F4;&#x4FEE;&#x6539;&#x533A;&#x95F4;&#x67E5;&#x8BE2;&#xFF09;" class="headerlink" title="&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5DEE;&#x5206;&#x6811;&#x72B6;&#x6570;&#x7EC4;&#x6C42;&#x533A;&#x95F4;&#x4FEE;&#x6539;&#x533A;&#x95F4;&#x67E5;&#x8BE2;&#xFF09;"></a>&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5DEE;&#x5206;&#x6811;&#x72B6;&#x6570;&#x7EC4;&#x6C42;&#x533A;&#x95F4;&#x4FEE;&#x6539;&#x533A;&#x95F4;&#x67E5;&#x8BE2;&#xFF09;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//Poj3468&amp;#x6811;&amp;#x72B6;&amp;#x6570;&amp;#x7EC4;&amp;#x6A21;&amp;#x677F;3</span>
<span class="token comment" spellcheck="true">//&amp;#x533A;&amp;#x95F4;&amp;#x4FEE;&amp;#x6539;&amp;#xFF0C;&amp;#x533A;&amp;#x95F4;&amp;#x67E5;&amp;#x8BE2;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl cout &lt;&lt; "\n"</span>
<span class="token macro property">#<span class="token directive keyword">define</span> jud cout &lt;&lt; "caonima" &lt;&lt; endl;</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pll pair&lt;long long,long long></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token macro property">#<span class="token directive keyword">define</span> Clear(x) while(!x.empty())x.pop()</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pqg(type) priority_queue&lt;type,vector&lt;type>,greater&lt;type>></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pql(type) priority_queue&lt;type,vector&lt;type>,less&lt;type>></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">;</span>
ll a<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>c1<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>c2<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> op<span class="token punctuation">;</span>

ll <span class="token function">lowbit</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x628A;2&amp;#x4E2A;&amp;#x5DEE;&amp;#x5206;&amp;#x6811;&amp;#x72B6;&amp;#x6570;&amp;#x7EC4;&amp;#x4F4D;&amp;#x7F6E;&amp;#x4E3A;x&amp;#x7684;&amp;#x6570;&amp;#x52A0;&amp;#x4E0A;k</span>
<span class="token keyword">void</span> <span class="token function">updata</span><span class="token punctuation">(</span>ll x<span class="token punctuation">,</span>ll k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ll xx <span class="token operator">=</span> x<span class="token number">-1</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//(x-1)*k&amp;#x4E2D;&amp;#x7684;x&amp;#x662F;&amp;#x4E0D;&amp;#x53D8;&amp;#x7684;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        c1<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> k<span class="token punctuation">;</span>
        c2<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> k<span class="token operator">*</span>xx<span class="token punctuation">;</span>
        x <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x6C42;&amp;#x5DEE;&amp;#x5206;&amp;#x6811;&amp;#x72B6;&amp;#x6570;&amp;#x7EC4;&amp;#x533A;&amp;#x95F4;1-x&amp;#x7684;&amp;#x503C;</span>
ll <span class="token function">getsum</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ll res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> xx <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res <span class="token operator">+</span><span class="token operator">=</span> xx<span class="token operator">*</span>c1<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">-</span>c2<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
        x <span class="token operator">-</span><span class="token operator">=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cin <span class="token operator">>></span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">updata</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>a<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cin <span class="token operator">>></span> op<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token operator">&amp;</span>apos<span class="token punctuation">;</span>C<span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ll x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x <span class="token operator">>></span> y <span class="token operator">>></span> k<span class="token punctuation">;</span>
            <span class="token function">updata</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">updata</span><span class="token punctuation">(</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            ll x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x <span class="token operator">>></span> y<span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token function">getsum</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">getsum</span><span class="token punctuation">(</span>x<span class="token number">-1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5355;&#x70B9;&#x4FEE;&#x6539;&#x533A;&#x95F4;&#x67E5;&#x8BE2;&#x5355;&#x70B9;&#x67E5;&#x8BE2;&#xFF09;"><a href="#&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5355;&#x70B9;&#x4FEE;&#x6539;&#x533A;&#x95F4;&#x67E5;&#x8BE2;&#x5355;&#x70B9;&#x67E5;&#x8BE2;&#xFF09;" class="headerlink" title="&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5355;&#x70B9;&#x4FEE;&#x6539;&#x533A;&#x95F4;&#x67E5;&#x8BE2;&#x5355;&#x70B9;&#x67E5;&#x8BE2;&#xFF09;"></a>&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF08;&#x5355;&#x70B9;&#x4FEE;&#x6539;&#x533A;&#x95F4;&#x67E5;&#x8BE2;&#x5355;&#x70B9;&#x67E5;&#x8BE2;&#xFF09;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//luoguP3374&amp;#x6811;&amp;#x72B6;&amp;#x6570;&amp;#x7EC4;&amp;#x6A21;&amp;#x677F;1</span>
<span class="token comment" spellcheck="true">//&amp;#x5355;&amp;#x70B9;&amp;#x4FEE;&amp;#x6539;&amp;#xFF0C;&amp;#x533A;&amp;#x95F4;&amp;#x5355;&amp;#x70B9;&amp;#x67E5;&amp;#x8BE2;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl cout &lt;&lt; "\n"</span>
<span class="token macro property">#<span class="token directive keyword">define</span> jud cout &lt;&lt; "caonima" &lt;&lt; endl;</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pll pair&lt;long long,long long></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token macro property">#<span class="token directive keyword">define</span> Clear(x) while(!x.empty())x.pop()</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pqg(type) priority_queue&lt;type,vector&lt;type>,greater&lt;type>></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pql(type) priority_queue&lt;type,vector&lt;type>,less&lt;type>></span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">5e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>op<span class="token punctuation">,</span>a<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">lowbit</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x5728;x&amp;#x4F4D;&amp;#x7F6E;&amp;#x7684;&amp;#x6570;&amp;#x52A0;&amp;#x4E0A;k</span>
<span class="token keyword">void</span> <span class="token function">updata</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        c<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> k<span class="token punctuation">;</span>
        x <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x6C42;&amp;#x533A;&amp;#x95F4;1-x&amp;#x4E4B;&amp;#x548C;</span>
<span class="token keyword">int</span> <span class="token function">getsum</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res <span class="token operator">+</span><span class="token operator">=</span> c<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
        x <span class="token operator">-</span><span class="token operator">=</span> <span class="token function">lowbit</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> cin <span class="token operator">>></span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">updata</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cin <span class="token operator">>></span> op<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> x<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x <span class="token operator">>></span> k<span class="token punctuation">;</span>
            a<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> k<span class="token punctuation">;</span>
            <span class="token function">updata</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> x <span class="token operator">>></span> y<span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token function">getsum</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">getsum</span><span class="token punctuation">(</span>x<span class="token number">-1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x7EBF;&#x6BB5;&#x6811;&#xFF08;&#x52A0;&#x6CD5;&#xFF09;"><a href="#&#x7EBF;&#x6BB5;&#x6811;&#xFF08;&#x52A0;&#x6CD5;&#xFF09;" class="headerlink" title="&#x7EBF;&#x6BB5;&#x6811;&#xFF08;&#x52A0;&#x6CD5;&#xFF09;"></a>&#x7EBF;&#x6BB5;&#x6811;&#xFF08;&#x52A0;&#x6CD5;&#xFF09;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//&amp;#x6D1B;&amp;#x8C37;P3372&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;1</span>
<span class="token comment" spellcheck="true">//&amp;#x533A;&amp;#x95F4;&amp;#x52A0;&amp;#x4E0E;&amp;#x6C42;&amp;#x533A;&amp;#x95F4;&amp;#x548C;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl puts("")</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>op<span class="token punctuation">,</span>_root<span class="token punctuation">,</span>cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
ll k<span class="token punctuation">;</span>
<span class="token keyword">struct</span> Node<span class="token punctuation">{</span>
    <span class="token keyword">int</span> l<span class="token punctuation">,</span>r<span class="token punctuation">,</span>lson<span class="token punctuation">,</span>rson<span class="token punctuation">;</span>
    ll ans<span class="token punctuation">,</span>tag<span class="token punctuation">;</span>
<span class="token punctuation">}</span>tr<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">pushup</span><span class="token punctuation">(</span><span class="token keyword">int</span> lson<span class="token punctuation">,</span><span class="token keyword">int</span> rson<span class="token punctuation">,</span><span class="token keyword">int</span> root<span class="token punctuation">)</span> <span class="token punctuation">{</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">+</span> tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">;</span>  <span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">pushdown</span><span class="token punctuation">(</span><span class="token keyword">int</span> lson<span class="token punctuation">,</span><span class="token keyword">int</span> rson<span class="token punctuation">,</span> <span class="token keyword">int</span> root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">+</span><span class="token operator">=</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">+</span><span class="token operator">=</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">+</span><span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">-</span> tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">+</span><span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">-</span> tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    root <span class="token operator">=</span> <span class="token operator">++</span>cnt<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">=</span> l<span class="token punctuation">,</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">=</span> r<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%lld"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token function">build</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">build</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">updata</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">+</span><span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">-</span> l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> k<span class="token punctuation">;</span>
        tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">+</span><span class="token operator">=</span> k<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">!=</span>r <span class="token operator">&amp;&amp;</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">pushdown</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> <span class="token function">updata</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">></span> mid<span class="token punctuation">)</span> <span class="token function">updata</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ll <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> y<span class="token punctuation">)</span> <span class="token keyword">return</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">pushdown</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
    ll ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> ans <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">query</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">></span> mid<span class="token punctuation">)</span> ans <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">query</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">build</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>op<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%lld"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">,</span><span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">updata</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
     <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x7EBF;&#x6BB5;&#x6570;&#xFF08;&#x52A0;&#x4E58;&#x6CD5;&#xFF09;"><a href="#&#x7EBF;&#x6BB5;&#x6570;&#xFF08;&#x52A0;&#x4E58;&#x6CD5;&#xFF09;" class="headerlink" title="&#x7EBF;&#x6BB5;&#x6570;&#xFF08;&#x52A0;&#x4E58;&#x6CD5;&#xFF09;"></a>&#x7EBF;&#x6BB5;&#x6570;&#xFF08;&#x52A0;&#x4E58;&#x6CD5;&#xFF09;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//&amp;#x6D1B;&amp;#x8C37;P3372&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;2</span>
<span class="token comment" spellcheck="true">//&amp;#x533A;&amp;#x95F4;&amp;#x52A0;&amp;#x4E0E;&amp;#x533A;&amp;#x95F4;&amp;#x4E58;&amp;#x4E0E;&amp;#x6C42;&amp;#x533A;&amp;#x95F4;&amp;#x548C;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl puts("")</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>op<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>_root<span class="token punctuation">,</span>cnt<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
ll p<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
<span class="token keyword">struct</span> Node<span class="token punctuation">{</span>
    <span class="token keyword">int</span> l<span class="token punctuation">,</span>r<span class="token punctuation">,</span>lson<span class="token punctuation">,</span>rson<span class="token punctuation">;</span>
    ll ans<span class="token punctuation">,</span>tag1<span class="token punctuation">,</span>tag2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>tr<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">pushup</span><span class="token punctuation">(</span><span class="token keyword">int</span> lson<span class="token punctuation">,</span><span class="token keyword">int</span> rson<span class="token punctuation">,</span><span class="token keyword">int</span> root<span class="token punctuation">)</span> <span class="token punctuation">{</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">+</span> tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">pushdown</span><span class="token punctuation">(</span><span class="token keyword">int</span> lson<span class="token punctuation">,</span><span class="token keyword">int</span> rson<span class="token punctuation">,</span><span class="token keyword">int</span> root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token operator">+</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token operator">-</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">%</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token operator">+</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token operator">-</span>tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">%</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1 <span class="token operator">=</span> tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1 <span class="token operator">=</span> tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token operator">+</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>rson<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">*</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">%</span>p<span class="token operator">+</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    root <span class="token operator">=</span> <span class="token operator">++</span>cnt<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">=</span> l<span class="token punctuation">,</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">=</span> r<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%lld"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token function">build</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">build</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">updata1</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token operator">*</span>k<span class="token operator">%</span>p<span class="token punctuation">;</span>
        tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1 <span class="token operator">=</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">*</span>k<span class="token operator">%</span>p<span class="token punctuation">;</span>
        tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">*</span>k<span class="token operator">%</span>p<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">!=</span>r <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">!=</span><span class="token number">1</span> <span class="token operator">||</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">pushdown</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> <span class="token function">updata1</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">></span> mid<span class="token punctuation">)</span> <span class="token function">updata1</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">updata2</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token operator">+</span><span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>k<span class="token operator">%</span>p<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
        tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2 <span class="token operator">=</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">+</span>k<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">!=</span>r <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">!=</span><span class="token number">1</span> <span class="token operator">||</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">pushdown</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> <span class="token function">updata2</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">></span> mid<span class="token punctuation">)</span> <span class="token function">updata2</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ll <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> l <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;=</span> y<span class="token punctuation">)</span> <span class="token keyword">return</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>ans<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">!=</span>r <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag1<span class="token operator">!=</span><span class="token number">1</span> <span class="token operator">||</span> tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>tag2<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">pushdown</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
    ll ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> ans <span class="token operator">=</span> <span class="token punctuation">(</span>ans<span class="token operator">+</span><span class="token function">query</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>y <span class="token operator">></span> mid<span class="token punctuation">)</span> ans <span class="token operator">=</span> <span class="token punctuation">(</span>ans<span class="token operator">+</span><span class="token function">query</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">;</span>
    <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%lld"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">build</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>op<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> op <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%lld"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">,</span><span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">updata1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token function">updata2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>_root<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
     <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x53EF;&#x6301;&#x4E45;&#x5316;01&#x5B57;&#x5178;&#x6811;&#xFF08;&#x6700;&#x5927;&#x5F02;&#x6216;&#x548C;&#xFF09;"><a href="#&#x53EF;&#x6301;&#x4E45;&#x5316;01&#x5B57;&#x5178;&#x6811;&#xFF08;&#x6700;&#x5927;&#x5F02;&#x6216;&#x548C;&#xFF09;" class="headerlink" title="&#x53EF;&#x6301;&#x4E45;&#x5316;01&#x5B57;&#x5178;&#x6811;&#xFF08;&#x6700;&#x5927;&#x5F02;&#x6216;&#x548C;&#xFF09;"></a>&#x53EF;&#x6301;&#x4E45;&#x5316;01&#x5B57;&#x5178;&#x6811;&#xFF08;&#x6700;&#x5927;&#x5F02;&#x6216;&#x548C;&#xFF09;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">3e5</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> idx<span class="token punctuation">,</span> tr<span class="token punctuation">[</span>maxn <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> root<span class="token punctuation">[</span>maxn <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> maxl<span class="token punctuation">[</span>maxn <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>maxn <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> pos<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        maxl<span class="token punctuation">[</span>q<span class="token punctuation">]</span> <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> v <span class="token operator">=</span> s<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">>></span> k <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">[</span>v <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> tr<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span>v <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span> idx<span class="token punctuation">;</span>
    <span class="token function">insert</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> tr<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">,</span> tr<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    maxl<span class="token punctuation">[</span>q<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>maxl<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> maxl<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">~</span>k<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> v <span class="token operator">=</span> x <span class="token operator">>></span> k <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> maxl<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">>=</span> l<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res <span class="token operator">=</span> <span class="token punctuation">(</span>res <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">1</span><span class="token punctuation">;</span>
            q <span class="token operator">=</span> tr<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            res <span class="token operator">=</span> res <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
            q <span class="token operator">=</span> tr<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token operator">--</span> k<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    root<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span> idx<span class="token punctuation">;</span>
    <span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> root<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>x<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">;</span>
        root<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span> idx<span class="token punctuation">;</span>
        <span class="token function">insert</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> root<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">while</span><span class="token punctuation">(</span>m <span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">char</span> op<span class="token punctuation">;</span>
        <span class="token keyword">int</span> x<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"\n%c"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>op<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token operator">&amp;</span>apos<span class="token punctuation">;</span>A<span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">++</span> n<span class="token punctuation">;</span>
            s<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">;</span>
            root<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span> idx<span class="token punctuation">;</span>
            <span class="token function">insert</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> root<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> root<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>l<span class="token punctuation">,</span> <span class="token operator">&amp;</span>r<span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            x <span class="token operator">=</span> s<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> l <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> root<span class="token punctuation">[</span>r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x4E3B;&#x5E2D;&#x6811;&#xFF08;&#x533A;&#x95F4;&#x7B2C;k&#x5C0F;&#xFF09;"><a href="#&#x4E3B;&#x5E2D;&#x6811;&#xFF08;&#x533A;&#x95F4;&#x7B2C;k&#x5C0F;&#xFF09;" class="headerlink" title="&#x4E3B;&#x5E2D;&#x6811;&#xFF08;&#x533A;&#x95F4;&#x7B2C;k&#x5C0F;&#xFF09;"></a>&#x4E3B;&#x5E2D;&#x6811;&#xFF08;&#x533A;&#x95F4;&#x7B2C;k&#x5C0F;&#xFF09;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//&amp;#x6D1B;&amp;#x8C37;P3834&amp;#x4E3B;&amp;#x5E2D;&amp;#x6811;</span>
<span class="token comment" spellcheck="true">//&amp;#x533A;&amp;#x95F4;&amp;#x7B2C;k&amp;#x5C0F;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl puts("")</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">2e5</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> a<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>_root<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>k<span class="token punctuation">,</span>tot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> Node<span class="token punctuation">{</span>
    <span class="token keyword">int</span> lson<span class="token punctuation">,</span>rson<span class="token punctuation">,</span>dat<span class="token punctuation">;</span>
<span class="token punctuation">}</span>tr<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
set<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> se<span class="token punctuation">;</span>
map<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">></span> mp1<span class="token punctuation">,</span>mp2<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//mp1&amp;#x7531;&amp;#x8F93;&amp;#x5165;&amp;#x6570;&amp;#x636E;&amp;#x6620;&amp;#x5C04;&amp;#x81F3;&amp;#x79BB;&amp;#x6563;&amp;#x503C;&amp;#xFF0C;mp2&amp;#x76F8;&amp;#x53CD;</span>

<span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    root <span class="token operator">=</span> <span class="token operator">++</span>cnt<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>dat <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">;</span>
    <span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">build</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">build</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">updata</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root1<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root2<span class="token punctuation">,</span><span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    root2 <span class="token operator">=</span> <span class="token operator">++</span>cnt<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>dat <span class="token operator">=</span> tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>dat<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>lson <span class="token operator">=</span> tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>rson <span class="token operator">=</span> tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">;</span>
    <span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> <span class="token function">updata</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token function">updata</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root1<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>root2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span> mp2<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> c <span class="token operator">=</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>dat <span class="token operator">-</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">]</span><span class="token punctuation">.</span>dat<span class="token punctuation">;</span>
    <span class="token keyword">int</span> mid <span class="token operator">=</span> l<span class="token operator">+</span>r<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&lt;=</span> c<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">query</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>lson<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        k<span class="token operator">-</span><span class="token operator">=</span>c<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">query</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root1<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">,</span>tr<span class="token punctuation">[</span>root2<span class="token punctuation">]</span><span class="token punctuation">.</span>rson<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//freopen("data.in","r",stdin);</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span>a<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        se<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>se<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> mp1<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">(</span>se<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span>tot<span class="token punctuation">,</span> mp2<span class="token punctuation">[</span>tot<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>se<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> se<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>se<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _root<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">build</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>tot<span class="token punctuation">,</span>_root<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">updata</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>tot<span class="token punctuation">,</span>_root<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>_root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>mp1<span class="token punctuation">[</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>m<span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">,</span><span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>tot<span class="token punctuation">,</span>_root<span class="token punctuation">[</span>x<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>_root<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
     <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//&amp;#x6D1B;&amp;#x8C37;P3375KMP&amp;#x6A21;&amp;#x677F;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl puts("")</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e6</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> s<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>t<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> nex<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>slen<span class="token punctuation">,</span>tlen<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">getnext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    nex<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>j<span class="token operator">&lt;</span>tlen<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//&amp;#x6B63;&amp;#x5E38;&amp;#x60C5;&amp;#x51B5;&amp;#x53EA;&amp;#x9700;&amp;#x8981;j&lt;tlen-1&amp;#x5373;&amp;#x53EF;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> t<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token operator">++</span>j<span class="token punctuation">,</span> <span class="token operator">++</span>k<span class="token punctuation">;</span>
            nex<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> k <span class="token operator">=</span> nex<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x7528;&amp;#x4E8E;&amp;#x52A0;&amp;#x5FEB;&amp;#x5339;&amp;#x914D;&amp;#x901F;&amp;#x5EA6;&amp;#x7684;&amp;#x8FDB;&amp;#x5316;&amp;#x7248;getnext</span>
<span class="token keyword">void</span> <span class="token function">_getnext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    nex<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>j<span class="token operator">&lt;</span>tlen<span class="token number">-1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> t<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token operator">++</span>j<span class="token punctuation">,</span> <span class="token operator">++</span>k<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> nex<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> nex<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> nex<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> k <span class="token operator">=</span> nex<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    slen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> tlen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">getnext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>slen<span class="token operator">&amp;&amp;</span>j<span class="token operator">&lt;</span>tlen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">==</span> tlen <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>i<span class="token operator">-</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j <span class="token operator">=</span> nex<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token operator">++</span>i<span class="token punctuation">,</span> <span class="token operator">++</span>j<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> j <span class="token operator">=</span> nex<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>k<span class="token operator">&lt;=</span>tlen<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d"</span><span class="token punctuation">,</span>nex<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    enl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s%s"</span><span class="token punctuation">,</span>s<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="ac&#x81EA;&#x52A8;&#x673A;"><a href="#ac&#x81EA;&#x52A8;&#x673A;" class="headerlink" title="ac&#x81EA;&#x52A8;&#x673A;"></a>ac&#x81EA;&#x52A8;&#x673A;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//&amp;#x6D1B;&amp;#x8C37;&amp;#x6A21;&amp;#x677F;AC&amp;#x81EA;&amp;#x52A8;&amp;#x673A;&amp;#xFF08;&amp;#x7B80;&amp;#x5355;&amp;#x7248;P3808&amp;#xFF0C;&amp;#x52A0;&amp;#x5F3A;&amp;#x7248;P3796&amp;#xFF0C;&amp;#x4E8C;&amp;#x6B21;&amp;#x52A0;&amp;#x5F3A;P5357)</span>
<span class="token comment" spellcheck="true">//&amp;#x4E0B;&amp;#x9762;&amp;#x6CE8;&amp;#x91CA;&amp;#x9644;&amp;#x6709;&amp;#x52A0;&amp;#x5F3A;&amp;#x7248;&amp;#x53CA;&amp;#x4E8C;&amp;#x6B21;&amp;#x52A0;&amp;#x5F3A;&amp;#x7248;</span>
<span class="token comment" spellcheck="true">//&amp;#x7B80;&amp;#x5355;&amp;#x7248;&amp;#xFF1A;&amp;#x7ED9;&amp;#x5B9A;n&amp;#x4E2A;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E32;t&amp;#x548C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x672C;&amp;#x4E32;s&amp;#xFF0C;&amp;#x6C42;&amp;#x6709;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E32;&amp;#x5728;&amp;#x6587;&amp;#x672C;&amp;#x4E32;&amp;#x91CC;&amp;#x51FA;&amp;#x73B0;&amp;#x8FC7;&amp;#x3002;&amp;#x4E24;&amp;#x4E2A;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E32;&amp;#x4E0D;&amp;#x540C;&amp;#x5F53;&amp;#x4E14;&amp;#x4EC5;&amp;#x5F53;&amp;#x4ED6;&amp;#x4EEC;&amp;#x7F16;&amp;#x53F7;&amp;#x4E0D;&amp;#x540C;&amp;#x3002;</span>
<span class="token comment" spellcheck="true">//&amp;#x52A0;&amp;#x5F3A;&amp;#x7248;&amp;#xFF1A;&amp;#x6709;n&amp;#x4E2A;&amp;#x7531;&amp;#x5C0F;&amp;#x5199;&amp;#x5B57;&amp;#x6BCD;&amp;#x7EC4;&amp;#x6210;&amp;#x7684;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E32;&amp;#x4EE5;&amp;#x53CA;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x672C;&amp;#x4E32;s&amp;#x3002;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E32;&amp;#x53EF;&amp;#x80FD;&amp;#x4F1A;&amp;#x5728;&amp;#x6587;&amp;#x672C;&amp;#x4E32;&amp;#x4E2D;&amp;#x51FA;&amp;#x73B0;&amp;#x591A;&amp;#x6B21;&amp;#x3002;&amp;#x627E;&amp;#x51FA;&amp;#x54EA;&amp;#x4E9B;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E32;&amp;#x5728;&amp;#x6587;&amp;#x672C;&amp;#x4E32;s&amp;#x4E2D;&amp;#x51FA;&amp;#x73B0;&amp;#x7684;&amp;#x6B21;&amp;#x6570;&amp;#x6700;&amp;#x591A;&amp;#x3002;&amp;#x3001;</span>
<span class="token comment" spellcheck="true">//&amp;#x4E8C;&amp;#x6B21;&amp;#x52A0;&amp;#x5F3A;&amp;#xFF1A;&amp;#x7ED9;&amp;#x4F60;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x672C;&amp;#x4E32;s&amp;#x548C;n&amp;#x4E2A;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E32;t1...tn&amp;#x5206;&amp;#x522B;&amp;#x6C42;&amp;#x51FA;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6A21;&amp;#x5F0F;&amp;#x4E32;ti&amp;#x5728;s&amp;#x4E2D;&amp;#x51FA;&amp;#x73B0;&amp;#x7684;&amp;#x6B21;&amp;#x6570;&amp;#x3002;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl puts("")</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e6</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> Node<span class="token punctuation">{</span>
    <span class="token keyword">int</span> son<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span>fail<span class="token punctuation">,</span>count<span class="token punctuation">;</span>
<span class="token punctuation">}</span>tr<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> s<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>_rot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
queue<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> q<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&amp;#x63D2;&amp;#x5165;&amp;#x51FD;&amp;#x6570;&amp;#xFF0C;&amp;#x6784;&amp;#x5EFA;trie&amp;#x6811;</span>
<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>string str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> now <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> lotod <span class="token operator">=</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token operator">&amp;</span>apos<span class="token punctuation">;</span>a<span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>lotod<span class="token punctuation">]</span><span class="token punctuation">)</span> 
            tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>lotod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span>cnt<span class="token punctuation">;</span>
        now <span class="token operator">=</span> tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>lotod<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">++</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x6C42;&amp;#x8282;&amp;#x70B9;&amp;#x7684;fail&amp;#x6307;&amp;#x9488;</span>
<span class="token comment" spellcheck="true">//&amp;#x753B;&amp;#x56FE;&amp;#x66F4;&amp;#x4E3A;&amp;#x597D;&amp;#x7406;&amp;#x89E3;</span>
<span class="token keyword">void</span> <span class="token function">getfail</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fail <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> now <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">//&amp;#x82E5;&amp;#x7B2C;i&amp;#x4E2A;&amp;#x5B57;&amp;#x6BCD;&amp;#x5B58;&amp;#x5728;&amp;#xFF0C;&amp;#x5219;&amp;#x7B2C;i&amp;#x4E2A;&amp;#x5B57;&amp;#x6BCD;fail&amp;#x6307;&amp;#x5411;{&amp;#x7236;&amp;#x4EB2;&amp;#x8282;&amp;#x70B9;fail&amp;#x6307;&amp;#x9488;&amp;#x6307;&amp;#x5411;&amp;#x7684;&amp;#x8282;&amp;#x70B9;}&amp;#x7684;&amp;#x7B2C;i&amp;#x4E2A;&amp;#x5B57;&amp;#x6BCD;</span>
                <span class="token comment" spellcheck="true">//&amp;#x82E5;&amp;#x8BE5;&amp;#x5B57;&amp;#x6BCD;&amp;#x6CA1;&amp;#x6709;&amp;#xFF0C;&amp;#x5219;&amp;#x6307;&amp;#x5411;&amp;#x7684;&amp;#x662F;root</span>
                tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fail <span class="token operator">=</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>fail<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token comment" spellcheck="true">//&amp;#x7B2C;i&amp;#x5B57;&amp;#x6BCD;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#xFF0C;&amp;#x5219;now&amp;#x7684;&amp;#x7B2C;i&amp;#x4E2A;&amp;#x513F;&amp;#x5B50;&amp;#xFF08;&amp;#x5B57;&amp;#x6BCD;&amp;#xFF09;&amp;#x6307;&amp;#x5411;{&amp;#x7236;&amp;#x4EB2;&amp;#x8282;&amp;#x70B9;fail&amp;#x6307;&amp;#x9488;&amp;#x6307;&amp;#x5411;&amp;#x7684;&amp;#x8282;&amp;#x70B9;}&amp;#x7684;&amp;#x7B2C;i&amp;#x4E2A;&amp;#x5B57;&amp;#x6BCD;</span>
                tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>fail<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x67E5;&amp;#x8BE2;&amp;#x5339;&amp;#x914D;&amp;#x51FD;&amp;#x6570;</span>
<span class="token keyword">int</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> now <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        now <span class="token operator">=</span> tr<span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">.</span>son<span class="token punctuation">[</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token operator">&amp;</span>apos<span class="token punctuation">;</span>a<span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span>now<span class="token punctuation">;</span>j <span class="token operator">&amp;&amp;</span> tr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">=</span>tr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>fail<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//&amp;#x4E00;&amp;#x76F4;&amp;#x627E;&amp;#x5BFB;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x7684;fail&amp;#xFF0C;&amp;#x76F4;&amp;#x5230;&amp;#x56DE;&amp;#x5230;root&amp;#x6216;&amp;#x8005;&amp;#x5DF2;&amp;#x7ECF;&amp;#x88AB;&amp;#x8BBF;&amp;#x95EE;&amp;#x8FC7;&amp;#x4E86;</span>
            <span class="token comment" spellcheck="true">//&amp;#x8FD9;&amp;#x822C;&amp;#x64CD;&amp;#x4F5C;&amp;#x7684;&amp;#x6700;&amp;#x7EC8;&amp;#x7ED3;&amp;#x679C;&amp;#x4F1A;&amp;#x4F7F;trie&amp;#x6BCF;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x6B63;&amp;#x597D;&amp;#x8BBF;&amp;#x95EE;&amp;#x4E00;&amp;#x6B21;</span>
            ans <span class="token operator">+</span><span class="token operator">=</span> tr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">;</span>
            tr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        string str<span class="token punctuation">;</span>
        cin <span class="token operator">>></span> str<span class="token punctuation">;</span>
        <span class="token function">insert</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cin <span class="token operator">>></span> s<span class="token punctuation">;</span>
    <span class="token function">getfail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token function">query</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token operator">*</span>enl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">/*

*/</span>
</code></pre>
<h2 id="&#x9AD8;&#x7EA7;&#x6570;&#x636E;&#x7ED3;&#x6784;"><a href="#&#x9AD8;&#x7EA7;&#x6570;&#x636E;&#x7ED3;&#x6784;" class="headerlink" title="&#x9AD8;&#x7EA7;&#x6570;&#x636E;&#x7ED3;&#x6784;"></a>&#x9AD8;&#x7EA7;&#x6570;&#x636E;&#x7ED3;&#x6784;</h2><h3 id="&#x5E73;&#x8861;&#x6811;"><a href="#&#x5E73;&#x8861;&#x6811;" class="headerlink" title="&#x5E73;&#x8861;&#x6811;"></a>&#x5E73;&#x8861;&#x6811;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">,</span> inf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> Node <span class="token punctuation">{</span>
    <span class="token keyword">int</span> ls<span class="token punctuation">,</span> rs<span class="token punctuation">;</span>
    <span class="token keyword">int</span> key<span class="token punctuation">,</span> val<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//key: &amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#xFF08;&amp;#x6570;&amp;#x636E;&amp;#xFF09;  val: &amp;#x968F;&amp;#x673A;&amp;#x6570;&amp;#xFF08;&amp;#x5806;&amp;#x7ED3;&amp;#x6784;&amp;#xFF09;</span>
    <span class="token keyword">int</span> cnt<span class="token punctuation">,</span> siz<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//cnt: &amp;#x5F53;&amp;#x524D;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x4E2A;&amp;#x6570;  siz: &amp;#x5F53;&amp;#x524D;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x4E2A;&amp;#x6570;</span>
<span class="token punctuation">}</span>tr<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> root<span class="token punctuation">,</span> idx<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&amp;#x65B0;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;</span>
<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">get_node</span><span class="token punctuation">(</span><span class="token keyword">int</span> key<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    tr<span class="token punctuation">[</span><span class="token operator">++</span> idx<span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>val <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>cnt <span class="token operator">=</span> tr<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>siz <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> idx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x7528;&amp;#x513F;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x66F4;&amp;#x65B0;&amp;#x7236;&amp;#x8282;&amp;#x70B9;&amp;#x7684;siz&amp;#x4FE1;&amp;#x606F;</span>
<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">pushup</span><span class="token punctuation">(</span><span class="token keyword">int</span> nod<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>siz <span class="token operator">=</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">]</span><span class="token punctuation">.</span>siz <span class="token operator">+</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">]</span><span class="token punctuation">.</span>siz <span class="token operator">+</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>cnt<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x53F3;&amp;#x65CB;</span>
<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">right_rotate</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>nod<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp <span class="token operator">=</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls <span class="token operator">=</span> tr<span class="token punctuation">[</span>temp<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">,</span> tr<span class="token punctuation">[</span>temp<span class="token punctuation">]</span><span class="token punctuation">.</span>rs <span class="token operator">=</span> nod<span class="token punctuation">,</span> nod <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">pushup</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&amp;#x65CB;&amp;#x8F6C;&amp;#x53EA;&amp;#x5F71;&amp;#x54CD;&amp;#x4E24;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x503C;&amp;#xFF0C;&amp;#x7528;&amp;#x513F;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x66F4;&amp;#x65B0;&amp;#x4E00;&amp;#x4E0B;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x5DE6;&amp;#x65CB;</span>
<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">left_rotate</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>nod<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp <span class="token operator">=</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">;</span>
    tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs <span class="token operator">=</span> tr<span class="token punctuation">[</span>temp<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">,</span> tr<span class="token punctuation">[</span>temp<span class="token punctuation">]</span><span class="token punctuation">.</span>ls <span class="token operator">=</span> nod<span class="token punctuation">,</span> nod <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">pushup</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&amp;#x65CB;&amp;#x8F6C;&amp;#x53EA;&amp;#x5F71;&amp;#x54CD;&amp;#x4E24;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x503C;&amp;#xFF0C;&amp;#x7528;&amp;#x513F;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x66F4;&amp;#x65B0;&amp;#x4E00;&amp;#x4E0B;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x5EFA;&amp;#x7ACB;&amp;#x5E73;&amp;#x8861;&amp;#x6811;</span>
<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//&amp;#x521B;&amp;#x5EFA;-inf&amp;#xFF0C;inf&amp;#x4E24;&amp;#x4E2A;&amp;#x503C;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x4F5C;&amp;#x4E3A;&amp;#x521D;&amp;#x59CB;&amp;#x7684;&amp;#x5E73;&amp;#x8861;&amp;#x6811;</span>
    <span class="token keyword">int</span> lnod <span class="token operator">=</span> <span class="token function">get_node</span><span class="token punctuation">(</span><span class="token operator">-</span>inf<span class="token punctuation">)</span><span class="token punctuation">,</span> rnod <span class="token operator">=</span> <span class="token function">get_node</span><span class="token punctuation">(</span>inf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    root <span class="token operator">=</span> lnod<span class="token punctuation">;</span> tr<span class="token punctuation">[</span>lnod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs <span class="token operator">=</span> rnod<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&amp;#x8BA9;-inf&amp;#x4F5C;&amp;#x4E3A;&amp;#x6839;&amp;#x8282;&amp;#x70B9;</span>
    <span class="token function">pushup</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment" spellcheck="true">//&amp;#x8BB0;&amp;#x5F97;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x5E73;&amp;#x8861;&amp;#x6811;&amp;#x7684;&amp;#x8FC7;&amp;#x7A0B;&amp;#x4E2D;&amp;#x4E5F;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x51FA;&amp;#x73B0;&amp;#x65CB;&amp;#x8F6C;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF08;val&amp;#x968F;&amp;#x673A;&amp;#xFF09;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>rnod<span class="token punctuation">]</span><span class="token punctuation">.</span>val <span class="token operator">></span> tr<span class="token punctuation">[</span>lnod<span class="token punctuation">]</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token function">left_rotate</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x63D2;&amp;#x5165;&amp;#x64CD;&amp;#x4F5C;</span>
<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>nod<span class="token punctuation">,</span> <span class="token keyword">int</span> key<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x4E3A;key&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x5C31;&amp;#x65B0;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>nod<span class="token punctuation">)</span> nod <span class="token operator">=</span> <span class="token function">get_node</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x5DF2;&amp;#x7ECF;&amp;#x5B58;&amp;#x5728;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x4E3A;key&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x5C31;&amp;#x5F53;&amp;#x524D;cnt++</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">==</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">++</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>cnt<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;key&amp;#x5C0F;&amp;#x4E8E;&amp;#x5F53;&amp;#x524D;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;key&amp;#x5C31;&amp;#x4F1A;&amp;#x63D2;&amp;#x5165;&amp;#x5728;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">&lt;</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">insert</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//&amp;#x6839;&amp;#x636E;&amp;#x65B0;&amp;#x521B;&amp;#x5EFA;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x7684;val&amp;#x503C;&amp;#xFF0C;&amp;#x770B;&amp;#x60C5;&amp;#x51B5;&amp;#x4F9D;&amp;#x6B21;&amp;#x65CB;&amp;#x8F6C;&amp;#x4E0A;&amp;#x6765;&amp;#xFF0C;&amp;#x4FDD;&amp;#x6301;&amp;#x5E73;&amp;#x8861;&amp;#x6811;&amp;#x7684;&amp;#x6027;&amp;#x8D28;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">]</span><span class="token punctuation">.</span>val <span class="token operator">></span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token function">right_rotate</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;key&amp;#x5927;&amp;#x4E8E;&amp;#x5F53;&amp;#x524D;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;key&amp;#x5C31;&amp;#x4F1A;&amp;#x63D2;&amp;#x5165;&amp;#x5728;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        <span class="token function">insert</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//&amp;#x6839;&amp;#x636E;&amp;#x65B0;&amp;#x521B;&amp;#x5EFA;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x7684;val&amp;#x503C;&amp;#xFF0C;&amp;#x770B;&amp;#x60C5;&amp;#x51B5;&amp;#x4F9D;&amp;#x6B21;&amp;#x65CB;&amp;#x8F6C;&amp;#x4E0A;&amp;#x6765;&amp;#xFF0C;&amp;#x4FDD;&amp;#x6301;&amp;#x5E73;&amp;#x8861;&amp;#x6811;&amp;#x7684;&amp;#x6027;&amp;#x8D28;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">]</span><span class="token punctuation">.</span>val <span class="token operator">></span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token function">left_rotate</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">//&amp;#x65E0;&amp;#x8BBA;&amp;#x6709;&amp;#x6CA1;&amp;#x6709;&amp;#x65CB;&amp;#x8F6C;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x5F97;&amp;#x8981;&amp;#x66F4;&amp;#x65B0;&amp;#x4E00;&amp;#x4E0B;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x7684;siz&amp;#x4FE1;&amp;#x606F;</span>
    <span class="token function">pushup</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x5220;&amp;#x9664;&amp;#x64CD;&amp;#x4F5C;</span>
<span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>nod<span class="token punctuation">,</span> <span class="token keyword">int</span> key<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;key&amp;#xFF0C;&amp;#x76F4;&amp;#x63A5;&amp;#x8FD4;&amp;#x56DE;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>nod<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x5F53;&amp;#x524D;key&amp;#x4E0E;&amp;#x5220;&amp;#x9664;&amp;#x7684;key&amp;#x76F8;&amp;#x7B49;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x8981;&amp;#x5220;&amp;#x9664;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x5C31;&amp;#x662F;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>key <span class="token operator">==</span> key<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;cnt>1&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x76F4;&amp;#x63A5;cnt--</span>
        <span class="token comment" spellcheck="true">//&amp;#x5426;&amp;#x5219;&amp;#xFF0C;&amp;#x82E5;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x4E0D;&amp;#x662F;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x5C31;&amp;#x8981;&amp;#x628A;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x65CB;&amp;#x8F6C;&amp;#x5230;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;</span>
        <span class="token comment" spellcheck="true">//&amp;#x82E5;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x5B58;&amp;#x5728;&amp;#x4E14;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;val&amp;#x5927;&amp;#x4E8E;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;val&amp;#x90A3;&amp;#x4E48;&amp;#x53F3;&amp;#x65CB;&amp;#xFF08;&amp;#x628A;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x5F80;&amp;#x4E0A;&amp;#x65CB;&amp;#xFF09;</span>
        <span class="token comment" spellcheck="true">//&amp;#x82E5;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#x5B58;&amp;#x5728;&amp;#x4E14;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;val&amp;#x5927;&amp;#x4E8E;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;val&amp;#x90A3;&amp;#x4E48;&amp;#x5DE6;&amp;#x65CB;&amp;#xFF08;&amp;#x628A;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#x5F80;&amp;#x4E0A;&amp;#x65CB;&amp;#xFF09;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>cnt <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">--</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>cnt<span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls <span class="token operator">||</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs <span class="token operator">||</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">]</span><span class="token punctuation">.</span>val <span class="token operator">></span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">]</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">right_rotate</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">remove</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{</span>
                <span class="token function">left_rotate</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">remove</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> nod <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">&lt;</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token function">remove</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token function">remove</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment" spellcheck="true">//&amp;#x5220;&amp;#x9664;&amp;#x5F71;&amp;#x54CD;&amp;#x4E86;&amp;#x8282;&amp;#x70B9;&amp;#x4FE1;&amp;#x606F;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x66F4;&amp;#x65B0;</span>
    <span class="token function">pushup</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x6839;&amp;#x636E;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x83B7;&amp;#x5F97;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x7684;&amp;#x6392;&amp;#x540D;</span>
<span class="token keyword">int</span> <span class="token function">get_rank</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>nod<span class="token punctuation">,</span> <span class="token keyword">int</span> key<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#xFF0C;&amp;#x8FD4;&amp;#x56DE;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#x7684;&amp;#x503C;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>nod<span class="token punctuation">)</span> <span class="token keyword">return</span> inf<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x4E0E;&amp;#x8981;&amp;#x627E;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x76F8;&amp;#x540C;&amp;#xFF0C;&amp;#x8FD4;&amp;#x56DE;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x7684;siz&amp;#x503C;&amp;#x52A0;1&amp;#xFF0C;&amp;#x5373;&amp;#x6392;&amp;#x540D;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">==</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token keyword">return</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">]</span><span class="token punctuation">.</span>siz <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x5927;&amp;#x4E8E;&amp;#x8981;&amp;#x627E;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x6392;&amp;#x540D;&amp;#x5728;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">&lt;</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">get_rank</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x5C0F;&amp;#x4E8E;&amp;#x8981;&amp;#x627E;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x6392;&amp;#x540D;&amp;#x5728;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;</span>
    <span class="token comment" spellcheck="true">//&amp;#x540C;&amp;#x65F6;&amp;#x5728;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x6392;&amp;#x540D;&amp;#x8981;&amp;#x52A0;&amp;#x4E0A;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x7684;cnt&amp;#x548C;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x7684;siz&amp;#x624D;&amp;#x662F;&amp;#x771F;&amp;#x6B63;&amp;#x7684;&amp;#x6392;&amp;#x540D;</span>
    <span class="token keyword">return</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">]</span><span class="token punctuation">.</span>siz <span class="token operator">+</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>cnt <span class="token operator">+</span> <span class="token function">get_rank</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">get_key</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>nod<span class="token punctuation">,</span> <span class="token keyword">int</span> rank<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x6392;&amp;#x540D;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#xFF0C;&amp;#x8FD4;&amp;#x56DE;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#x7684;&amp;#x503C;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>nod<span class="token punctuation">)</span> <span class="token keyword">return</span> inf<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x8981;&amp;#x627E;&amp;#x7684;&amp;#x6392;&amp;#x540D;&amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x4E2A;&amp;#x6570;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x5728;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>rank <span class="token operator">&lt;=</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">]</span><span class="token punctuation">.</span>siz<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">get_key</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">,</span> rank<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x8981;&amp;#x627E;&amp;#x7684;&amp;#x6392;&amp;#x540D;&amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#x52A0;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x5C31;&amp;#x5728;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>rank <span class="token operator">&lt;=</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">]</span><span class="token punctuation">.</span>siz <span class="token operator">+</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>cnt<span class="token punctuation">)</span> <span class="token keyword">return</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x8981;&amp;#x627E;&amp;#x7684;&amp;#x6392;&amp;#x540D;&amp;#x5927;&amp;#x4E8E;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#x52A0;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;</span>
    <span class="token comment" spellcheck="true">//&amp;#x90A3;&amp;#x4E48;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x5728;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x5728;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x771F;&amp;#x5B9E;&amp;#x6392;&amp;#x540D;&amp;#x8981;&amp;#x51CF;&amp;#x53BB;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x548C;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x5B57;&amp;#x4E2A;&amp;#x6570;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token function">get_key</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">,</span> rank <span class="token operator">-</span> tr<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">]</span><span class="token punctuation">.</span>siz <span class="token operator">-</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>cnt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">get_prev</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>nod<span class="token punctuation">,</span> <span class="token keyword">int</span> key<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>nod<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span>inf<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;key&amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x7684;key&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x524D;&amp;#x9A71;&amp;#x5728;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">&lt;=</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">get_prev</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;key&amp;#x5927;&amp;#x4E8E;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x7684;key</span>
    <span class="token comment" spellcheck="true">//&amp;#x90A3;&amp;#x4E48;&amp;#x524D;&amp;#x9A71;&amp;#x5728;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x6216;&amp;#x8005;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token function">max</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">,</span> <span class="token function">get_prev</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">get_next</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>nod<span class="token punctuation">,</span> <span class="token keyword">int</span> key<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>nod<span class="token punctuation">)</span> <span class="token keyword">return</span> inf<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;key&amp;#x5927;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x7684;key&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x540E;&amp;#x7EE7;&amp;#x5728;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">>=</span> tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">get_next</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>rs<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;key&amp;#x5C0F;&amp;#x4E8E;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x7684;key</span>
    <span class="token comment" spellcheck="true">//&amp;#x90A3;&amp;#x4E48;&amp;#x540E;&amp;#x7EE7;&amp;#x5728;&amp;#x5F53;&amp;#x524D;&amp;#x8282;&amp;#x70B9;&amp;#x6216;&amp;#x8005;&amp;#x5DE6;&amp;#x5B50;&amp;#x6811;&amp;#x7684;&amp;#x53F3;&amp;#x5B50;&amp;#x6811;&amp;#x4E2D;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token function">min</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">,</span> <span class="token function">get_next</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">.</span>ls<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>n <span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> op<span class="token punctuation">,</span> x<span class="token punctuation">;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>op<span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">insert</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token function">remove</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">get_rank</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">get_key</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">get_prev</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">get_next</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="&#x56FE;&#x8BBA;"><a href="#&#x56FE;&#x8BBA;" class="headerlink" title="&#x56FE;&#x8BBA;"></a>&#x56FE;&#x8BBA;</h1><h2 id="&#x62D3;&#x6251;&#x6392;&#x5E8F;"><a href="#&#x62D3;&#x6251;&#x6392;&#x5E8F;" class="headerlink" title="&#x62D3;&#x6251;&#x6392;&#x5E8F;"></a>&#x62D3;&#x6251;&#x6392;&#x5E8F;</h2><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> g<span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ind<span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
queue<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> q<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> u <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> u <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> u <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> v<span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span> g<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">++</span> ind<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ind<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">while</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> u <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> v <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> v <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> v <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token operator">--</span> ind<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ind<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#x4E0E;&#x6B27;&#x62C9;&#x8DEF;&#x5F84;"><a href="#&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#x4E0E;&#x6B27;&#x62C9;&#x8DEF;&#x5F84;" class="headerlink" title="&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#x4E0E;&#x6B27;&#x62C9;&#x8DEF;&#x5F84;"></a>&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#x4E0E;&#x6B27;&#x62C9;&#x8DEF;&#x5F84;</h2><h3 id="&#x6C42;&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#x5E76;&#x8F93;&#x51FA;&#x8DEF;&#x5F84;"><a href="#&#x6C42;&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#x5E76;&#x8F93;&#x51FA;&#x8DEF;&#x5F84;" class="headerlink" title="&#x6C42;&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#x5E76;&#x8F93;&#x51FA;&#x8DEF;&#x5F84;"></a>&#x6C42;&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#x5E76;&#x8F93;&#x51FA;&#x8DEF;&#x5F84;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> t<span class="token punctuation">,</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> ind<span class="token punctuation">[</span><span class="token number">100010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> outd<span class="token punctuation">[</span><span class="token number">100010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> book<span class="token punctuation">[</span><span class="token number">400010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> fir<span class="token punctuation">[</span><span class="token number">100010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> to<span class="token punctuation">[</span><span class="token number">400010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ne<span class="token punctuation">[</span><span class="token number">400010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> road<span class="token punctuation">[</span><span class="token number">400010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cnt<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    to<span class="token punctuation">[</span><span class="token operator">++</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">;</span>
    ne<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
    fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> idx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>i <span class="token operator">=</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">~</span>i<span class="token punctuation">;</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>book<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            i <span class="token operator">=</span> ne<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span> <span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        book<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> book<span class="token punctuation">[</span>i <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        
        <span class="token keyword">int</span> e<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e <span class="token operator">=</span> i <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> e <span class="token operator">=</span> <span class="token operator">-</span>e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> e <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        
        <span class="token keyword">int</span> v <span class="token operator">=</span> to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        i <span class="token operator">=</span> ne<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">dfs</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        road<span class="token punctuation">[</span><span class="token operator">++</span> cnt<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>fir<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> fir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>t<span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">add</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">++</span> ind<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">++</span> outd<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">int</span> ok <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>t <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ind<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> outd<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> ok <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>t <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ind<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> outd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> ok <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"NO"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">~</span>fir<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>cnt <span class="token operator">&lt;</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"NO"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"YES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> cnt<span class="token punctuation">;</span> i<span class="token punctuation">;</span> i <span class="token operator">--</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> road<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x6C42;&#x6B27;&#x62C9;&#x8DEF;&#x5F84;&#xFF08;&#x5355;&#x8BCD;&#x6E38;&#x620F;&#xFF0C;&#x5355;&#x8BCD;&#x9996;&#x5C3E;&#x76F8;&#x8FDE;&#xFF09;"><a href="#&#x6C42;&#x6B27;&#x62C9;&#x8DEF;&#x5F84;&#xFF08;&#x5355;&#x8BCD;&#x6E38;&#x620F;&#xFF0C;&#x5355;&#x8BCD;&#x9996;&#x5C3E;&#x76F8;&#x8FDE;&#xFF09;" class="headerlink" title="&#x6C42;&#x6B27;&#x62C9;&#x8DEF;&#x5F84;&#xFF08;&#x5355;&#x8BCD;&#x6E38;&#x620F;&#xFF0C;&#x5355;&#x8BCD;&#x9996;&#x5C3E;&#x76F8;&#x8FDE;&#xFF09;"></a>&#x6C42;&#x6B27;&#x62C9;&#x8DEF;&#x5F84;&#xFF08;&#x5355;&#x8BCD;&#x6E38;&#x620F;&#xFF0C;&#x5355;&#x8BCD;&#x9996;&#x5C3E;&#x76F8;&#x8FDE;&#xFF09;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> T<span class="token punctuation">,</span> n<span class="token punctuation">;</span>
<span class="token keyword">int</span> ind<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span> outd<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span> book<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> ins<span class="token punctuation">[</span><span class="token number">1020</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">getf</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> f<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">==</span> v <span class="token operator">?</span> v <span class="token operator">:</span> f<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getf</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>ind<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> ind<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>outd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> outd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> book<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">26</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
    
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> ins<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>ins<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> u <span class="token operator">=</span> ins<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token operator">&amp;</span>apos<span class="token punctuation">;</span>a<span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">,</span> v <span class="token operator">=</span> ins<span class="token punctuation">[</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token operator">&amp;</span>apos<span class="token punctuation">;</span>a<span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token operator">++</span> outd<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token operator">++</span> ind<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">;</span>
        book<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> book<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        u <span class="token operator">=</span> <span class="token function">getf</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> v <span class="token operator">=</span> <span class="token function">getf</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>u <span class="token operator">!=</span> v<span class="token punctuation">)</span> f<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">int</span> ok <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">26</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getf</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> fa <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">26</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>book<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>fa <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            fa <span class="token operator">=</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span> <span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> fa<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ok <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>ok <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"The door cannot be opened."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">int</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">26</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>outd<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> ind<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>outd<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> ind<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">++</span> s<span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ind<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> outd<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">++</span> t<span class="token punctuation">;</span>
            <span class="token keyword">else</span> s <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
            
            <span class="token keyword">if</span><span class="token punctuation">(</span>s <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">||</span> t <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>s <span class="token operator">==</span> t <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> s <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Ordering is possible."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"The door cannot be opened."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>T<span class="token operator">--</span><span class="token punctuation">)</span>
        <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x6700;&#x77ED;&#x8DEF;"><a href="#&#x6700;&#x77ED;&#x8DEF;" class="headerlink" title="&#x6700;&#x77ED;&#x8DEF;"></a>&#x6700;&#x77ED;&#x8DEF;</h2><h3 id="&#x4F18;&#x5148;&#x961F;&#x5217;&#x4F18;&#x5316;dijkstra"><a href="#&#x4F18;&#x5148;&#x961F;&#x5217;&#x4F18;&#x5316;dijkstra" class="headerlink" title="&#x4F18;&#x5148;&#x961F;&#x5217;&#x4F18;&#x5316;dijkstra"></a>&#x4F18;&#x5148;&#x961F;&#x5217;&#x4F18;&#x5316;dijkstra</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//luoguP4779&amp;#x5355;&amp;#x6E90;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x6A21;&amp;#x677F;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> rep0(i,n) for(int i=0;i&lt;n;++i)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> rep1(i,n) for(int i=1;i&lt;=n;++i)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int ,int ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> Edge<span class="token punctuation">{</span>
    <span class="token keyword">int</span> from<span class="token punctuation">,</span>to<span class="token punctuation">,</span>wei<span class="token punctuation">;</span>
    <span class="token function">Edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span><span class="token keyword">int</span> to<span class="token punctuation">,</span><span class="token keyword">int</span> wei<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">from</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">to</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">wei</span><span class="token punctuation">(</span>wei<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> Dijkstra
<span class="token punctuation">{</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> G<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span>Edge <span class="token operator">></span> edges<span class="token punctuation">;</span>
    <span class="token keyword">int</span> dis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//p&amp;#x6570;&amp;#x7EC4;&amp;#x6765;&amp;#x5B58;&amp;#x50A8;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;s&amp;#x662F;&amp;#x8D77;&amp;#x70B9;&amp;#xFF0C;p[i]&amp;#x8868;&amp;#x793A;i&amp;#x7ED3;&amp;#x70B9;&amp;#x7684;&amp;#x4E0A;&amp;#x4E00;&amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x6240;&amp;#x8FDE;&amp;#x7684;&amp;#x8FB9;&amp;#xFF08;&amp;#x6CE8;&amp;#x610F;&amp;#xFF0C;p&amp;#x4E2D;&amp;#x5B58;&amp;#x7684;&amp;#x662F;&amp;#x8FB9;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#xFF01;&amp;#xFF09;</span>
    <span class="token keyword">int</span> p<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">;</span>

    <span class="token function">Dijkstra</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token punctuation">,</span><span class="token keyword">int</span> s<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">s</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            edges<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token function">Edge</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            G<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span>edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//&amp;#x5806;&amp;#x4F18;&amp;#x5316;&amp;#x7528;&amp;#x4F18;&amp;#x5148;&amp;#x961F;&amp;#x5217;&amp;#xFF0C;pii.first&amp;#x5B58;&amp;#x50A8;d&amp;#x503C;&amp;#xFF0C;pii.second&amp;#x5B58;&amp;#x50A8;&amp;#x7ED3;&amp;#x70B9;&amp;#x7F16;&amp;#x53F7;</span>
        priority_queue<span class="token operator">&lt;</span>pii <span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>pii <span class="token operator">></span> <span class="token punctuation">,</span>greater<span class="token operator">&lt;</span>pii <span class="token operator">></span> <span class="token operator">></span> q<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//&amp;#x521D;&amp;#x59CB;&amp;#x5316;d&amp;#x503C;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">==</span>s<span class="token operator">?</span><span class="token number">0</span><span class="token operator">:</span>inf<span class="token punctuation">;</span>
        q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">pii</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            pii d <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> u <span class="token operator">=</span> d<span class="token punctuation">.</span>second<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x51FA;&amp;#x6765;&amp;#x7684;pii&amp;#xFF0C;d&amp;#x503C;&amp;#x4E0D;&amp;#x7B49;&amp;#x4E8E;dis&amp;#x6570;&amp;#x7EC4;&amp;#x91CC;&amp;#x7684;&amp;#x6570;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x8BF4;&amp;#x660E;&amp;#x5B83;&amp;#x88AB;&amp;#x677E;&amp;#x5F1B;&amp;#x4E86;&amp;#x4E24;&amp;#x6B21;&amp;#xFF0C;&amp;#x663E;&amp;#x7136;&amp;#x524D;&amp;#x9762;&amp;#x51FA;&amp;#x73B0;&amp;#x7684;&amp;#x90A3;&amp;#x4E2A;&amp;#x66F4;&amp;#x597D;&amp;#xFF0C;</span>
            <span class="token comment" spellcheck="true">//&amp;#x6240;&amp;#x4EE5;&amp;#x663E;&amp;#x7136;&amp;#x88AB;&amp;#x8BBF;&amp;#x95EE;&amp;#x8FC7;&amp;#x4E86;&amp;#xFF0C;&amp;#x7701;&amp;#x6389;&amp;#x4E86;vis&amp;#x8BBF;&amp;#x95EE;&amp;#x6807;&amp;#x8BB0;&amp;#x6570;&amp;#x7EC4;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>first <span class="token operator">!=</span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">const</span> Edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">></span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>wei<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>wei<span class="token punctuation">;</span>
                    p<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">pii</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span>to<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d%c"</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token operator">==</span>n<span class="token operator">?</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span>\n<span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token operator">:</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span> <span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Dijkstra <span class="token function">dj</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dj<span class="token punctuation">.</span><span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dj<span class="token punctuation">.</span><span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="spfa"><a href="#spfa" class="headerlink" title="spfa"></a>spfa</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//luoguP4779&amp;#x5355;&amp;#x6E90;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x6A21;&amp;#x677F;</span>
<span class="token comment" spellcheck="true">//SPFA</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> rep0(i,n) for(int i=0;i&lt;n;++i)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> rep1(i,n) for(int i=1;i&lt;=n;++i)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int ,int ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//const int maxn = 1e5+3;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e3</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> Edge<span class="token punctuation">{</span>
    <span class="token keyword">int</span> from<span class="token punctuation">,</span>to<span class="token punctuation">,</span>wei<span class="token punctuation">;</span>
    <span class="token function">Edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span><span class="token keyword">int</span> to<span class="token punctuation">,</span><span class="token keyword">int</span> wei<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">from</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">to</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">wei</span><span class="token punctuation">(</span>wei<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> SPFA
<span class="token punctuation">{</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> G<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span>Edge <span class="token operator">></span> edges<span class="token punctuation">;</span>
    <span class="token keyword">int</span> dis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//SPFA&amp;#x5224;&amp;#x65AD;&amp;#x8D1F;&amp;#x73AF;&amp;#x7684;&amp;#x6838;&amp;#x5FC3;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x4E00;&amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x5165;&amp;#x961F;&amp;#x6B21;&amp;#x6570;&amp;#x5927;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;n&amp;#xFF0C;&amp;#x5219;&amp;#x8868;&amp;#x660E;&amp;#x5B58;&amp;#x5728;&amp;#x8D1F;&amp;#x73AF;</span>
    <span class="token comment" spellcheck="true">//&amp;#x56E0;&amp;#x4E3A;&amp;#x5728;Bellman-ford&amp;#x4E2D;&amp;#x6574;&amp;#x4E2A;&amp;#x56FE;&amp;#x53EA;&amp;#x9700;&amp;#x8981;&amp;#x677E;&amp;#x5F1B;n-1&amp;#x6B21;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x627E;&amp;#x5230;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x4E86;</span>
    <span class="token keyword">int</span> cnt<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//p&amp;#x6570;&amp;#x7EC4;&amp;#x6765;&amp;#x5B58;&amp;#x50A8;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;s&amp;#x662F;&amp;#x8D77;&amp;#x70B9;&amp;#xFF0C;p[i]&amp;#x8868;&amp;#x793A;i&amp;#x7ED3;&amp;#x70B9;&amp;#x7684;&amp;#x4E0A;&amp;#x4E00;&amp;#x4E2A;&amp;#x7ED3;&amp;#x70B9;&amp;#x6240;&amp;#x8FDE;&amp;#x7684;&amp;#x8FB9;&amp;#xFF08;&amp;#x6CE8;&amp;#x610F;&amp;#xFF0C;p&amp;#x4E2D;&amp;#x5B58;&amp;#x7684;&amp;#x662F;&amp;#x8FB9;&amp;#x7684;&amp;#x7F16;&amp;#x53F7;&amp;#xFF01;&amp;#xFF09;</span>
    <span class="token keyword">int</span> p<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5224;&amp;#x65AD;&amp;#x7ED3;&amp;#x70B9;&amp;#x662F;&amp;#x5426;&amp;#x5728;&amp;#x961F;&amp;#x5217;&amp;#x4E2D;</span>
    <span class="token keyword">bool</span> inq<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token function">SPFA</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token punctuation">,</span><span class="token keyword">int</span> s<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">s</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            edges<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token function">Edge</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            G<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span>edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">bool</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        queue<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> q<span class="token punctuation">;</span>
        <span class="token function">memset</span><span class="token punctuation">(</span>cnt<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">==</span>s<span class="token operator">?</span><span class="token number">0</span><span class="token operator">:</span>inf<span class="token punctuation">;</span>
        inq<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">int</span> u <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            inq<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> Edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">></span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>wei<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>wei<span class="token punctuation">;</span>
                    p<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>inq<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        inq<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                        q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>to<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">++</span>cnt<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">></span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ERROR!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d%c"</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token operator">==</span>n<span class="token operator">?</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span>\n<span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token operator">:</span><span class="token operator">&amp;</span>apos<span class="token punctuation">;</span> <span class="token operator">&amp;</span>apos<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    SPFA <span class="token function">sp</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sp<span class="token punctuation">.</span><span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="floyd"><a href="#floyd" class="headerlink" title="floyd"></a>floyd</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//luoguP4779&amp;#x5355;&amp;#x6E90;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x6A21;&amp;#x677F;</span>
<span class="token comment" spellcheck="true">//SPFA</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> rep0(i,n) for(int i=0;i&lt;n;++i)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> rep1(i,n) for(int i=1;i&lt;=n;++i)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int ,int ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//const int maxn = 1e3+3;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e2</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> Floyd
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//&amp;#x90BB;&amp;#x63A5;&amp;#x77E9;&amp;#x9635;&amp;#x5B58;&amp;#x8FB9;</span>
    <span class="token keyword">int</span> G<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">;</span>

    <span class="token function">Floyd</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span><span class="token keyword">int</span> m<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">n</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
                G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">==</span>j<span class="token operator">?</span><span class="token number">0</span><span class="token operator">:</span>inf<span class="token punctuation">;</span>

        <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            G<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>k<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">&lt;</span> inf <span class="token operator">&amp;&amp;</span> G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> inf<span class="token punctuation">)</span>
                        G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Floyd <span class="token function">fl</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fl<span class="token punctuation">.</span><span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="LCA"><a href="#LCA" class="headerlink" title="LCA"></a>LCA</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//P3379&amp;#x6700;&amp;#x8FD1;&amp;#x516C;&amp;#x5171;&amp;#x7956;&amp;#x5148;&amp;#xFF08;LCA&amp;#xFF09;</span>
<span class="token comment" spellcheck="true">//tarjan&amp;#x79BB;&amp;#x7EBF;&amp;#x7B97;&amp;#x6CD5;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl cout &lt;&lt; "\n"</span>
<span class="token macro property">#<span class="token directive keyword">define</span> judge cout &lt;&lt; "caonima" &lt;&lt; endl;</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;ll,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">5e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">,</span>f<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>vis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span>pii <span class="token operator">></span> qe<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//first&amp;#x4E3A;&amp;#x6743;&amp;#x503C;&amp;#xFF08;&amp;#x5373;&amp;#x7B54;&amp;#x6848;&amp;#xFF09;&amp;#xFF0C;second&amp;#x4E3A;&amp;#x8BE5;&amp;#x8FB9;&amp;#x7684;&amp;#x76EE;&amp;#x6807;&amp;#x70B9;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> quer<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>tr<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">getf</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">==</span>v<span class="token operator">?</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">:</span><span class="token function">getf</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">lca</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    vis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>tr<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">lca</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            f<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>quer<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> e <span class="token operator">=</span> quer<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>vis<span class="token punctuation">[</span>qe<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">)</span>
            qe<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">=</span> qe<span class="token punctuation">[</span>e<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token function">getf</span><span class="token punctuation">(</span>qe<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//e&amp;#x4E0E;e^1&amp;#x4E92;&amp;#x4E3A;&amp;#x53CD;&amp;#x5411;&amp;#x8FB9;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//freopen("data.in","r",stdin);</span>
    ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m <span class="token operator">>></span> s<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token number">-1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cin <span class="token operator">>></span> a <span class="token operator">>></span> b<span class="token punctuation">;</span>
        tr<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> tr<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cin <span class="token operator">>></span> a <span class="token operator">>></span> b<span class="token punctuation">;</span>
        qe<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token function">pii</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> qe<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token function">pii</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        quer<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span>qe<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        quer<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span>qe<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token function">lca</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        cout <span class="token operator">&lt;&lt;</span> qe<span class="token punctuation">[</span>i<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;"><a href="#&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;" class="headerlink" title="&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;"></a>&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//&amp;#x6D1B;&amp;#x8C37;P2002&amp;#x6D88;&amp;#x606F;&amp;#x6269;&amp;#x6563;</span>
<span class="token comment" spellcheck="true">//&amp;#x6709;n&amp;#x4E2A;&amp;#x57CE;&amp;#x5E02;&amp;#xFF0C;&amp;#x4E2D;&amp;#x95F4;&amp;#x6709;&amp;#x5355;&amp;#x5411;&amp;#x9053;&amp;#x8DEF;&amp;#x8FDE;&amp;#x63A5;&amp;#xFF0C;&amp;#x6D88;&amp;#x606F;&amp;#x4F1A;&amp;#x6CBF;&amp;#x7740;&amp;#x9053;&amp;#x8DEF;&amp;#x6269;&amp;#x6563;&amp;#xFF0C;&amp;#x73B0;&amp;#x5728;&amp;#x7ED9;&amp;#x51FA;n&amp;#x4E2A;&amp;#x57CE;&amp;#x5E02;&amp;#x53CA;&amp;#x5176;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x9053;&amp;#x8DEF;&amp;#xFF0C;</span>
<span class="token comment" spellcheck="true">//&amp;#x95EE;&amp;#x81F3;&amp;#x5C11;&amp;#x9700;&amp;#x8981;&amp;#x5728;&amp;#x51E0;&amp;#x4E2A;&amp;#x57CE;&amp;#x5E02;&amp;#x53D1;&amp;#x5E03;&amp;#x6D88;&amp;#x606F;&amp;#x624D;&amp;#x80FD;&amp;#x8BA9;&amp;#x8FD9;&amp;#x6240;&amp;#x6709;n&amp;#x4E2A;&amp;#x57CE;&amp;#x5E02;&amp;#x90FD;&amp;#x5F97;&amp;#x5230;&amp;#x6D88;&amp;#x606F;&amp;#x3002;</span>
<span class="token comment" spellcheck="true">//&amp;#x6C42;&amp;#x51FA;&amp;#x5F3A;&amp;#x8FDE;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x5E76;&amp;#x67D3;&amp;#x8272;&amp;#xFF0C;&amp;#x7F29;&amp;#x70B9;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x904D;&amp;#x5386;&amp;#x6240;&amp;#x6709;&amp;#x8FB9;&amp;#x6C42;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x5165;&amp;#x5EA6;&amp;#xFF0C;&amp;#x7B54;&amp;#x6848;&amp;#x4E3A;&amp;#x5165;&amp;#x5EA6;&amp;#x4E3A;0&amp;#x7684;&amp;#x70B9;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl puts("")</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxm <span class="token operator">=</span> <span class="token number">5e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&amp;#x90BB;&amp;#x63A5;&amp;#x8868;&amp;#x5B58;&amp;#x56FE;&amp;#xFF0C;&lt;dfn[i],low[i]>&amp;#xFF0C;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x5B9E;&amp;#x9645;&amp;#x8BBF;&amp;#x95EE;&amp;#x65F6;&amp;#x95F4;&amp;#x6233;&amp;#x548C;&amp;#x6700;&amp;#x65E9;&amp;#x80FD;&amp;#x56DE;&amp;#x6EAF;&amp;#x5230;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x6233;</span>
<span class="token comment" spellcheck="true">//color&amp;#x6570;&amp;#x7EC4;&amp;#x7ED9;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8FDE;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x67D3;&amp;#x8272;&amp;#xFF0C;ins&amp;#x6807;&amp;#x8BB0;&amp;#x6570;&amp;#x7EC4;&amp;#x6807;&amp;#x8BB0;&amp;#x662F;&amp;#x5426;&amp;#x5728;&amp;#x6808;&amp;#x4E2D;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>fir<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>from<span class="token punctuation">[</span>maxm<span class="token punctuation">]</span><span class="token punctuation">,</span>nex<span class="token punctuation">[</span>maxm<span class="token punctuation">]</span><span class="token punctuation">,</span>to<span class="token punctuation">[</span>maxm<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dfn<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>low<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>tim <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>color<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>colortot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>ins<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
stack<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> s<span class="token punctuation">;</span>
<span class="token keyword">int</span> indeg<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">intit</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>fir<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>fir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>
        cin <span class="token operator">>></span> a <span class="token operator">>></span> b<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">!=</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            to<span class="token punctuation">[</span><span class="token operator">++</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
            from<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">;</span>
            nex<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">;</span>
            fir<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> cnt<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> nod<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">;</span> ins<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    dfn<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span>tim<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&amp;#x66F4;&amp;#x65B0;&amp;#x8BE5;&amp;#x8282;&amp;#x70B9;&amp;#x65F6;&amp;#x95F4;&amp;#x6233;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>fir<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">=</span>nex<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//&amp;#x4E3E;&amp;#x4E00;&amp;#x4E2A;&amp;#x4F8B;&amp;#x5B50;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;1->2->3->1&amp;#x8FD9;&amp;#x4E2A;&amp;#x73AF;&amp;#x56FE;</span>
        <span class="token comment" spellcheck="true">//&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;if&amp;#x60C5;&amp;#x51B5;&amp;#x4E3A;&amp;#xFF0C;nod=1&amp;#xFF0C;to[i]=2</span>
        <span class="token comment" spellcheck="true">//&amp;#x7B2C;&amp;#x4E8C;&amp;#x4E2A;if&amp;#x60C5;&amp;#x51B5;&amp;#x4E3A;&amp;#xFF0C;nod=3&amp;#xFF0C;to[i]=1</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dfn<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x76EE;&amp;#x6807;&amp;#x8282;&amp;#x70B9;&amp;#x672A;&amp;#x88AB;&amp;#x8BBF;&amp;#x95EE;</span>
            <span class="token function">dfs</span><span class="token punctuation">(</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">,</span>low<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ins<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x76EE;&amp;#x6807;&amp;#x8282;&amp;#x70B9;&amp;#x8FD8;&amp;#x5728;&amp;#x6808;&amp;#x4E2D;</span>
            low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">,</span>low<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>dfn<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">==</span> low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">++</span>colortot<span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> temp <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> s<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ins<span class="token punctuation">[</span>temp<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            color<span class="token punctuation">[</span>temp<span class="token punctuation">]</span> <span class="token operator">=</span> colortot<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&amp;#x67D3;&amp;#x8272;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>temp <span class="token operator">==</span> nod<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dfn<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&amp;#x5BF9;&amp;#x6240;&amp;#x6709;&amp;#x8FB9;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x6C42;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5F3A;&amp;#x8FDE;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x7684;&amp;#x5165;&amp;#x5EA6;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>cnt<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>color<span class="token punctuation">[</span>from<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">!=</span> color<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token operator">++</span>indeg<span class="token punctuation">[</span>color<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>colortot<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>indeg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">++</span>res<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> res <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>
    <span class="token function">intit</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x56FE;&#x7684;&#x5272;&#x70B9;&#x4E0E;&#x6865;"><a href="#&#x56FE;&#x7684;&#x5272;&#x70B9;&#x4E0E;&#x6865;" class="headerlink" title="&#x56FE;&#x7684;&#x5272;&#x70B9;&#x4E0E;&#x6865;"></a>&#x56FE;&#x7684;&#x5272;&#x70B9;&#x4E0E;&#x6865;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//&amp;#x6D1B;&amp;#x8C37;P3388&amp;#x5272;&amp;#x70B9;&amp;#xFF08;&amp;#x5272;&amp;#x9876;&amp;#xFF09;&amp;#x6A21;&amp;#x677F;&amp;#xFF1A;n&amp;#x4E2A;&amp;#x70B9;m&amp;#x6761;&amp;#x8FB9;&amp;#x65E0;&amp;#x5411;&amp;#x56FE;&amp;#x7684;&amp;#x5272;&amp;#x70B9;</span>
<span class="token comment" spellcheck="true">//&amp;#x5BF9;&amp;#x4E8E;&amp;#x4E00;&amp;#x4E2A;dfs&amp;#x6811;&amp;#xFF1A;</span>
<span class="token comment" spellcheck="true">//x&amp;#x662F;&amp;#x5272;&amp;#x70B9;&amp;#xFF1A;1.x&amp;#x4E3A;&amp;#x975E;root&amp;#x70B9;&amp;&amp;&amp;#x6709;&amp;#x513F;&amp;#x5B50;&amp;&amp;low[x&amp;#x7684;&amp;#x513F;&amp;#x5B50;]>=dfn[x]   2.x&amp;#x4E3A;root&amp;#x70B9;&amp;&amp;&amp;#x81F3;&amp;#x5C11;&amp;#x6709;2&amp;#x4E2A;&amp;#x513F;&amp;#x5B50;</span>
<span class="token comment" spellcheck="true">//x->y&amp;#x662F;&amp;#x6865;&amp;#xFF1A;low[y]>dfn[x]</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl puts("")</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">2e4</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxm <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&amp;#x90BB;&amp;#x63A5;&amp;#x8868;&amp;#x5B58;&amp;#x56FE;&amp;#xFF0C;&lt;dfn[i],low[i]>&amp;#xFF0C;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x5B9E;&amp;#x9645;&amp;#x8BBF;&amp;#x95EE;&amp;#x65F6;&amp;#x95F4;&amp;#x6233;&amp;#x548C;&amp;#x6700;&amp;#x8FD1;&amp;#x80FD;&amp;#x56DE;&amp;#x6EAF;&amp;#x5230;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x6233;&amp;#xFF08;&amp;#x4E0E;&amp;#x5F3A;&amp;#x8FDE;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x201C;&amp;#x6700;&amp;#x65E9;&amp;#x201D;&amp;#x6709;&amp;#x533A;&amp;#x522B;&amp;#xFF09;</span>
<span class="token comment" spellcheck="true">//&amp;#x8FD9;&amp;#x91CC;&amp;#x7684;&amp;#x8FB9;&amp;#x4ECE;0&amp;#x5F00;&amp;#x59CB;&amp;#x5B58;&amp;#x50A8;&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x5F53;&amp;#x8FB9;&amp;#x4E3A;e&amp;#x65F6;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x53CD;&amp;#x5411;&amp;#x8FB9;&amp;#x4E3A;e^1</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>cnt <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>fir<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>from<span class="token punctuation">[</span>maxm<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nex<span class="token punctuation">[</span>maxm<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>to<span class="token punctuation">[</span>maxm<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dfn<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>low<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>tim <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>fa<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> incutver<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>incutedg<span class="token punctuation">[</span>maxm<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> cutver<span class="token punctuation">,</span>cutedg<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> nod<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    dfn<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span>tim<span class="token punctuation">;</span>
    <span class="token keyword">int</span> sontot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>fir<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">=</span>nex<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dfn<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            fa<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> nod<span class="token punctuation">;</span> <span class="token function">dfs</span><span class="token punctuation">(</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">++</span>sontot<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>fa<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>sontot<span class="token operator">>=</span><span class="token number">2</span> <span class="token operator">||</span> fa<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>sontot<span class="token operator">&amp;&amp;</span>low<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">>=</span>dfn<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>incutver<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    cutver<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>nod<span class="token punctuation">)</span><span class="token punctuation">,</span> incutver<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">></span>dfn<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>incutedg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> 
                cutedg<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> incutedg<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> incutedg<span class="token punctuation">[</span>i<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">,</span> low<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fa<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">!=</span> to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>nod<span class="token punctuation">]</span><span class="token punctuation">,</span> dfn<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&amp;#x8FD9;&amp;#x91CC;&amp;#x4E0E;&amp;#x5F3A;&amp;#x8FDE;&amp;#x901A;&amp;#x5206;&amp;#x91CF;&amp;#x4E0D;&amp;#x540C;&amp;#xFF0C;&amp;#x4E0D;&amp;#x80FD;&amp;#x56DE;&amp;#x6EAF;&amp;#x592A;&amp;#x8FDC;&amp;#xFF0C;&amp;#x5426;&amp;#x5219;&amp;#x5272;&amp;#x70B9;&amp;#x4F1A;&amp;#x5C11;</span>
        <span class="token comment" spellcheck="true">//&amp;#x53C2;&amp;#x8003;&amp;#x6837;&amp;#x4F8B;&amp;#xFF1A;5 6 1 2 2 3 3 4 4 5 1 3 3 5</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dfn<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">*</span><span class="token punctuation">(</span>fa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sort</span><span class="token punctuation">(</span>cutver<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cutver<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> cutver<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> u<span class="token operator">:</span> cutver<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> u <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
    enl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>fir<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>fir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
        cin <span class="token operator">>></span> x <span class="token operator">>></span> y<span class="token punctuation">;</span>
        nex<span class="token punctuation">[</span><span class="token operator">++</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span> fir<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> cnt<span class="token punctuation">;</span> to<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> y<span class="token punctuation">;</span>
        nex<span class="token punctuation">[</span><span class="token operator">++</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span> fir<span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> cnt<span class="token punctuation">;</span> to<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x4E8C;&#x5206;&#x56FE;"><a href="#&#x4E8C;&#x5206;&#x56FE;" class="headerlink" title="&#x4E8C;&#x5206;&#x56FE;"></a>&#x4E8C;&#x5206;&#x56FE;</h2><h3 id="&#x67D3;&#x8272;&#x6CD5;&#x5224;&#x65AD;&#x4E8C;&#x5206;&#x56FE;"><a href="#&#x67D3;&#x8272;&#x6CD5;&#x5224;&#x65AD;&#x4E8C;&#x5206;&#x56FE;" class="headerlink" title="&#x67D3;&#x8272;&#x6CD5;&#x5224;&#x65AD;&#x4E8C;&#x5206;&#x56FE;"></a>&#x67D3;&#x8272;&#x6CD5;&#x5224;&#x65AD;&#x4E8C;&#x5206;&#x56FE;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">;</span>
<span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> fir<span class="token punctuation">[</span><span class="token number">20010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">[</span><span class="token number">200010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> to<span class="token punctuation">[</span><span class="token number">200010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ne<span class="token punctuation">[</span><span class="token number">200010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> color<span class="token punctuation">[</span><span class="token number">20010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">,</span> <span class="token keyword">int</span> w<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    e<span class="token punctuation">[</span><span class="token operator">++</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">;</span> to<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">;</span>
    ne<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
    fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> idx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">,</span> <span class="token keyword">int</span> mid<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    color<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">~</span>i<span class="token punctuation">;</span> i <span class="token operator">=</span> ne<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> v <span class="token operator">=</span> to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> w <span class="token operator">=</span> e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>w <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span> <span class="token keyword">continue</span> <span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>color<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">==</span> color<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>color<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token function">dfs</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">3</span> <span class="token operator">-</span> c<span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token keyword">int</span> mid<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>color<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>color<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>fir<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> fir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">add</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">1e9</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> mid <span class="token operator">=</span> l <span class="token operator">+</span> r <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span> r <span class="token operator">=</span> mid<span class="token punctuation">;</span>
        <span class="token keyword">else</span> l <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x4E8C;&#x5206;&#x56FE;&#x6700;&#x5927;&#x5339;&#x914D;&#xFF08;&#x5308;&#x7259;&#x5229;&#xFF09;"><a href="#&#x4E8C;&#x5206;&#x56FE;&#x6700;&#x5927;&#x5339;&#x914D;&#xFF08;&#x5308;&#x7259;&#x5229;&#xFF09;" class="headerlink" title="&#x4E8C;&#x5206;&#x56FE;&#x6700;&#x5927;&#x5339;&#x914D;&#xFF08;&#x5308;&#x7259;&#x5229;&#xFF09;"></a>&#x4E8C;&#x5206;&#x56FE;&#x6700;&#x5927;&#x5339;&#x914D;&#xFF08;&#x5308;&#x7259;&#x5229;&#xFF09;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//P3386&amp;#x4E8C;&amp;#x5206;&amp;#x56FE;&amp;#x6700;&amp;#x5927;&amp;#x5339;&amp;#x914D;&amp;#x6A21;&amp;#x677F;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> enl cout &lt;&lt; "\n"</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int,int></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pdd pair&lt;double , double ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pss pair&lt;string , string ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> ld<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ull<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">503</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>G<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>mat<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>used<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>res<span class="token punctuation">;</span>

<span class="token keyword">bool</span> <span class="token function">Find</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>G<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>used<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            used<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token function">Find</span><span class="token punctuation">(</span>mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token macro property">#<span class="token directive keyword">ifdef</span> ONLINE_JUDGE</span>
    <span class="token macro property">#<span class="token directive keyword">else</span></span>
        <span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">"data.in"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">,</span><span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">#<span class="token directive keyword">endif</span></span>
    ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m <span class="token operator">>></span> e<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>e<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cin <span class="token operator">>></span> a <span class="token operator">>></span> b<span class="token punctuation">;</span>
        G<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">memset</span><span class="token punctuation">(</span>used<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>used<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">Find</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">++</span>res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> res <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;"><a href="#&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;" class="headerlink" title="&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;"></a>&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;</h2><h3 id="prim"><a href="#prim" class="headerlink" title="prim"></a>prim</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> g<span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token punctuation">,</span> dmin<span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">memset</span><span class="token punctuation">(</span>dmin<span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> dmin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dmin<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> u <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">~</span>dmin<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> dmin<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> g<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> dmin<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> g<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> minn <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">~</span>dmin<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> dmin<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> minn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                minn <span class="token operator">=</span> dmin<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                u <span class="token operator">=</span> j<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        res <span class="token operator">+</span><span class="token operator">=</span> minn<span class="token punctuation">;</span>
        dmin<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="kruskal"><a href="#kruskal" class="headerlink" title="kruskal"></a>kruskal</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">struct</span> Edge<span class="token punctuation">{</span>
    <span class="token keyword">int</span> u<span class="token punctuation">,</span> v<span class="token punctuation">,</span> w<span class="token punctuation">;</span>
<span class="token punctuation">}</span>edges<span class="token punctuation">[</span><span class="token number">210</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> k<span class="token punctuation">,</span> f<span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ans<span class="token punctuation">,</span> cnt<span class="token punctuation">,</span> book<span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> fir<span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">,</span> to<span class="token punctuation">[</span><span class="token number">410</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ne<span class="token punctuation">[</span><span class="token number">410</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    to<span class="token punctuation">[</span><span class="token operator">++</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">;</span>
    ne<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
    fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> idx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> <span class="token function">cmp</span><span class="token punctuation">(</span>Edge a<span class="token punctuation">,</span> Edge b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>w<span class="token operator">&lt;</span>b<span class="token punctuation">.</span>w<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">getf</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">==</span>v<span class="token operator">?</span>v<span class="token operator">:</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">getf</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    book<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">~</span>i<span class="token punctuation">;</span> i <span class="token operator">=</span> ne<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>book<span class="token punctuation">[</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">dfs</span><span class="token punctuation">(</span>to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>fir<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> fir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> k<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">add</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
        edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">}</span><span class="token punctuation">;</span>
        ans <span class="token operator">+</span><span class="token operator">=</span> c<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">sort</span><span class="token punctuation">(</span>edges <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> edges <span class="token operator">+</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>book<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">++</span> cnt<span class="token punctuation">,</span> <span class="token function">dfs</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n <span class="token operator">-</span> cnt<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> t1 <span class="token operator">=</span> <span class="token function">getf</span><span class="token punctuation">(</span>edges<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>u<span class="token punctuation">)</span><span class="token punctuation">,</span> t2 <span class="token operator">=</span> <span class="token function">getf</span><span class="token punctuation">(</span>edges<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">++</span> j<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>t1 <span class="token operator">==</span> t2<span class="token punctuation">)</span> <span class="token keyword">continue</span> <span class="token punctuation">;</span>
            f<span class="token punctuation">[</span>t2<span class="token punctuation">]</span> <span class="token operator">=</span> t1<span class="token punctuation">;</span>
            res <span class="token operator">+</span><span class="token operator">=</span> edges<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> ans <span class="token operator">-</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x6B21;&#x5C0F;&#x751F;&#x6210;&#x6811;&#xFF08;lca&#xFF09;"><a href="#&#x6B21;&#x5C0F;&#x751F;&#x6210;&#x6811;&#xFF08;lca&#xFF09;" class="headerlink" title="&#x6B21;&#x5C0F;&#x751F;&#x6210;&#x6811;&#xFF08;lca&#xFF09;"></a>&#x6B21;&#x5C0F;&#x751F;&#x6210;&#x6811;&#xFF08;lca&#xFF09;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">,</span> maxm <span class="token operator">=</span> <span class="token number">3e5</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">,</span> inf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ll linf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f3f3f3f3f</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> Edge <span class="token punctuation">{</span>
    <span class="token keyword">int</span> u<span class="token punctuation">,</span> v<span class="token punctuation">,</span> w<span class="token punctuation">,</span> used<span class="token punctuation">;</span>
<span class="token punctuation">}</span>edges<span class="token punctuation">[</span>maxm<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> f<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span> fa<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dep<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span> root <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dis1<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dis2<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> fir<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> to<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ne<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">long</span> <span class="token keyword">long</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">,</span> <span class="token keyword">int</span> w<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    e<span class="token punctuation">[</span><span class="token operator">++</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">;</span> to<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">;</span>
    ne<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
    fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> idx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">getf</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> f<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">==</span> v <span class="token operator">?</span> v <span class="token operator">:</span> f<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getf</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token function">cmp</span><span class="token punctuation">(</span>Edge a<span class="token punctuation">,</span> Edge b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>w <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>w<span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">kruskal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>fir<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> fir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sort</span><span class="token punctuation">(</span>edges <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> edges <span class="token operator">+</span> m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> u <span class="token operator">=</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>u<span class="token punctuation">,</span> v <span class="token operator">=</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">,</span> w <span class="token operator">=</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token punctuation">;</span>
        <span class="token keyword">int</span> t1 <span class="token operator">=</span> <span class="token function">getf</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t2 <span class="token operator">=</span> <span class="token function">getf</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1 <span class="token operator">!=</span> t2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ans <span class="token operator">+</span><span class="token operator">=</span> w<span class="token punctuation">;</span>
            f<span class="token punctuation">[</span>t2<span class="token punctuation">]</span> <span class="token operator">=</span> t1<span class="token punctuation">;</span>
            edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>used <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token function">add</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">add</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> u<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">bfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> root<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>dep<span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> dep<span class="token punctuation">)</span><span class="token punctuation">;</span>
    queue<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> q<span class="token punctuation">;</span>
    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span> dep<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> dep<span class="token punctuation">[</span>root<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//error</span>
    
    <span class="token keyword">while</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> u <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">~</span>i<span class="token punctuation">;</span> i <span class="token operator">=</span> ne<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> v <span class="token operator">=</span> to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>dep<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">></span> dep<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                dep<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> dep<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
                fa<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">;</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> <span class="token number">16</span><span class="token punctuation">;</span> k <span class="token operator">++</span><span class="token punctuation">)</span>
                    fa<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> fa<span class="token punctuation">[</span>fa<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token keyword">int</span> root<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">bfs</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    queue<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> q<span class="token punctuation">;</span>
    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">while</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> u <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">~</span>i<span class="token punctuation">;</span> i <span class="token operator">=</span> ne<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> v <span class="token operator">=</span> to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> w <span class="token operator">=</span> e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>dep<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">&lt;</span> dep<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">continue</span> <span class="token punctuation">;</span>
            
            q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
            dis1<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">;</span>
            dis2<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>inf<span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> <span class="token number">16</span><span class="token punctuation">;</span> k <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fa<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
                
                <span class="token keyword">int</span> mid <span class="token operator">=</span> fa<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> tdis<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
                
                tdis<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> dis1<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                tdis<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> dis2<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                tdis<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> dis1<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                tdis<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> dis2<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                
                dis1<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> dis2<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>inf<span class="token punctuation">;</span>
                
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">int</span> d <span class="token operator">=</span> tdis<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">></span> dis1<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> dis2<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> dis1<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> dis1<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">;</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">!=</span> dis1<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> d <span class="token operator">></span> dis2<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> dis2<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>d1<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>d2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> tdis<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>dep<span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">></span> dep<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span> k <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dep<span class="token punctuation">[</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">>=</span> dep<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            tdis<span class="token punctuation">[</span><span class="token operator">++</span> cnt<span class="token punctuation">]</span> <span class="token operator">=</span> dis1<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
            tdis<span class="token punctuation">[</span><span class="token operator">++</span> cnt<span class="token punctuation">]</span> <span class="token operator">=</span> dis2<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
            x <span class="token operator">=</span> fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">!=</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span> k <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">!=</span> fa<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                
                tdis<span class="token punctuation">[</span><span class="token operator">++</span> cnt<span class="token punctuation">]</span> <span class="token operator">=</span> dis1<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
                tdis<span class="token punctuation">[</span><span class="token operator">++</span> cnt<span class="token punctuation">]</span> <span class="token operator">=</span> dis2<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
                tdis<span class="token punctuation">[</span><span class="token operator">++</span> cnt<span class="token punctuation">]</span> <span class="token operator">=</span> dis1<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
                tdis<span class="token punctuation">[</span><span class="token operator">++</span> cnt<span class="token punctuation">]</span> <span class="token operator">=</span> dis2<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
                
                x <span class="token operator">=</span> fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
                y <span class="token operator">=</span> fa<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        tdis<span class="token punctuation">[</span><span class="token operator">++</span> cnt<span class="token punctuation">]</span> <span class="token operator">=</span> dis1<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        tdis<span class="token punctuation">[</span><span class="token operator">++</span> cnt<span class="token punctuation">]</span> <span class="token operator">=</span> dis1<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    d1 <span class="token operator">=</span> d2 <span class="token operator">=</span> <span class="token operator">-</span>linf<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> cnt<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> <span class="token keyword">long</span> d <span class="token operator">=</span> tdis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">></span> d1<span class="token punctuation">)</span> d2 <span class="token operator">=</span> d1<span class="token punctuation">,</span> d1 <span class="token operator">=</span> d<span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">!=</span> d1 <span class="token operator">&amp;&amp;</span> d <span class="token operator">></span> d2<span class="token punctuation">)</span> d2 <span class="token operator">=</span> d<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>d2 <span class="token operator">==</span> <span class="token operator">-</span>linf<span class="token punctuation">)</span> d2 <span class="token operator">=</span> linf<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">kruskal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">build</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// for(int i = 1; i &lt;= n; i ++)</span>
    <span class="token comment" spellcheck="true">// cout &lt;&lt; fa[i][0] &lt;&lt; &amp;apos; &amp;apos; &lt;&lt; fa[i][1] &lt;&lt; endl;</span>

    ll res <span class="token operator">=</span> linf<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>used<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">int</span> u <span class="token operator">=</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>u<span class="token punctuation">,</span> v <span class="token operator">=</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">,</span> w <span class="token operator">=</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token punctuation">;</span>
            ll dd1<span class="token punctuation">,</span> dd2<span class="token punctuation">;</span>
            <span class="token function">query</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">,</span> dd1<span class="token punctuation">,</span> dd2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//cout &lt;&lt; a &lt;&lt; " " &lt;&lt; b &lt;&lt; " " &lt;&lt; dd1 &lt;&lt; " " &lt;&lt; dd2 &lt;&lt; " " &lt;&lt; w &lt;&lt; endl;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>w <span class="token operator">></span> dd1<span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> ans <span class="token operator">+</span> w <span class="token operator">-</span> dd1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>w <span class="token operator">></span> dd2<span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> ans <span class="token operator">+</span> w <span class="token operator">-</span> dd2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x7F51;&#x7EDC;&#x6D41;"><a href="#&#x7F51;&#x7EDC;&#x6D41;" class="headerlink" title="&#x7F51;&#x7EDC;&#x6D41;"></a>&#x7F51;&#x7EDC;&#x6D41;</h2><h3 id="&#x7F51;&#x7EDC;&#x6D41;&#x6700;&#x5927;&#x6D41;&#xFF08;&#x4F18;&#x5316;dinic&#xFF09;"><a href="#&#x7F51;&#x7EDC;&#x6D41;&#x6700;&#x5927;&#x6D41;&#xFF08;&#x4F18;&#x5316;dinic&#xFF09;" class="headerlink" title="&#x7F51;&#x7EDC;&#x6D41;&#x6700;&#x5927;&#x6D41;&#xFF08;&#x4F18;&#x5316;dinic&#xFF09;"></a>&#x7F51;&#x7EDC;&#x6D41;&#x6700;&#x5927;&#x6D41;&#xFF08;&#x4F18;&#x5316;dinic&#xFF09;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> S<span class="token punctuation">,</span> T<span class="token punctuation">;</span>
<span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> fir<span class="token punctuation">[</span><span class="token number">10010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> to<span class="token punctuation">[</span><span class="token number">200010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cap<span class="token punctuation">[</span><span class="token number">200010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ne<span class="token punctuation">[</span><span class="token number">200010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> q<span class="token punctuation">[</span><span class="token number">10010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span><span class="token number">10010</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cur<span class="token punctuation">[</span><span class="token number">100010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//d&amp;#x6570;&amp;#x7EC4;&amp;#xFF0C;&amp;#x7528;&amp;#x4E8E;&amp;#x5206;&amp;#x5C42;&amp;#x56FE;&amp;#xFF0C;d[i]&amp;#x4EE3;&amp;#x8868;i&amp;#x8282;&amp;#x70B9;&amp;#x5728;&amp;#x5206;&amp;#x5C42;&amp;#x56FE;&amp;#x7684;&amp;#x7B2C;&amp;#x51E0;&amp;#x5C42;</span>
<span class="token comment" spellcheck="true">//cur&amp;#x6570;&amp;#x7EC4;&amp;#xFF0C;&amp;#x5F53;&amp;#x524D;&amp;#x5F27;&amp;#x4F18;&amp;#x5316;&amp;#xFF0C;cur[i]&amp;#x4EE3;&amp;#x8868;i&amp;#x8282;&amp;#x70B9;dfs&amp;#x662F;&amp;#x4ECE;cur[i]&amp;#x5F00;&amp;#x59CB;&amp;#x904D;&amp;#x5386;&amp;#x8FB9;</span>

<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    to<span class="token punctuation">[</span><span class="token operator">++</span> idx<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">,</span> cap<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">,</span> ne<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">,</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> idx<span class="token punctuation">;</span>
    to<span class="token punctuation">[</span><span class="token operator">++</span> idx<span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">,</span> cap<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ne<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">,</span> fir<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> idx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> <span class="token function">bfs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> qh <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> qt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> S<span class="token punctuation">,</span> d<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> cur<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>S<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>qh <span class="token operator">&lt;</span> qt<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> u <span class="token operator">=</span> q<span class="token punctuation">[</span>qh <span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> fir<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">~</span>i<span class="token punctuation">;</span> i <span class="token operator">=</span> ne<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> v <span class="token operator">=</span> to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> cap<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                d<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&amp;#x8BB0;&amp;#x5F55;&amp;#x5206;&amp;#x5C42;&amp;#x56FE;</span>
                cur<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> fir<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&amp;#x8BB0;&amp;#x5F55;&amp;#x5F53;&amp;#x524D;&amp;#x5F27;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>v <span class="token operator">==</span> T<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                q<span class="token punctuation">[</span>qt <span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> limit<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>u <span class="token operator">==</span> T<span class="token punctuation">)</span> <span class="token keyword">return</span> limit<span class="token punctuation">;</span>
    <span class="token keyword">int</span> flow <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> cur<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">~</span>i <span class="token operator">&amp;&amp;</span> flow <span class="token operator">&lt;</span> limit<span class="token punctuation">;</span> i <span class="token operator">=</span> ne<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cur<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&amp;#x4F18;&amp;#x5316;&amp;#x5F53;&amp;#x524D;&amp;#x5F27;</span>
        <span class="token keyword">int</span> v <span class="token operator">=</span> to<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">==</span> d<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> cap<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>cap<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> limit <span class="token operator">-</span> flow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>t<span class="token punctuation">)</span> d<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&amp;#x5F53;&amp;#x524D;&amp;#x8FB9;&amp;#x5DF2;&amp;#x7ECF;&amp;#x65E0;&amp;#x6CD5;&amp;#x8FC7;&amp;#x6D41;&amp;#x91CF;&amp;#x4E86;&amp;#xFF0C;&amp;#x8E22;&amp;#x51FA;&amp;#x5206;&amp;#x5C42;&amp;#x56FE;</span>
            cap<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span><span class="token operator">=</span> t<span class="token punctuation">,</span> cap<span class="token punctuation">[</span>i <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> t<span class="token punctuation">,</span> flow <span class="token operator">+</span><span class="token operator">=</span> t<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> flow<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">dinic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> flow <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">bfs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">while</span><span class="token punctuation">(</span>flow <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> inf<span class="token punctuation">)</span><span class="token punctuation">)</span> res <span class="token operator">+</span><span class="token operator">=</span> flow<span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>fir<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> fir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">,</span> <span class="token operator">&amp;</span>S<span class="token punctuation">,</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> m<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">dinic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x6700;&#x5C0F;&#x8D39;&#x7528;&#x6700;&#x5927;&#x6D41;"><a href="#&#x6700;&#x5C0F;&#x8D39;&#x7528;&#x6700;&#x5927;&#x6D41;" class="headerlink" title="&#x6700;&#x5C0F;&#x8D39;&#x7528;&#x6700;&#x5927;&#x6D41;"></a>&#x6700;&#x5C0F;&#x8D39;&#x7528;&#x6700;&#x5927;&#x6D41;</h3><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//luoguP3381&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x6A21;&amp;#x677F;</span>
<span class="token comment" spellcheck="true">//dinic+spfa</span>
<span class="token comment" spellcheck="true">//&amp;#x601D;&amp;#x8DEF;&amp;#xFF1A;</span>
<span class="token comment" spellcheck="true">//&amp;#x5148;&amp;#x4EE5;&amp;#x6700;&amp;#x5C0F;&amp;#x82B1;&amp;#x8D39;&amp;#x6C42;&amp;#x51FA;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5F80;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x4E0A;&amp;#x52A0;&amp;#x6D41;&amp;#x91CF;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x6C42;&amp;#x51FA;&amp;#x5728;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x4E0A;&amp;#x53EF;&amp;#x52A0;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x91CF;</span>
<span class="token comment" spellcheck="true">//spfa&amp;#x6C42;dis[t]&amp;#xFF0C;dfs&amp;#x6C42;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x4E0A;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x6700;&amp;#x5C0F;&amp;#x82B1;&amp;#x8D39;&amp;#x4E3A;dis[t]*maxflow&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6709;&amp;#x591A;&amp;#x6761;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x540C;&amp;#x65F6;&amp;#x5B58;&amp;#x5728;&amp;#xFF0C;&amp;#x4E5F;&amp;#x53EF;&amp;#x4EE5;&amp;#x8BC1;&amp;#x660E;&amp;#x6B64;&amp;#x5F0F;&amp;#x6210;&amp;#x7ACB;</span>
<span class="token comment" spellcheck="true">//&amp;#x8FD9;&amp;#x91CC;&amp;#x6CE8;&amp;#x610F;&amp;#x8981;&amp;#x7528;&amp;#x4E00;&amp;#x4E2A;vis&amp;#x5728;dfs&amp;#x4E2D;&amp;#x6807;&amp;#x8BB0;&amp;#x7ED3;&amp;#x70B9;&amp;#xFF0C;&amp;#x4FDD;&amp;#x8BC1;&amp;#x6BCF;&amp;#x4E2A;&amp;#x70B9;&amp;#x53EA;&amp;#x80FD;dfs&amp;#x4E00;&amp;#x6B21;&amp;#xFF08;&amp;#x4E0E;&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x6A21;&amp;#x677F;&amp;#x6709;&amp;#x4E9B;&amp;#x4E0D;&amp;#x540C;&amp;#xFF09;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property">#<span class="token directive keyword">define</span> rep0(i,n) for(int i=0;i&lt;n;++i)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> rep1(i,n) for(int i=1;i&lt;=n;++i)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> pii pair&lt;int ,int ></span>
<span class="token macro property">#<span class="token directive keyword">define</span> pb push_back</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&amp;#x6700;&amp;#x5927;&amp;#x6D41;&amp;#x548C;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;&amp;#x4FDD;&amp;#x8BC1;&amp;#x5728;2^31-1&amp;#x5185;&amp;#xFF0C;&amp;#x8FD9;&amp;#x65F6;&amp;#x5019;&amp;#x7B97;&amp;#x6CD5;&amp;#x4E2D;&amp;#x6CE8;&amp;#x610F;&amp;#x5904;&amp;#x7406;&amp;#x6EA2;&amp;#x51FA;&amp;#x60C5;&amp;#x51B5;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x7fffffff</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">5e3</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">,</span>t<span class="token punctuation">,</span>minfee<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>maxflow<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> Edge<span class="token punctuation">{</span>
    <span class="token keyword">int</span> from<span class="token punctuation">,</span>to<span class="token punctuation">,</span>cap<span class="token punctuation">,</span>wei<span class="token punctuation">;</span>
    <span class="token function">Edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span><span class="token keyword">int</span> to<span class="token punctuation">,</span><span class="token keyword">int</span> cap<span class="token punctuation">,</span><span class="token keyword">int</span> wei<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">from</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">to</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">cap</span><span class="token punctuation">(</span>cap<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">wei</span><span class="token punctuation">(</span>wei<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

vector<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> G<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span>Edge <span class="token operator">></span> edges<span class="token punctuation">;</span>
<span class="token keyword">int</span> cnt<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> inq<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>vis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//spfa&amp;#x6C42;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x5F84;</span>
<span class="token comment" spellcheck="true">//&amp;#x6C42;&amp;#x51FA;&amp;#x6765;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#x7528;dis&amp;#x4E0E;&amp;#x8FB9;&amp;#x6743;&amp;#x505A;&amp;#x6BD4;&amp;#x8F83;&amp;#x6765;&amp;#x786E;&amp;#x8BA4;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x6C42;&amp;#x51FA;&amp;#x6765;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0D;&amp;#x4E00;&amp;#x5B9A;&amp;#x662F;&amp;#x4E00;&amp;#x6761;&amp;#x5355;&amp;#x4E00;&amp;#x7684;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;</span>
<span class="token comment" spellcheck="true">//&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x4E3A;&amp;#x591A;&amp;#x6761;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x518D;&amp;#x4E0A;&amp;#x9762;&amp;#x52A0;&amp;#x6D41;&amp;#x91CF;&amp;#xFF08;&amp;#x589E;&amp;#x5E7F;&amp;#xFF09;</span>
<span class="token keyword">bool</span> <span class="token function">SPFA</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    queue<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">></span> q<span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>inq<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>inq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>cnt<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">==</span>s<span class="token operator">?</span><span class="token number">0</span><span class="token operator">:</span>inf<span class="token punctuation">;</span>
    inq<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> u <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        inq<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> Edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//&amp;#x9996;&amp;#x5148;&amp;#x8981;&amp;#x4FDD;&amp;#x8BC1;&amp;#x8FD9;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x53EF;&amp;#x4EE5;&amp;#x901A;&amp;#x6D41;&amp;#x91CF;&amp;#x7684;&amp;#x6B63;&amp;#x8FB9;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cap<span class="token operator">></span><span class="token number">0</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token operator">==</span>inf<span class="token operator">||</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token operator">></span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>e<span class="token punctuation">.</span>wei<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>wei<span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>inq<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    inq<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>to<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">++</span>cnt<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">></span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">//&amp;#x8FD9;&amp;#x91CC;&amp;#x4E0D;&amp;#x80FD;&amp;#x8FD4;&amp;#x56DE;true&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;spfa&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#x8D1F;&amp;#x73AF;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x4E5F;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x65E0;&amp;#x6CD5;&amp;#x5230;&amp;#x8FBE;&amp;#x7EC8;&amp;#x70B9;&amp;#xFF0C;</span>
    <span class="token comment" spellcheck="true">//&amp;#x56E0;&amp;#x4E3A;&amp;#x5224;&amp;#x65AD;&amp;#x6761;&amp;#x4EF6;&amp;#x4E3A;&amp;#x6709;&amp;#x6D41;&amp;#x91CF;&amp;#x65F6;&amp;#x8FD9;&amp;#x6761;&amp;#x8DEF;&amp;#x624D;&amp;#x80FD;&amp;#x8D70;</span>
    <span class="token keyword">return</span> dis<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">!=</span>inf<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//&amp;#x5411;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x5F84;&amp;#x6DFB;&amp;#x52A0;&amp;#x6D41;&amp;#x91CF;&amp;#xFF0C;&amp;#x65E0;cur&amp;#x4F18;&amp;#x5316;&amp;#xFF08;&amp;#x4E0D;&amp;#x592A;&amp;#x4E00;&amp;#x6837;&amp;#xFF09;</span>
<span class="token comment" spellcheck="true">//&amp;#x4E3A;&amp;#x4E86;&amp;#x4FDD;&amp;#x8BC1;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;&amp;#x70B9;&amp;#x53EA;&amp;#x80FD;dfs&amp;#x4E00;&amp;#x6B21;&amp;#xFF0C;&amp;#x52A0;&amp;#x5165;vis</span>
<span class="token comment" spellcheck="true">//&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x4F7F;&amp;#x7528;vis&amp;#x7684;&amp;#x8BDD;&amp;#xFF0C;&amp;#x4F1A;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x518D;&amp;#x4E24;&amp;#x4E2A;&amp;#x70B9;&amp;#x4E4B;&amp;#x95F4;&amp;#x6765;&amp;#x56DE;dfs&amp;#xFF08;&amp;#x6D41;&amp;#x91CF;&amp;#x90FD;&amp;#x4E0D;&amp;#x4E3A;0&amp;#xFF0C;&amp;#x540C;&amp;#x65F6;&amp;#x7531;&amp;#x4E8E;&amp;#x53CD;&amp;#x5411;&amp;#x8FB9;&amp;#x82B1;&amp;#x8D39;&amp;#x76F8;&amp;#x53CD;&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#x51FA;&amp;#x73B0;&amp;#x8FD9;&amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#xFF09;</span>
<span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span><span class="token keyword">int</span> flow<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>u <span class="token operator">==</span> t<span class="token punctuation">)</span> <span class="token keyword">return</span> flow<span class="token punctuation">;</span>
    vis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> detla <span class="token operator">=</span> flow<span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">const</span> Edge<span class="token operator">&amp;</span> e <span class="token operator">=</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//&amp;#x627E;&amp;#x5230;&amp;#x6700;&amp;#x77ED;&amp;#x8DEF;&amp;#x5F84;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cap<span class="token operator">&amp;&amp;</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>dis<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token operator">==</span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>e<span class="token punctuation">.</span>wei<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> d <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>to<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>detla<span class="token punctuation">,</span>e<span class="token punctuation">.</span>cap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cap<span class="token operator">-</span><span class="token operator">=</span>d<span class="token punctuation">;</span> edges<span class="token punctuation">[</span>G<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cap<span class="token operator">+</span><span class="token operator">=</span>d<span class="token punctuation">;</span>
            detla <span class="token operator">-</span><span class="token operator">=</span> d<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>detla <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> flow <span class="token operator">-</span> detla<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">addEdge</span><span class="token punctuation">(</span><span class="token keyword">int</span> from<span class="token punctuation">,</span><span class="token keyword">int</span> to<span class="token punctuation">,</span><span class="token keyword">int</span> cap<span class="token punctuation">,</span><span class="token keyword">int</span> wei<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    edges<span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token function">Edge</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span>to<span class="token punctuation">,</span>cap<span class="token punctuation">,</span>wei<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    G<span class="token punctuation">[</span>from<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pb</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span>edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">SPFA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">memset</span><span class="token punctuation">(</span>vis<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>vis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> d <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>inf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        maxflow <span class="token operator">+</span><span class="token operator">=</span> d<span class="token punctuation">;</span>
        minfee <span class="token operator">+</span><span class="token operator">=</span> d<span class="token operator">*</span>dis<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span>maxflow<span class="token punctuation">,</span>minfee<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//&amp;#x51FA;&amp;#x70B9;&amp;#xFF0C;&amp;#x5165;&amp;#x70B9;&amp;#xFF0C;&amp;#x6D41;&amp;#x91CF;&amp;#x9650;&amp;#x5236;&amp;#xFF0C;&amp;#x6700;&amp;#x5C0F;&amp;#x8D39;&amp;#x7528;</span>
        <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">,</span><span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addEdge</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addEdge</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="&#x52A8;&#x6001;&#x89C4;&#x5212;"><a href="#&#x52A8;&#x6001;&#x89C4;&#x5212;" class="headerlink" title="&#x52A8;&#x6001;&#x89C4;&#x5212;"></a>&#x52A8;&#x6001;&#x89C4;&#x5212;</h1></div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><span class="icon iconify" data-icon="ri:hand-coin-line"></span></span><div id="reward-comment">I'm so cute. Please give me money.</div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Xin Ling</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://example.com/2021/03/21/%E6%A8%A1%E6%9D%BF/" title="模板">http://example.com/2021/03/21/%E6%A8%A1%E6%9D%BF/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/04/12/vpn%E6%90%AD%E5%BB%BA/" rel="prev" title="vpn搭建"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">vpn搭建</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/03/15/%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86%E5%8F%8A%E6%AC%A7%E6%8B%89%E7%AD%9B/" rel="next" title="欧拉定理及欧拉筛"><span class="post-nav-text">欧拉定理及欧拉筛</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2022 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Xin Ling</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v6.2.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.2</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#FF00E6" stroke-width="2" stroke-linecap="round"></circle></svg></a></body></html>